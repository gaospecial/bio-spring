<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>directlabel on Hugo Prose</title>
    <link>/tags/directlabel/</link>
    <description>Recent content in directlabel on Hugo Prose</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 17 Jul 2019 00:00:00 +0000</lastBuildDate><atom:link href="/tags/directlabel/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ggplot label placement</title>
      <link>/post/2019/07/17/ggplot-label-placement/</link>
      <pubDate>Wed, 17 Jul 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019/07/17/ggplot-label-placement/</guid>
      <description>本文曾经发表在 biobabble 微信公众号 链接
ggplot在绘制label的时候很容易出现字体溢出，位置难以调整的问题。Y叔曾经在公众号上吐槽过。
实际上，标签如何在图片中展示，还真不是一个简单的问题。有一个领域“Automatic label placement”就是研究该问题的。
下面介绍一下如何处理这个标签定位的问题。
方法一：使用hjust，vjust，nudge_x，nudge_y等参数调整我们从mpg数据集中提取10行数据画图，默认情况下是这样的情况。
mpg数据集是ggplot2自带的一个234行和11个变量的数据，包含了38种流行车型的燃油经济性数据。
包括：生产厂家（manufacturer），型号（model），发动机排量（displ，单位为L），生产年份（year），气缸数目（cyl），传动类型（trans），驱动类型（drv，f=前驱，r=后驱，4=四驱），每加仑燃油在城市和高速公路上的里程数（cty和hwy），汽油种类（fl）和汽车类型（class）等。
library(ggplot2)## 生成数据集set.seed(0)df &amp;lt;- mpg[sample(nrow(mpg),10),]## 发动机排量和良好路况情况下单位耗油所能行驶的里程数ggplot(df,aes(displ,hwy)) + geom_point() + geom_text(aes(label=model))这种情况下，边缘的字符串会溢出。可以添加hjust=&#34;inward&#34;来避免这一情况。
## hjust=&amp;quot;inward&amp;quot;把左侧的label右对齐，右侧的label左对齐。ggplot(df,aes(displ,hwy)) + geom_point() + geom_text(aes(label=model),hjust=&amp;quot;inward&amp;quot;)但是这种情形仍然会出现point和label重叠的情况。因此需要进一步调节。使用nudge_x和nudge_y可以设置标签显示位置的微小偏移。
由于标签是水平显示的，左右两侧容易出现溢出，而竖直方向上则一般不会，所以我们将竖直方向设为居中，并微调-0.5，这样就可以保证标签显示比较正常了。
ggplot(df,aes(displ,hwy)) + geom_point() + geom_text(aes(label=model),hjust=&amp;quot;inward&amp;quot;,vjust=&amp;quot;center&amp;quot;,nudge_y = -.5)hjust, vjust = c(“left”,“right”,“center”,“inward”,“outward”);nudge_x, nudge_y = value.
如果在Y轴边缘有溢出的话，则在结合调整xlim，ylim可以解决。如下所示：
ggplot(df,aes(displ,hwy)) + geom_point() + geom_text(aes(label=model),size=12,hjust=&amp;quot;inward&amp;quot;,vjust=&amp;quot;center&amp;quot;,nudge_y = -.5) + xlim(c(0,8))如上图所示，虽然确保了标签没有溢出，但是同时又会有标签重叠的情况。
也可以参考 vignette(“ggplot2-specs”) 中的部分内容。
实际上，标签如何在图片中展示，还真不是一个简单的问题。有一个领域“Automatic label placement”就是研究该问题的。</description>
    </item>
    
  </channel>
</rss>
