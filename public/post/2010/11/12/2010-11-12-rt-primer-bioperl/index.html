<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> 使用BioPerl和primer3批量设计RT-PCR引物 | Hugo Prose</title>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/css/article.min.css,npm/@xiee/utils/css/heading-anchor.min.css">
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="使用BioPerl和primer3批量设计RT-PCR引物"/>
<meta name="twitter:description" content="Update：
我已经设置了一个Massive RT-PCR Primer Designer服务，有需要的朋友可以直接去上传自己基因序列的Fasta文件，然后服务器会将引物返回。
关于Missing SEQUENCE tag错误的处理
以下为原文。
———————————————————————————————–
本文介绍批量设计RT-PCR引物的方法，基于Ubuntu 10.10系统和BioPerl 1.6.1。但是应当适用于大部分Linux系统。
本文假定你已经安装好BioPerl。
安装primer3和Bio::PrimerDesigner
[bash]
&gt;sudo apt-get install primer3 libbio-primerdesigner-perl
[/bash]
修正程序Bug
Primer3安装之后的可执行文件存在于/usr/bin/primer3_core，而Bio::PrimerDesigner软件包找不到该文件，所以需要建立一个符号链接。
[bash]
&gt;sudo ln -s /usr/bin/primer3_core /usr/local/bin/primer3
[/bash]
准备序列文件
将要设计的文件以Fasta格式保存（也可以用其它BioPerl识别的任意格式保存）在当前目录中，此处以seqs.fa命名。
代码
然后在当前目录中新建文件designPrimer.pl。
录入代码如下：
[perl]
#! perl -w
use Bio::SeqIO;
use Bio::PrimerDesigner;
my $seqs = Bio::SeqIO-&gt;new(-file =&gt; ‘seqs.fa’);
open OUT, ‘&gt;&gt; raw_output.txt’;
my $pd = Bio::PrimerDesigner-&gt;new;
while( my $seq = $seqs-&gt;next_seq() ) {
my $seqid = $seq-&gt;id;
my $dna = $seq-&gt;seq;"/>


  </head>

  <body>

    <nav class="menu">
    <ul>
      <li class="left">
        <a href="/"><span>Hugo Prose</span></a>
      </li>
      
      <li>
        <a href="/">Home</a>
      </li>
      
      <li>
        <a href="/about/">About</a>
      </li>
      
      <li>
        <a href="/sitemap/">Sitemap</a>
      </li>
      
      <li id="menu-search">
        <a href="/#">Search</a>
      </li>
      
      <li>
        <a href="/index.xml">Subscribe</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">使用BioPerl和primer3批量设计RT-PCR引物</span></h1>

<h3 class="date">2010-11-12</h3>
<p class="terms">
  
  
  
  
  Tags: <a href="/tags/bioperl-bioperl">BioPerl BIOPERL</a> <a href="/tags/%E5%8E%9F%E5%88%9B%E6%95%99%E7%A8%8B-tutorial">原创教程 TUTORIAL</a> <a href="/tags/bioperl">BioPerl</a> <a href="/tags/primer">primer</a> <a href="/tags/primer-design">primer design</a> <a href="/tags/primer3">primer3</a> <a href="/tags/rt-pcr">RT-PCR</a> <a href="/tags/ubuntu">Ubuntu</a> 
  
  
</p>
</div>

<div class="article">
<p>Update：</p>
<p>我已经设置了一个<a href="http://tools.bio-spring.top/rtprimers.cgi">Massive RT-PCR Primer
Designer服务</a>，有需要的朋友可以直接去上传自己基因序列的Fasta文件，然后服务器会将引物返回。</p>
<p>关于<a href="http://bio-spring.top/primer_error-missing-sequence-tag/">Missing SEQUENCE
tag错误的处理</a></p>
<p>以下为原文。<br>
———————————————————————————————–<br>
本文介绍批量设计RT-PCR引物的方法，基于Ubuntu 10.10系统和BioPerl
1.6.1。但是应当适用于大部分Linux系统。</p>
<p>本文假定你已经安装好BioPerl。</p>
<p><strong>安装primer3和Bio::PrimerDesigner</strong></p>
<p>[bash]<br>
&gt;sudo apt-get install primer3 libbio-primerdesigner-perl<br>
[/bash]</p>
<p><strong>修正程序Bug</strong></p>
<p>Primer3安装之后的可执行文件存在于/usr/bin/primer3_core，而Bio::PrimerDesigner软件包找不到该文件，所以需要建立一个符号链接。<br>
[bash]<br>
&gt;sudo ln -s /usr/bin/primer3_core /usr/local/bin/primer3<br>
[/bash]</p>
<p><strong>准备序列文件</strong></p>
<p>将要设计的文件以Fasta格式保存（也可以用其它BioPerl识别的任意格式保存）在当前目录中，此处以seqs.fa命名。</p>
<p><strong>代码</strong></p>
<p>然后在当前目录中新建文件designPrimer.pl。<br>
录入代码如下：<br>
[perl]<br>
#! perl -w<br>
use Bio::SeqIO;<br>
use Bio::PrimerDesigner;</p>
<p>my $seqs = Bio::SeqIO-&gt;new(-file =&gt; ‘seqs.fa’);<br>
open OUT, ‘&gt;&gt; raw_output.txt’;<br>
my $pd = Bio::PrimerDesigner-&gt;new;<br>
while( my $seq = $seqs-&gt;next_seq() ) {<br>
my $seqid = $seq-&gt;id;<br>
my $dna = $seq-&gt;seq;<br>
my %params = (<br>
PRIMER_NUM_RETURN =&gt; 1,<br>
PRIMER_SEQUENCE_ID =&gt; $seqid,<br>
SEQUENCE =&gt; $dna,<br>
PRIMER_PRODUCT_SIZE_RANGE =&gt; ‘150-250’,
#注意此处参数在perl文档中是错误的，应更正为此<br>
);<br>
my $primers = $pd-&gt;design( %params ) or die $pd-&gt;error;<br>
my ($left_primer,$right_primer);<br>
if ( !$primers-&gt;left ) {<br>
warn “No primers found for $seqid\n”;<br>
}<br>
else{<br>
$left_primer = $primers-&gt;left;<br>
$right_primer = $primers-&gt;right;<br>
}<br>
print join(‘,’, $seqid, $left_primer, $right_primer);<br>
print “\n”;<br>
print OUT $primers-&gt;raw_output;
#此处的perl文档也是错误的，应更正为此<br>
}<br>
[/perl]</p>
<p><strong>保存引物</strong></p>
<p>打开终端，输入<br>
[bash]<br>
&gt; perl designprimer.pl<br>
[/bash]<br>
如果程序运行正常，引物设计的结果将在屏幕上显示，同时应当会有一些警告信息。</p>
<p>然后，可以将结果用管道命令保存：<br>
[bash]<br>
&gt; perl designprimer.pl &gt;primers.csv<br>
[/bash]</p>
<p><strong>注释</strong></p>
<p>raw_output.txt中含有primer3程序运行的完整结果。可以作为额外参考。</p>
<p>Refers：<br>
<a href="http://search.cpan.org/">http://search.cpan.org/</a>~smckay/Bio-PrimerDesigner-0.07/lib/Bio/PrimerDesigner.pm</p>
<p>Posted from <a href="http://sourceforge.net/projects/gscribble/">GScribble</a>.</p>

</div>
</main>

<section class="appendix">







<div>
  <div class="side side-left"><h3>Reuse</h3></div>
  Text and figures are licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution CC BY 4.0</a>. The source code is licensed under MIT. The full source is available at <a href="https://github.com/yihui/hugo-prose">https://github.com/yihui/hugo-prose</a>.
</div>



<div>
  <div class="side side-left"><h3>Suggest changes</h3></div>
  
  
  
    
    
  
  If you find any mistakes (including typos) or want to suggest changes, please feel free to <a href="https://github.com/yihui/hugo-prose/edit/master/exampleSite/content/post/2010-11-12-rt-primer-bioperl.md" id="edit-link">edit the source file of this page on Github and create a pull request.</a>
</div>




</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="/post/2010/10/28/2010-10-28-ubuntu-gscribble/" title=Next&#32;post&#32;(older)>Ubuntu 10.10环境下安装GScribble</a></span>
  &hercon;
  <span class="nav-prev"><a href="/post/2010/11/17/2010-11-17-shanghai-11-15/" title=Previous&#32;post&#32;(newer)>志哀：2010-11-15 上海大火</a> &rarr;</span>
</nav>





</div>


  <footer>
  


<script src="//yihui.org/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>





<script src="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/js/number-sections.min.js,npm/@xiee/utils/js/toc.min.js,npm/@xiee/utils/js/sidenotes.min.js,npm/@xiee/utils/js/right-quote.min.js,npm/@xiee/utils/js/center-img.min.js,npm/@xiee/utils/js/fix-pandoc.min.js,npm/@xiee/utils/js/heading-anchor.min.js" defer></script>




  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="https://en.wikipedia.org/wiki/Seneca_the_Younger">Lucius Annaeus Seneca</a> 4 BC &ndash; AD 65</li>
  </ul>
  
  <ul>
    
    <li>
      <a href="/404.html">Contact</a>
    </li>
    
    <li class="optional">
      <a href="/categories/">Categories</a>
    </li>
    
    <li class="optional">
      <a href="/tags/">Tags</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script src="/js/features.js" defer></script>
  </body>
</html>

