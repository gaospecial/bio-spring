<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> LAMP Project[part B]-解析cgi动态网页项目源代码(下部) | Hugo Prose</title>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/css/article.min.css,npm/@xiee/utils/css/heading-anchor.min.css">
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="LAMP Project[part B]-解析cgi动态网页项目源代码(下部)"/>
<meta name="twitter:description" content="这里是该项目的完整代码,在本机上运行正确, 如果出错,就是你LAMP的配置有问题. 文中注释即为相关解释.
整整一百行哦&hellip;哈哈
1 #! /usr/bin/perl
2 # if.simple.cgi
3 use DBI;
4 use CGI &lsquo;:standard&rsquo;;
5
6 ####
7 # handle_error() - 错误处理的一个子程序
8 ####
9 sub handle_error {
10 my $msg = shift ||&rsquo; &lsquo;;
11 my $dbh = shift ||&rsquo; &lsquo;;
12 my $sth = shift ||&rsquo; &lsquo;;
13 #text/html行下必须有一个空行
14 print &lt;&lt;EOHTML;
15 Content-type: text/html
16
17 &lt;head&gt;
18 &lt;title&gt;Age Information Error&lt;/title&gt;
19 &lt;/head&gt;
20 &lt;body bgcolor=&quot;#ffffff&quot;&gt;"/>


  </head>

  <body>

    <nav class="menu">
    <ul>
      <li class="left">
        <a href="/"><span>Hugo Prose</span></a>
      </li>
      
      <li>
        <a href="/">Home</a>
      </li>
      
      <li>
        <a href="/about/">About</a>
      </li>
      
      <li>
        <a href="/sitemap/">Sitemap</a>
      </li>
      
      <li id="menu-search">
        <a href="/#">Search</a>
      </li>
      
      <li>
        <a href="/index.xml">Subscribe</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">LAMP Project[part B]-解析cgi动态网页项目源代码(下部)</span></h1>

<h3 class="author">
gaoch
</h3>

<h3 class="date">2008-01-18</h3>
<p class="terms">
  
  
  
  
  Tags: <a href="/tags/%E7%99%BE%E5%BA%A6%E7%A9%BA%E9%97%B4">百度空间</a> 
  
  
</p>
</div>

<div class="article">
<p>这里是该项目的完整代码,在本机上运行正确,
如果出错,就是你LAMP的配置有问题. 文中注释即为相关解释.<br>
整整一百行哦&hellip;哈哈<img src="http://img.baidu.com/hi/face/i_f28.gif" alt=""></p>
<p>1 #! /usr/bin/perl<br>
2 # if.simple.cgi<br>
3 use DBI;<br>
4 use CGI &lsquo;:standard&rsquo;;<br>
5<br>
6 ####<br>
7 # handle_error() - 错误处理的一个子程序<br>
8 ####<br>
9 <strong>sub</strong> handle_error {<br>
10 <strong>my</strong> $msg = <strong>shift</strong> ||&rsquo; &lsquo;;<br>
11 <strong>my</strong> $dbh = <strong>shift</strong> ||&rsquo; &lsquo;;<br>
12 <strong>my</strong> $sth = <strong>shift</strong> ||&rsquo; &lsquo;;<br>
13 #text/html行下必须有一个空行<br>
14 <strong>print</strong> &lt;&lt;EOHTML;<br>
15 Content-type: text/html<br>
16<br>
17 &lt;head&gt;<br>
18 &lt;title&gt;Age Information Error&lt;/title&gt;<br>
19 &lt;/head&gt;<br>
20 &lt;body bgcolor=&quot;#ffffff&quot;&gt;<br>
21 There was an error: &lt;b&gt;$msg&lt;/b&gt;<br>
22 &lt;/body&gt;<br>
23 &lt;/html&gt;<br>
24 EOHTML<br>
25 #EOHTML行只能有这几个字母, 一个不多,一个不少.<br>
26<br>
27 # finish the state handle and disconnect, if necessary<br>
28 $sth-&gt;finish() <strong>if</strong> $sth;<br>
29 $dbh-&gt;disconnect() <strong>if</strong> $dbh;<br>
30 <strong>exit</strong> 0;<br>
31 }<br>
32<br>
33 ####<br>
34 # 程序主体在这里<br>
35 ####<br>
36<br>
37 # 连接数据库服务器<br>
38 <strong>my</strong> $dbh = DBI-&gt;<strong>connect</strong>(&lsquo;DBI:mysql:test&rsquo;, &lsquo;apache&rsquo;,
&rsquo;lampiscool&rsquo;)<br>
39 <strong>or</strong> handle_error(&ldquo;Can&rsquo;t connect&hellip;&rdquo; . DBI-&gt;errstr());<br>
40<br>
41 # 现在开始创建网页, 首先创建网页的头文件, 一个表格的头部<br>
42 <strong>print</strong> header(),<br>
43 start_html(-title=&gt;&ldquo;Project with MySQL, Perl&rdquo;,<br>
44 -bgcolor =&gt; &lsquo;#ffffff&rsquo;),<br>
45 &lt;&lt;EOHTML;<br>
46 &lt;h2&gt;Your queryed impact factor&lt;/h2&gt;<br>
47 &lt;table border=&ldquo;1&rdquo; bgcolor=yellow&gt;<br>
48 &lt;tr
bgcolor=orange&gt;&lt;th&gt;Title&lt;/th&gt;&lt;th&gt;IF04&lt;/th&gt;&lt;th&gt;IF05&lt;/th&gt;&lt;th&gt;IF06&lt;/th&gt;&lt;/tr&gt;<br>
49 EOHTML<br>
50 # 上面的这一行, 只能有这几个字符, 连一个空格都不能多,
否则会出现服务器内部错误<br>
51 # 这个table还没有结束, 下面会继续由程序创建table项目.<br>
52<br>
53 # 对返回的参数进行处理<br>
54 <strong>if</strong> (param()) {<br>
55 # 获取查询字符串.<br>
56 # inputbox的name为query, 把它返回的参数保存到$query中去<br>
57 <strong>my</strong> $query = param(&lsquo;query&rsquo;) ||&rsquo; &lsquo;;<br>
58 # 查询数据库<br>
59 <strong>my</strong> $sth = $dbh-&gt;prepare(&lsquo;SELECT title,if04,if05,if06 FROM
ifactor<br>
60 WHERE title RLIKE ? &lsquo;)<br>
61 <strong>or</strong> handle_error(&ldquo;Can&rsquo;t prepare SQL: &quot; . $dbh-&gt;errstr(),
$dbh);<br>
62<br>
63 $sth-&gt;execute($query)<br>
64 <strong>or</strong> handle_error(&ldquo;Can&rsquo;t execute SQL: &quot; . $dbh-&gt;errstr(),<br>
65 $dbh, $sth);<br>
66 <strong>my</strong>($title,$if04,$if05,$if06);<br>
67 # 这里就是表格table的中间部分<br>
68 <strong>while</strong> (($title,$if04,$if05,$if06) = $sth-&gt;fetchrow()) {<br>
69 <strong>print</strong>
&ldquo;&lt;tr&gt;&lt;th&gt;$title&lt;/th&gt;&lt;th&gt;$if04&lt;/th&gt;&lt;th&gt;$if05&lt;/th&gt;&lt;th&gt;$if06&lt;/th&gt;&lt;/tr&gt;\n&rdquo;;<br>
70 }<br>
71<br>
72 }<br>
73<br>
74 # 这里结束table的html代码, 于是有了一个完整的table.<br>
75 # 此处设置了返回数据的方法(get), 返回的目标(if.simple.cgi),<br>
76 # 一个文本框和两个按钮.<br>
77 <strong>print</strong> &lt;&lt;EOHTML;<br>
78 &lt;/table&gt;<br>
79 &lt;hr&gt;<br>
80 &lt;h2&gt;Enter query&lt;/h2&gt;<br>
81 You can enter you query below. &lt;b&gt;e.g:&lt;/b&gt; annu rev, p.*
n.* a.* s,etc<br>
82 &lt;form action=&quot;/mycgi/if.simple.cgi&rdquo; method=&ldquo;get&rdquo;&gt;<br>
83 &lt;table border=&ldquo;0&rdquo; bgcolor=orange&gt;<br>
84 &lt;tr&gt;<br>
85 &lt;td&gt;Query name:&lt;/td&gt;<br>
86 &lt;td&gt;&lt;input type=&ldquo;text&rdquo; name=&ldquo;query&rdquo; maxsize=&ldquo;20&rdquo;
value=&rdquo;&quot;&gt;&lt;/td&gt;<br>
87 &lt;/tr&gt;<br>
88 &lt;tr&gt;<br>
89 &lt;td&gt;&lt;input type=&ldquo;submit&rdquo; value=&ldquo;Submit
Data&rdquo;&gt;&lt;/td&gt;<br>
90 &lt;td&gt;&lt;input type=&ldquo;reset&rdquo; value=&ldquo;Reset Form&rdquo;&gt;&lt;/td&gt;<br>
91 &lt;/tr&gt;<br>
92 &lt;/table&gt;<br>
93 &lt;/form&gt;<br>
94 EOHTML<br>
95<br>
96 # 这一行代码标志这cgi网页的完成<br>
97 <strong>print</strong> end_html();<br>
98 # 关闭数据库连接<br>
99 $sth-&gt;finish();<br>
100 $dbh-&gt;disconnect();</p>
<p>参考资料: **Open Source Web Development with LAMP (**ISBN:
0-201-77061-X)</p>

</div>
</main>

<section class="appendix">


<div>
  <div class="side side-left"><h3>Author&#39;s bio</h3></div>
  <div>






</div>
</div>






<div>
  <div class="side side-left"><h3>Reuse</h3></div>
  Text and figures are licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution CC BY 4.0</a>. The source code is licensed under MIT. The full source is available at <a href="https://github.com/yihui/hugo-prose">https://github.com/yihui/hugo-prose</a>.
</div>



<div>
  <div class="side side-left"><h3>Suggest changes</h3></div>
  
  
  
    
    
  
  If you find any mistakes (including typos) or want to suggest changes, please feel free to <a href="https://github.com/yihui/hugo-prose/edit/master/exampleSite/content/post/2008-01-18-lamp-cgi-project.md" id="edit-link">edit the source file of this page on Github and create a pull request.</a>
</div>




<div>
  <div class="side side-left"><h3>Citation</h3></div>
  <p>For attribution, please cite this work as</p>
  <pre><code>gaoch (2008). LAMP Project[part B]-解析cgi动态网页项目源代码(下部). Hugo Prose. /post/2008/01/18/lamp-projectpart-b-%E8%A7%A3%E6%9E%90cgi%E5%8A%A8%E6%80%81%E7%BD%91%E9%A1%B5%E9%A1%B9%E7%9B%AE%E6%BA%90%E4%BB%A3%E7%A0%81%E4%B8%8B%E9%83%A8/</code></pre>
  <p>BibTeX citation</p>
  <pre><code>@misc{
  title = "LAMP Project[part B]-解析cgi动态网页项目源代码(下部)",
  author = "gaoch",
  year = "2008",
  journal = "Hugo Prose",
  note = "/post/2008/01/18/lamp-projectpart-b-%E8%A7%A3%E6%9E%90cgi%E5%8A%A8%E6%80%81%E7%BD%91%E9%A1%B5%E9%A1%B9%E7%9B%AE%E6%BA%90%E4%BB%A3%E7%A0%81%E4%B8%8B%E9%83%A8/"
}</code></pre>
</div>

</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="/post/2008/01/18/lamp-projectpart-final-%E5%B1%95%E7%A4%BA%E6%95%88%E6%9E%9C%E5%9B%BE/" title=Next&#32;post&#32;(older)>LAMP Project[part Final]-展示效果图</a></span>
  &hercon;
  <span class="nav-prev"><a href="/post/2008/01/18/%E8%BD%AC%E4%BA%94%E7%B1%B3%E8%BF%9C%E9%9A%BE%E9%81%93%E8%BF%99%E5%B0%B1%E6%98%AF%E7%94%9F%E4%B8%8E%E6%AD%BB%E7%9A%84%E8%B7%9D%E7%A6%BB%E5%90%97/" title=Previous&#32;post&#32;(newer)>[转]五米远，难道这就是生与死的距离吗？</a> &rarr;</span>
</nav>





</div>


  <footer>
  


<script src="//yihui.org/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>





<script src="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/js/number-sections.min.js,npm/@xiee/utils/js/toc.min.js,npm/@xiee/utils/js/sidenotes.min.js,npm/@xiee/utils/js/right-quote.min.js,npm/@xiee/utils/js/center-img.min.js,npm/@xiee/utils/js/fix-pandoc.min.js,npm/@xiee/utils/js/heading-anchor.min.js" defer></script>




  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="https://en.wikipedia.org/wiki/Seneca_the_Younger">Lucius Annaeus Seneca</a> 4 BC &ndash; AD 65</li>
  </ul>
  
  <ul>
    
    <li>
      <a href="/404.html">Contact</a>
    </li>
    
    <li class="optional">
      <a href="/categories/">Categories</a>
    </li>
    
    <li class="optional">
      <a href="/tags/">Tags</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script src="/js/features.js" defer></script>
  </body>
</html>

