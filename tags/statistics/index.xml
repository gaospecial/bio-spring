<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Statistics on BIO-SPRING</title>
    <link>bio-spring/tags/statistics/</link>
    <description>Recent content in Statistics on BIO-SPRING</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sun, 12 Apr 2020 00:00:00 +0000</lastBuildDate>
    <atom:link href="bio-spring/tags/statistics/" rel="self" type="application/rss+xml" />

    
      <item>
        <title>正态分布的转换</title>
        <link>bio-spring/post/2020/04/12/normal-distribution-transformation/</link>
        <pubDate>Sun, 12 Apr 2020 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2020/04/12/normal-distribution-transformation/</guid>
        <description>
          &lt;p&gt;数据满足正态分布是进行很多统计分析的前提，如果不符合正态分布，则需要对数据进行转换。常用的转化方式有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;取根号&lt;/li&gt;
&lt;li&gt;取对数&lt;/li&gt;
&lt;li&gt;取倒数&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;今天我们看一看什么条件下应该选用合适的转换方式。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 生成正态分布数据
normal &amp;lt;- rnorm(100,mean = 5, sd = 2.5)
plot(normal)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/04/12/normal-distribution-transformation/index.zh_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;80%&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 从直方图可以看出数据符合正态分布
hist(normal)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/04/12/normal-distribution-transformation/index.zh_files/figure-html/unnamed-chunk-1-2.png&#34; width=&#34;80%&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 从QQ plot也可以看出来
qqnorm(normal)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/04/12/normal-distribution-transformation/index.zh_files/figure-html/unnamed-chunk-1-3.png&#34; width=&#34;80%&#34; /&gt;
&lt;p&gt;对正态数据进行平方运算后，直方图显示数据成了左偏的结构。反过来，意味着如果你正在使用的数据与下面的数据分布类似，则可以尝试用开平方的方法来做数据标准化。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 数据的平方根
normal_square &amp;lt;- normal ^ 2

# 现在的直方图
hist(normal_square)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/04/12/normal-distribution-transformation/index.zh_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;80%&#34; /&gt;
&lt;p&gt;对正态数据进行幂值运算后，数值也是一个左偏的分布，但与平方计算的结构有所不同。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 数据的幂值
normal_exp &amp;lt;- exp(normal)

hist(normal_exp)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/04/12/normal-distribution-transformation/index.zh_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;80%&#34; /&gt;
&lt;p&gt;对正态数据进行倒数运算后，数值是一个中间翘起来的分布。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 数据的幂值
normal_reciprocal &amp;lt;- 1/normal

hist(normal_reciprocal)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/04/12/normal-distribution-transformation/index.zh_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;80%&#34; /&gt;
&lt;p&gt;上述3种方法转换正态分布后，都是正偏态数据（偏度Skewness &amp;gt; 0 ）。&lt;/p&gt;
&lt;img src=&#34;https://vnote-1251564393.cos.ap-chengdu.myqcloud.com/1586666475_20200412124107047_26263.png&#34; width=&#34;60%&#34; /&gt;
&lt;p&gt;如果是负偏态数据，则需要将负偏态资料进行反转，转换为正偏态，然后再参考正偏态分布资料的转换方法进行转换。&lt;/p&gt;
&lt;p&gt;反转的方法：首先找出该数据系列的最大值max，用max+1，在减去每个数值。&lt;/p&gt;
&lt;p&gt;接下来也用反向转换的方式，看看负偏态数据的分布规律吧。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 轻度负偏态
normal_square_rev &amp;lt;- max(normal_square)+1-normal_square
hist(normal_square_rev)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/04/12/normal-distribution-transformation/index.zh_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;80%&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 中度负偏态
normal_exp_rev &amp;lt;- max(normal_exp)+1-normal_exp
hist(normal_exp_rev)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/04/12/normal-distribution-transformation/index.zh_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;80%&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 重度负偏态
normal_reciprocal_rev &amp;lt;- max(normal_reciprocal) + 1 - normal_reciprocal
hist(normal_reciprocal_rev)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/04/12/normal-distribution-transformation/index.zh_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;80%&#34; /&gt;
&lt;p&gt;&lt;strong&gt;注意事项&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;不是任何非正态数据都可以进行正态转换；&lt;/li&gt;
&lt;li&gt;如果比较两组数据时对一组进行了正态转换，另一组也应做对应转换；&lt;/li&gt;
&lt;li&gt;在进行相关分析或线性回归时，要求变量间存在线性关系，如果因变量与某个自变量之间呈现出曲线趋势，此时转换的变量可以是自变量，也可以是因变量，或者两者均可。如果进行了变量变换，则应当重新绘制散点图，以保证线性趋势在变换后仍然存在。&lt;/li&gt;
&lt;li&gt;在对线性回归模型进行解释时，如果使用函数转换的方法对变量进行了转换，则解释时应按照转换后的变量给予解释，或者可以根据转换时使用的函数关系，倒推原始自变量对原始因变量的效应大小。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;另外，在判定数据是否符合正态分布的时候，会用到检验和QQ图、直方图等方法。一些检验方法经常会得出数据不满足正态分布的结果，但事实上只要在图形上显现出正态规律，一般还是可以认为数据来源于一个正态总体。&lt;/p&gt;
&lt;p&gt;事实上，Shapiro-Wilk检验及Kolmogorov-Smirnov检验从实用性的角度，&lt;strong&gt;远不如图形工具进行直观判断好用&lt;/strong&gt;。在使用这两种检验方法的时候要注意，当样本量较少的时候，检验结果不够敏感，即使数据分布有一定的偏离也不一定能检验出来；而当样本量较大的时候，检验结果又会太过敏感，只要数据稍微有一点偏离，P值就会&amp;lt;0.05，检验结果倾向于拒绝原假设，认为数据不服从正态分布。所以，如果样本量足够多，即使检验结果P&amp;lt;0.05，数据来自的总体也可能是服从正态分布的。&lt;/p&gt;
&lt;p&gt;因此，在实际的应用中，往往会出现这样的情况，明明直方图显示分布很对称，但正态性检验的结果P值却&amp;lt;0.05，拒绝原假设认为不服从正态分布。此时建议大家&lt;strong&gt;不要太刻意追求正态性检验的P值，一定要参考直方图、P-P图等图形工具来帮助判断&lt;/strong&gt;。很多统计学方法，如T检验、方差分析等，与其说要求数据严格服从正态分布，不如说“数据分布不要过于偏态”更为合适。&lt;/p&gt;

        </description>
      </item>
    
      <item>
        <title>ANOVA &#43; TurkeyHSD 分析及作图</title>
        <link>bio-spring/post/2019/09/24/anova-turkeyhsd-plotting/</link>
        <pubDate>Tue, 24 Sep 2019 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2019/09/24/anova-turkeyhsd-plotting/</guid>
        <description>
          &lt;p&gt;先载入一个示例数据。该数据是研究摄入 VC 对小鼠牙齿生长作用的实验结果。VC 给药分成两种方式：VC-给予VC药片；OJ-给予相当量的橙汁。给药的量都包括0.5,1,2等三个梯度。&lt;/p&gt;
&lt;p&gt;从散点图上看，不同给药量之间应该有显著差异。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;data(&amp;quot;ToothGrowth&amp;quot;)
head(ToothGrowth)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dim(ToothGrowth)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 60  3
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(ggplot2)
ggplot(ToothGrowth,aes(factor(dose),len)) + 
  geom_boxplot(outlier.shape = NULL) + 
  geom_jitter() +
  facet_wrap(~supp)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2019/09/24/anova-turkeyhsd-plotting/index.zh_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;
&lt;p&gt;单因素方差分析使用 aov() 函数，随后，进一步使用 HSD.test 获取组间差异。 Tukey’s ‘Honest Significant Difference’ method 通常使用  stats::TukeyHSD() 函数， 但在这里，我们使用 HSD.test() 可以得到分组信息，用于后面的作图。&lt;/p&gt;
&lt;p&gt;这里仅以 VC 给药方式下，不同给药量之间的差异分析为例。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(dplyr)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &#39;dplyr&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(agricolae)
data &amp;lt;- filter(ToothGrowth,supp==&amp;quot;VC&amp;quot;)
model &amp;lt;- aov(len~dose, data = data)
group &amp;lt;- HSD.test(model,&amp;quot;dose&amp;quot;,group = T)$groups
group_label &amp;lt;- data.frame(dose=rownames(group),group=group$groups,stringsAsFactors = F)
group_label &amp;lt;- data %&amp;gt;% group_by(dose) %&amp;gt;% 
  summarise(label_y = quantile(len)[[5]]) %&amp;gt;%
  mutate(dose = as.character(dose)) %&amp;gt;%
  left_join(group_label)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Joining with `by = join_by(dose)`
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dose_level &amp;lt;- sort(as.numeric(unique(as.character(data$dose))))
data$dose &amp;lt;- factor(data$dose, levels = c(0.5,1,2))
group_label$dose &amp;lt;- factor(group_label$dose, levels = c(0.5,1,2))

ggplot(data,aes(dose,len)) + geom_boxplot() +
  geom_text(mapping = aes(dose,label_y,label=group),vjust=-0.5,data = group_label) +
  # 增加 ymax 的数值
  ylim(min(data$len),max(data$len)+0.1*(max(data$len)-min(data$len))) +
  theme_bw()
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2019/09/24/anova-turkeyhsd-plotting/index.zh_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;384&#34; /&gt;
&lt;p&gt;此处仅有3个不同处理。从图中可以得知，0.5,1,2分属3个不同的分组，这意味着它们两两之间都存在显著的差异（p.adj &amp;lt; 0.05）。&lt;/p&gt;
&lt;p&gt;这种分析作图方式在 ANOVA 处理特别多的处理时会更好用。&lt;/p&gt;

        </description>
      </item>
    
      <item>
        <title>常用假设检验方法的R语言实现</title>
        <link>bio-spring/post/2019/09/23/basic-stats-in-r/</link>
        <pubDate>Mon, 23 Sep 2019 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2019/09/23/basic-stats-in-r/</guid>
        <description>
          &lt;h1 id=&#34;r中的假设检验&#34;&gt;R中的假设检验&lt;/h1&gt;
&lt;p&gt;常用的统计方法见下表所示。&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;检验方法&lt;/th&gt;
          &lt;th&gt;R函数&lt;/th&gt;
          &lt;th&gt;说明&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;T-test&lt;/td&gt;
          &lt;td&gt;t.test()&lt;/td&gt;
          &lt;td&gt;检验两组样品（参数）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Wilcoxon test&lt;/td&gt;
          &lt;td&gt;wilcox.test()&lt;/td&gt;
          &lt;td&gt;检验两组样品（非参）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;ANOVA&lt;/td&gt;
          &lt;td&gt;aov()或者anova()&lt;/td&gt;
          &lt;td&gt;检验多组样本（参数）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Kruskal-Wallis&lt;/td&gt;
          &lt;td&gt;kruskal.test()&lt;/td&gt;
          &lt;td&gt;检验多组样本（非参）&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;Mann-Whitney-Wilcoxon检验也被称为Wilcoxon检验。
In statistics, the Mann–Whitney U test (also called the Mann–Whitney–Wilcoxon (MWW), Wilcoxon rank-sum test, or Wilcoxon–Mann–Whitney test)
&lt;a href=&#34;https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test&#34;&gt;https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;本文是阅读下列内容的读书笔记：http://www.sthda.com/english/wiki/comparing-means-in-r&lt;/p&gt;

        </description>
      </item>
    
      <item>
        <title>比较不同差异系数的结果</title>
        <link>bio-spring/post/2018/11/20/comparing-dissimilarity-index/</link>
        <pubDate>Tue, 20 Nov 2018 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2018/11/20/comparing-dissimilarity-index/</guid>
        <description>
          &lt;p&gt;&lt;code&gt;vegdist&lt;/code&gt; 提供了多个计算差异度的算法。这些算法自然是各有各的适用范围。对于同一个数据集，其结果有什么直观上的差异呢？&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(vegan)
library(pheatmap)
library(cowplot)
data(&amp;quot;varespec&amp;quot;)
dist.methods &amp;lt;- c(&amp;quot;manhattan&amp;quot;, &amp;quot;euclidean&amp;quot;, &amp;quot;canberra&amp;quot;, &amp;quot;clark&amp;quot;, &amp;quot;bray&amp;quot;, &amp;quot;kulczynski&amp;quot;, &amp;quot;jaccard&amp;quot;, &amp;quot;gower&amp;quot;, &amp;quot;altGower&amp;quot;, &amp;quot;morisita&amp;quot;, &amp;quot;horn&amp;quot;, &amp;quot;mountford&amp;quot;, &amp;quot;raup&amp;quot;, &amp;quot;binomial&amp;quot;, &amp;quot;chao&amp;quot;, &amp;quot;cao&amp;quot; , &amp;quot;mahalanobis&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;对于这17种方法，分别计算其距离，用 &lt;code&gt;pheatmap()&lt;/code&gt; 比较其差异。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dist.plots &amp;lt;- vector(&amp;quot;list&amp;quot;,length(dist.methods))
for (i in seq_along(dist.methods)){
  dist &amp;lt;- vegdist(varespec,method = dist.methods[[i]])
  plot &amp;lt;- pheatmap(dist,cluster_cols = F,cluster_rows = F,main = dist.methods[[i]],silent = T)
  dist.plots[[i]] = plot[[4]]
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning in vegdist(varespec, method = dist.methods[[i]]): results may be
## meaningless with non-integer data in method &amp;quot;morisita&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning in vegdist(varespec, method = dist.methods[[i]]): results may be
## meaningless with non-integer data in method &amp;quot;chao&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning in vegdist(varespec, method = dist.methods[[i]]): results may be
## meaningless with non-integer data in method &amp;quot;cao&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;差距还是挺大的。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot_grid(plotlist = dist.plots,labels = &amp;quot;AUTO&amp;quot;,ncol=4)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2018/11/20/comparing-dissimilarity-index/index.zh_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;960&#34; /&gt;

        </description>
      </item>
    
      <item>
        <title>比较 stats::procmp() 和 vegan::rda() 两种方法</title>
        <link>bio-spring/post/2018/11/02/comparison-of-two-pca-methods/</link>
        <pubDate>Fri, 02 Nov 2018 00:00:00 +0000</pubDate>
        <author>Gao</author>
        <guid>bio-spring/post/2018/11/02/comparison-of-two-pca-methods/</guid>
        <description>
          &lt;p&gt;上次提及 PCA 分析的方法有很多种。那不同方法之间的得到的结果会有差异吗？&lt;/p&gt;
&lt;p&gt;最近采用 PCA 分析 RNA-seq 样本之间的差异，得到了下面的结果。&lt;/p&gt;
&lt;h1 id=&#34;生成示例数据&#34;&gt;生成示例数据&lt;/h1&gt;
&lt;p&gt;生成一个含有 1000 个基因, 27 个样品的数据集.
这 27 个样品来自于 3 个基因型(WT, Mutant1, Mutant2),
3 种处理(CK, Trt1, Trt2), 共分为 &lt;code&gt;\(3 * 3 = 9\)&lt;/code&gt; 组,
每组 3 个重复, 合计 27 个样品.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(DESeq2)
library(dplyr)
library(ggplot2)
theme_set(theme_bw())

dds &amp;lt;- makeExampleDESeqDataSet(n = 1000, m=27)
dds$condition &amp;lt;- factor(rep(rep(c(&amp;quot;Ctrl&amp;quot;,&amp;quot;Trt1&amp;quot;,&amp;quot;Trt2&amp;quot;),3), 3))
dds$genotype &amp;lt;- factor(rep(rep(c(&amp;quot;WT&amp;quot;,&amp;quot;MuA&amp;quot;,&amp;quot;MuB&amp;quot;), each=3),3))

# sample table
sample_table &amp;lt;- colData(dds) %&amp;gt;% as.data.frame() %&amp;gt;%
  tibble::rownames_to_column(var=&amp;quot;sample_id&amp;quot;)

# 做 log2 变换
rld &amp;lt;- rlog(dds, blind = F)
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;使用-statsprcomp-进行主成分分析&#34;&gt;使用 &lt;code&gt;stats::prcomp()&lt;/code&gt; 进行主成分分析&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 运行 PCA
pca &amp;lt;- stats::prcomp(t(assay(rld)))

# 计算解释度
percent_var &amp;lt;- pca$sdev^2/sum(pca$sdev^2)

# 绘图
df &amp;lt;- data.frame(PC1=pca$x[,1], 
PC2=pca$x[,2], sample_id=colnames(rld)) %&amp;gt;% 
  left_join(sample_table)

mapping &amp;lt;- aes(PC1, PC2, color=condition, shape=genotype,label=sample_id)

p1 &amp;lt;- ggplot(df,mapping) +
    geom_point(size=3) +
    ggrepel::geom_text_repel(show.legend = F) +
    xlab(paste0(&amp;quot;PC1: &amp;quot;, round(percent_var[1] * 100), &amp;quot;% variance&amp;quot;)) + 
    ylab(paste0(&amp;quot;PC2: &amp;quot;, round(percent_var[2] * 100), &amp;quot;% variance&amp;quot;)) +
    ggtitle(&amp;quot;method: stats::prcomp()&amp;quot;)
    
p1
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2018/11/02/comparison-of-two-pca-methods/index.zh_files/figure-html/pca1-1.png&#34; width=&#34;768&#34; /&gt;
&lt;h1 id=&#34;使用-veganrda-做主成分分析&#34;&gt;使用 &lt;code&gt;vegan::rda()&lt;/code&gt; 做主成分分析&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# rda() 分析
pca &amp;lt;- vegan::rda(t(assay(rld))) 

# 计算解释度
percent_var &amp;lt;- pca$CA$eig/pca$tot.chi  # rda() 的结果中信息比较完整
df &amp;lt;- vegan::scores(pca)$sites %&amp;gt;% 
  as.data.frame() %&amp;gt;%
  tibble::rownames_to_column(var=&amp;quot;sample_id&amp;quot;) %&amp;gt;%
  left_join(sample_table)

p2 &amp;lt;- ggplot(df,mapping) +
    geom_point(size=3) +
    ggrepel::geom_text_repel(show.legend = F) +
    xlab(paste0(&amp;quot;PC1: &amp;quot;, round(percent_var[1] * 100), &amp;quot;% variance&amp;quot;)) + 
    ylab(paste0(&amp;quot;PC2: &amp;quot;, round(percent_var[2] * 100), &amp;quot;% variance&amp;quot;)) + 
  ggtitle(&amp;quot;method: vegan::rda()&amp;quot;)

p2
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2018/11/02/comparison-of-two-pca-methods/index.zh_files/figure-html/pca2-1.png&#34; width=&#34;768&#34; /&gt;
&lt;h1 id=&#34;放在一起比较一下&#34;&gt;放在一起比较一下&lt;/h1&gt;
&lt;p&gt;可以看出，虽然两种方法计算的数值有差异，但是坐标位置是一致。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;cowplot::plot_grid(p1,p2,labels = &amp;quot;AUTO&amp;quot;,ncol=1,align = &amp;quot;hv&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2018/11/02/comparison-of-two-pca-methods/index.zh_files/figure-html/pca_plot-1.png&#34; width=&#34;768&#34; /&gt;

        </description>
      </item>
    
      <item>
        <title>Bray Curtis Dissimilarity</title>
        <link>bio-spring/post/2018/10/17/bray-curtis-dissimilarity/</link>
        <pubDate>Wed, 17 Oct 2018 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2018/10/17/bray-curtis-dissimilarity/</guid>
        <description>
          &lt;p&gt;本文介绍 Bray Curtis Dissimilarity 的概念和计算方法。&lt;/p&gt;
&lt;p&gt;Bray Curtis Dissimilarity（Bray-Curtis 相异度）是生态学中用来衡量不同样地&lt;strong&gt;物种组成差异&lt;/strong&gt;的参数。&lt;/p&gt;
&lt;p&gt;其定义和计算公式为：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$$BC_{ij}=1-2C_{ij}/(S_{i}+S_{j})$$&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;其中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;\(i\)&lt;/code&gt; 和 &lt;code&gt;\(j\)&lt;/code&gt; 是两个样地；&lt;/li&gt;
&lt;li&gt;&lt;code&gt;\(S_i\)&lt;/code&gt; 是样地 &lt;code&gt;\(i\)&lt;/code&gt; 中物种的总数；&lt;/li&gt;
&lt;li&gt;&lt;code&gt;\(S_j\)&lt;/code&gt; 是样地 &lt;code&gt;\(j\)&lt;/code&gt; 中物种的总数；&lt;/li&gt;
&lt;li&gt;&lt;code&gt;\(C_{ij}\)&lt;/code&gt; 在两块样地中每个物种的较少计数的总和。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;简单的例子&#34;&gt;简单的例子&lt;/h2&gt;
&lt;p&gt;有两个水族箱：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;一号：6条金鱼，7条孔雀鱼和4只螃蟹；&lt;/li&gt;
&lt;li&gt;二号：10条金鱼和6只螃蟹。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;为了计算 Bray-Curtis，首先计算$C_{ij}$。金鱼两个地方都有，较少的是6；孔雀鱼只在一号中有，所以不能添加；螃蟹两个地方都有，较少的是4。因此，$C_{ij}=6+4=10$。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;\(S_i=6+7+4=17\)&lt;/code&gt;，而$S_j=10+6=16$。&lt;/p&gt;
&lt;p&gt;因此,&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$$BC_{ij}=1-(2*10)/(17+16)=0.39$$&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;bray-curtis-dissimilarity-的性质&#34;&gt;Bray-Curtis Dissimilarity 的性质&lt;/h2&gt;
&lt;p&gt;其取值介于0-1之间。如果是0，则两个样地共享所有相同的物种；如果是1，则它们不共享任何物种。&lt;/p&gt;
&lt;p&gt;还有另外一个 Bray-Curtis index，其取值是 1 - Bray-Curtis dissimilarity。表示两个样地之间的相似程度。&lt;/p&gt;
&lt;h2 id=&#34;适用情况&#34;&gt;适用情况&lt;/h2&gt;
&lt;p&gt;要计算 Bray-Curtis Dissimilarity，必须假设两个样地的面积或体积大小相同（与物种计数相关），否则需要在计算前调整计数。&lt;/p&gt;
&lt;h2 id=&#34;r语言实现&#34;&gt;R语言实现&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;vegan&lt;/code&gt;提供了&lt;code&gt;vegdist&lt;/code&gt;来计算这个数值。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;## 用 vegdist 重复上面的例子
df &amp;lt;- data.frame(goldfish=c(6,10),guppies=c(7,0),crab=c(4,6))
require(&amp;quot;vegan&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: vegan
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: permute
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: lattice
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## This is vegan 2.6-4
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;vegdist(df,method = &amp;quot;bray&amp;quot;) # 这个值跟前面人脑计算的一致
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##           1
## 2 0.3939394
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;## 计算群落数据
data(&amp;quot;varespec&amp;quot;)
## 计算不同样地两两之间的差异度
bc &amp;lt;- vegdist(varespec)

## 使用pheatmap做一个热图
pheatmap::pheatmap(bc,breaks = seq(0,1,0.01))
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2018/10/17/bray-curtis-dissimilarity/index.zh_files/figure-html/vegdist-1.png&#34; width=&#34;576&#34; /&gt;
&lt;h2 id=&#34;延伸阅读&#34;&gt;延伸阅读&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;vegdist&lt;/code&gt;的可用的方法（&lt;code&gt;method = &amp;quot;bray&amp;quot;&lt;/code&gt;）还包括 &amp;ldquo;manhattan&amp;rdquo;, &amp;ldquo;euclidean&amp;rdquo;, &amp;ldquo;canberra&amp;rdquo;, &amp;ldquo;clark&amp;rdquo;, &amp;ldquo;bray&amp;rdquo;, &amp;ldquo;kulczynski&amp;rdquo;, &amp;ldquo;jaccard&amp;rdquo;, &amp;ldquo;gower&amp;rdquo;, &amp;ldquo;altGower&amp;rdquo;, &amp;ldquo;morisita&amp;rdquo;, &amp;ldquo;horn&amp;rdquo;, &amp;ldquo;mountford&amp;rdquo;, &amp;ldquo;raup&amp;rdquo;, &amp;ldquo;binomial&amp;rdquo;, &amp;ldquo;chao&amp;rdquo;, &amp;ldquo;cao&amp;rdquo; or &amp;ldquo;mahalanobis&amp;rdquo;。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;designdist&lt;/code&gt;可用来设计自己的差异度算法。&lt;/p&gt;
&lt;h2 id=&#34;参考资料&#34;&gt;参考资料&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://www.statisticshowto.datasciencecentral.com/bray-curtis-dissimilarity/&#34;&gt;https://www.statisticshowto.datasciencecentral.com/bray-curtis-dissimilarity/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;?vegdist&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

        </description>
      </item>
    
  </channel>
</rss>
