<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>GgVennDiagram on BIO-SPRING</title>
    <link>bio-spring/tags/ggvenndiagram/</link>
    <description>Recent content in GgVennDiagram on BIO-SPRING</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sat, 08 May 2021 00:00:00 +0000</lastBuildDate>
    <atom:link href="bio-spring/tags/ggvenndiagram/" rel="self" type="application/rss+xml" />

    
      <item>
        <title>ggVennDiagram 的新生</title>
        <link>bio-spring/post/2021/05/08/ggvenndiagram-reborn/</link>
        <pubDate>Sat, 08 May 2021 00:00:00 +0000</pubDate>
        <author>Chun-Hui Gao</author>
        <guid>bio-spring/post/2021/05/08/ggvenndiagram-reborn/</guid>
        <description>
          &lt;p&gt;&lt;code&gt;ggVennDiagram&lt;/code&gt; 是一个用于绘制 Venn 图的 R 语言软件包。最初，我只是在需要画 Venn
图的时候，发现没有一件趁手的工具，而最终不得不写了一个给自己用的工具。随后，
抱着试一试的态度发布到了 GitHub 和 CRAN 上面。结果引起了用户持续的关注和好评，
截止今日已经获得了超过 100 个小星星。&lt;/p&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;
&lt;p&gt;在 CRAN 上面也已经被累计下载了 2 万多次了。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cran.r-project.org/package=ggVennDiagram&#34;&gt;&lt;img src=&#34;http://cranlogs.r-pkg.org/badges/grand-total/ggVennDiagram&#34; alt=&#34;&#34;&gt;&lt;/a&gt;
&lt;a href=&#34;https://cran.r-project.org/package=ggVennDiagram&#34;&gt;&lt;img src=&#34;https://www.r-pkg.org/badges/version/ggVennDiagram?color=green&#34; alt=&#34;&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;考虑到原来的设计和代码是十分粗糙的，所以我在 1.0 版本的时候，完全重构了 &lt;code&gt;ggVennDiagram&lt;/code&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;p&gt;为此，系统调研了 R 环境中可用的 Venn 图绘制工具，博取众家之长，并增强了自己原有的特色和优势。
重生后的 &lt;code&gt;ggVennDiagram&lt;/code&gt; 用起来更加方便，功能也更加强大，同时以后的扩展性也会非常好。&lt;/p&gt;
&lt;p&gt;下面是一些使用的示例：&lt;/p&gt;
&lt;p&gt;先生成一个示例数据：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;pak::pak(&amp;quot;gaospecial/ggVennDiagram@V1.1&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## ℹ Loading metadata database
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## ✔ Loading metadata database ... done
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## ℹ No downloads are needed
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## ✔ 1 pkg + 90 deps: kept 62 [4s]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;genes &amp;lt;- paste0(&amp;quot;gene&amp;quot;,1:1000)
set.seed(20210502)
gene_list &amp;lt;- list(A = sample(genes,100),
                  B = sample(genes,200),
                  C = sample(genes,300),
                  D = sample(genes,200))

library(ggVennDiagram)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;设置集合标签的内容颜色和大小&#34;&gt;设置集合标签的内容，颜色和大小&lt;/h2&gt;
&lt;p&gt;标签图层在最上面，不会被填充遮盖。但是如果是非常长的标签，可能会显示不完整。
此时只需要应用一个 &lt;code&gt;ggplot2&lt;/code&gt; 函数即可。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggVennDiagram(gene_list, 
              category.names = c(&amp;quot;a very long name&amp;quot;,&amp;quot;short name&amp;quot;,&amp;quot;name&amp;quot;,&amp;quot;another name&amp;quot;),
              set_color = c(&amp;quot;red1&amp;quot;,&amp;quot;red2&amp;quot;,&amp;quot;red3&amp;quot;,&amp;quot;red4&amp;quot;),
              set_size = 6) +
  scale_x_continuous(expand = expansion(mult = .2))
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; /&gt;
&lt;h2 id=&#34;显示区域中的成员&#34;&gt;显示区域中的成员&lt;/h2&gt;
&lt;p&gt;我们使用 &lt;code&gt;plotly&lt;/code&gt; 对区域成员进行了可视化，现在鼠标悬停即可以查看区域成员。
同时，也支持将成员打印出来。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggVennDiagram(gene_list, show_intersect = TRUE)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;设定区域标签的内容颜色和大小&#34;&gt;设定区域标签的内容、颜色和大小&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggVennDiagram(gene_list, label = &amp;quot;count&amp;quot;, label_color = &amp;quot;blue&amp;quot;, label_size = 4)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggVennDiagram(gene_list, label = &amp;quot;both&amp;quot;, label_percent_digit = 1, label_size = 3)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;
&lt;h2 id=&#34;设定椭圆的边&#34;&gt;设定椭圆的边&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggVennDiagram(gene_list, edge_lty = &amp;quot;dashed&amp;quot;, edge_size = 1)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;672&#34; /&gt;
&lt;h2 id=&#34;换一个配色&#34;&gt;换一个配色&lt;/h2&gt;
&lt;p&gt;填充色映射到不同的区域中。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggVennDiagram(gene_list) + scale_fill_distiller(palette = &amp;quot;RdBu&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; /&gt;
&lt;p&gt;线条颜色映射到不同的集合上。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggVennDiagram(gene_list) + scale_color_brewer(palette = &amp;quot;Set1&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;672&#34; /&gt;
&lt;h2 id=&#34;更多维度的-venn-图&#34;&gt;更多维度的 Venn 图&lt;/h2&gt;
&lt;p&gt;通过导入另一个 R 包 &lt;code&gt;venn&lt;/code&gt; 中的数据集，将 5-7 维度的 Venn 图画法移植了过来。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;genes &amp;lt;- paste0(&amp;quot;gene&amp;quot;,1:1000)
set.seed(20210507)
x &amp;lt;- list(A = sample(genes,100),
          B = sample(genes,150),
          C = sample(genes,200),
          D = sample(genes,250),
          E = sample(genes,300),
          F = sample(genes,350),
          G = sample(genes,400))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;由于是用的不规则多边形，所以这些 Venn 图可能辨别起来会比较费劲，但是乍看上去还是蛮漂亮的。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggVennDiagram(x, label = &amp;quot;none&amp;quot;, edge_size = 2) + scale_fill_distiller(palette = &amp;quot;RdBu&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;672&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggVennDiagram(x[1:6], label = &amp;quot;none&amp;quot;, edge_size = 2) + scale_fill_distiller(palette = &amp;quot;RdBu&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-12-2.png&#34; width=&#34;672&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggVennDiagram(x[1:5], label = &amp;quot;none&amp;quot;, edge_size = 2) + scale_fill_distiller(palette = &amp;quot;RdBu&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-12-3.png&#34; width=&#34;672&#34; /&gt;
&lt;h2 id=&#34;自由定制&#34;&gt;自由定制&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;ggVennDiagram&lt;/code&gt; 将 Venn 图分为了 3 个部分，集合的标签，集合的边缘，集合的交叉，
分别称为 &lt;code&gt;setLabel&lt;/code&gt;，&lt;code&gt;setEdge&lt;/code&gt; 和 &lt;code&gt;region&lt;/code&gt;。我们所做的主要工作是将繁琐的集合间计算
过程包装了起来（包括多边形区域的坐标及其对应成员的统计），并将计算的结果返回，
然后使用 &lt;code&gt;ggplot&lt;/code&gt; 画图。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;venn &amp;lt;- Venn(gene_list)
data &amp;lt;- process_data(venn)
ggplot() +
  # 1. region count layer
  geom_sf(aes(fill = count), data = venn_region(data)) +
  # 2. set edge layer
  geom_sf(aes(color = id), data = venn_setedge(data), show.legend = FALSE) +
  # 3. set label layer
  geom_sf_text(aes(label = name), data = venn_setlabel(data)) +
  # 4. region label layer
  geom_sf_label(aes(label = count), data = venn_region(data)) +
  theme_void()
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-13-1.png&#34; width=&#34;672&#34; /&gt;
&lt;p&gt;对于熟悉 &lt;code&gt;ggplot&lt;/code&gt; 作图的用户来说，他完全可以任意定制作图的格式。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggplot() +
  # change mapping of color filling
  geom_sf(aes(fill = id), data = venn_region(data), show.legend = FALSE) +  
  # adjust edge size and color
  geom_sf(color=&amp;quot;grey&amp;quot;, size = 3, data = venn_setedge(data), show.legend = FALSE) +  
  # show set label in bold
  geom_sf_text(aes(label = name), fontface = &amp;quot;bold&amp;quot;, data = venn_setlabel(data)) +  
  # add a alternative region name
  geom_sf_label(aes(label = name), data = venn_region(data), alpha = 0.5) +  
  theme_void()
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-14-1.png&#34; width=&#34;672&#34; /&gt;
&lt;p&gt;新的 &lt;code&gt;ggVennDiagram&lt;/code&gt; 更好用，更优雅。每一个绘制 Venn 图的朋友可能都会用得上。&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;同时也是为了能够作为一篇文章发表。&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;

        </description>
      </item>
    
      <item>
        <title>发布 `ggVennDiagram` 0.5.0</title>
        <link>bio-spring/post/2021/03/01/release-ggvenndiagram-0-5-0/</link>
        <pubDate>Mon, 01 Mar 2021 00:00:00 +0000</pubDate>
        <author>Chun-Hui Gao</author>
        <guid>bio-spring/post/2021/03/01/release-ggvenndiagram-0-5-0/</guid>
        <description>
          &lt;p&gt;昨天正式发布了 &lt;code&gt;ggVennDiagram&lt;/code&gt; 0.5.0. 上一个在 CRAN 的版本是 0.3，之所以中间跳了
一下，是因为当初自己还不清楚如何更新已经发布在 CRAN 上的 R 包。&lt;/p&gt;
&lt;p&gt;这次是通过 &lt;code&gt;devtools::release()&lt;/code&gt; 来自动化发布的。不得不说这个工具的出现，真的大大
方便了 R 包的开发。对包作者的崇敬之情油然而生。&lt;/p&gt;
&lt;p&gt;简单来说还是分成以下几个步骤：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;更新软件包的功能；&lt;/li&gt;
&lt;li&gt;按照 &lt;code&gt;release()&lt;/code&gt; 函数的指引一步步完成发布前的准备工作，并将其提交到 CRAN；&lt;/li&gt;
&lt;li&gt;到作者邮箱中检查 CRAN 发来的确认邮件，确认提交；&lt;/li&gt;
&lt;li&gt;如果 CRAN 有邮件回复，解决其提出来的问题；&lt;/li&gt;
&lt;li&gt;最后，CRAN 会在 R 包上线后发出一封邮件通知；&lt;/li&gt;
&lt;li&gt;这时，回到自己的 GitHub，为新版本创建一个 tag。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://vnote-1251564393.cos.ap-chengdu.myqcloud.com/typora-img/ggVennDiagram_0.5.0.png&#34; alt=&#34;新鲜出炉的新版本&#34;&gt;&lt;/p&gt;
&lt;p&gt;新版本刚刚上线，可以看到只有源代码更新了，Windows 等系统下的二进制还没有编译更新。&lt;/p&gt;
&lt;p&gt;到如今，才算是真正走通了 R 包开发的流程。&lt;/p&gt;

        </description>
      </item>
    
  </channel>
</rss>
