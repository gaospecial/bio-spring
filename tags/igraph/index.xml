<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Igraph on BIO-SPRING</title>
    <link>bio-spring/tags/igraph/</link>
    <description>Recent content in Igraph on BIO-SPRING</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Wed, 26 Feb 2020 00:00:00 +0000</lastBuildDate>
    <atom:link href="bio-spring/tags/igraph/" rel="self" type="application/rss+xml" />

    
      <item>
        <title>igraph matrices</title>
        <link>bio-spring/post/2020/02/26/igraph-matrices/</link>
        <pubDate>Wed, 26 Feb 2020 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2020/02/26/igraph-matrices/</guid>
        <description>
          &lt;h2 id=&#34;关联矩阵incidence-matrix&#34;&gt;关联矩阵（incidence matrix）&lt;/h2&gt;
&lt;p&gt;我们生成的这个矩阵的原型是一个引证关系矩阵。
矩阵中的三行代表3篇文献，四列代表4篇引文。
1/2/3/4是在A/B/C前面发表的文献,A/B/C是后来发表的文献。
其中文献A引用了3/4，文献B引用了1/2/4，文献C引用了1/2/4。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(igraph)
library(Matrix)

set.seed(3)
m &amp;lt;- matrix(data = sample(0:1, 12, replace = TRUE),nrow = 3)
rownames(m) &amp;lt;- LETTERS[1:3]
colnames(m) &amp;lt;- 1:4
m
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   1 2 3 4
## A 0 0 1 1
## B 1 1 0 1
## C 1 1 0 1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这样的一个引证关系，可以用下面的图表示。&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;bibliometrix::cocMatrix()&lt;/code&gt; 中将这种矩阵称为共现矩阵，Co-occurrence Matrix。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;par(mar=c(1,1,1,1))

g1 &amp;lt;- graph_from_incidence_matrix(m,directed = TRUE,mode = &amp;quot;out&amp;quot;) 
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: `graph_from_incidence_matrix()` was deprecated in igraph 1.6.0.
## ℹ Please use `graph_from_biadjacency_matrix()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot(g1)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-matrices/index.zh_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; /&gt;
&lt;p&gt;上面的矩阵通过矩阵叉乘可以得到不同的邻接矩阵，用于生成新的网络。&lt;/p&gt;
&lt;h2 id=&#34;矩阵和向量的计算&#34;&gt;矩阵和向量的计算&lt;/h2&gt;
&lt;p&gt;矩阵的点乘就是矩阵各个对应元素相乘, 这个时候要求两个矩阵必须同样大小。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/u013066730/article/details/57462299&#34;&gt;https://blog.csdn.net/u013066730/article/details/57462299&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;矩阵的叉乘（乘法）就是矩阵A的第一行乘以矩阵B的第一列，各个元素对应相乘然后求和作为第一元素的值。
矩阵只有当左边矩阵的列数等于右边矩阵的行数时才可以相乘,
乘积矩阵的行数等于左边矩阵的行数,乘积矩阵的列数等于右边矩阵的列数。&lt;/p&gt;
&lt;p&gt;向量的点乘和叉乘是矩阵算法的基础。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/dcrmg/article/details/52416832&#34;&gt;https://blog.csdn.net/dcrmg/article/details/52416832&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;向量的点乘,也叫向量的内积、数量积，对两个向量执行点乘运算，
就是对这两个向量对应位一一相乘之后求和的操作，点乘的结果是一个标量。&lt;/p&gt;
&lt;p&gt;点乘的几何意义是可以用来表征或计算两个向量之间的夹角，以及在b向量在a向量方向上的投影。&lt;/p&gt;
&lt;p&gt;两个向量的叉乘，又叫向量积、外积、叉积，叉乘的运算结果是一个向量而不是一个标量。并且两个向量的叉积与这两个向量组成的坐标平面垂直。&lt;/p&gt;
&lt;p&gt;在 R 语言中，使用 &lt;code&gt;%*%&lt;/code&gt; 计算矩阵的叉乘，而 &lt;code&gt;crossprod()&lt;/code&gt; 和 &lt;code&gt;tcrossprod()&lt;/code&gt; 函数对算法进行了优化。&lt;/p&gt;
&lt;p&gt;此外，&lt;code&gt;crossprod()&lt;/code&gt; 对计算过程也进行了变动，同一个矩阵的叉乘时不需要预先转置。&lt;/p&gt;
&lt;p&gt;下面的三个个计算结果一样。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;m %*% t(m)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   A B C
## A 2 1 1
## B 1 3 3
## C 1 3 3
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;crossprod(t(m),t(m))
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   A B C
## A 2 1 1
## B 1 3 3
## C 1 3 3
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;tcrossprod(m,m)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   A B C
## A 2 1 1
## B 1 3 3
## C 1 3 3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;下面的两个结果也一样。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;t(m) %*% m
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   1 2 3 4
## 1 2 2 0 2
## 2 2 2 0 2
## 3 0 0 1 1
## 4 2 2 1 3
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;crossprod(m,m)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   1 2 3 4
## 1 2 2 0 2
## 2 2 2 0 2
## 3 0 0 1 1
## 4 2 2 1 3
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;邻接矩阵adjacency-matrix&#34;&gt;邻接矩阵（adjacency matrix）&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;m2 &amp;lt;- crossprod(m,m)
m2
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   1 2 3 4
## 1 2 2 0 2
## 2 2 2 0 2
## 3 0 0 1 1
## 4 2 2 1 3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;共被引（co-citation）是指当两篇（或多篇）文献同时被后来一篇（或多篇）论文所引用的关系，
同时引用这两篇论文的文献数目则称为共被引强度。
文献的共被引关系会随着时间的变化而变化。
通过对文献共被引网络的研究可以探究科学的发展和演进动态。&lt;/p&gt;
&lt;p&gt;根据共被引的定义，文献1和2同时被B和C引用，二者具有共被引关系，共被引强度是2。
同理，文献3和4之间的共被引强度是1，
文献1和3的共被引强度是0，文献2和3的共被引强度是0；
文献2和4的共被引强度是2，文献1和4的共被引强度是2。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;g2 &amp;lt;- graph_from_adjacency_matrix(m2, mode = &amp;quot;undirected&amp;quot;)
par(mar=c(1,1,1,1))
plot(g2,layout=layout_with_kk)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-matrices/index.zh_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;
&lt;p&gt;若文献A和文献B引用了相同的参考文献，则它们之间构成耦合关系（coupling）。
它们所包含相同参考文献的个数成为耦合强度。
如果两篇文献同时引用了1篇文献，则耦合度为1；若同时引用了3篇文献，则耦合度为3。
两篇文献拥有的共同参考文献越多，则其研究内容越相似。&lt;/p&gt;
&lt;p&gt;耦合关系的邻接矩阵可以用转置后关联矩阵的叉乘来表示。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;m3 &amp;lt;- crossprod(t(m),t(m))
m3
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   A B C
## A 2 1 1
## B 1 3 3
## C 1 3 3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;文献B和C共同引用了1/2/4号文献，因此它们之间的耦合关系最强，数值为3。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;g3 &amp;lt;- graph_from_adjacency_matrix(m3, mode = &amp;quot;undirected&amp;quot;)
par(mar=c(1,1,1,1))
plot(g3)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-matrices/index.zh_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;672&#34; /&gt;
&lt;p&gt;从文献耦合的概念上看，一个文献引用的参考文献越多，
那么它将有越多的机会与其它文献建立耦合关系。
为了消除这种影响，通常需要对原始数据使用 Jaccard 或 Salton 方法进行标准化处理，
来计算相对的耦合强度。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bibliometrix::normalizeSimilarity()&lt;/code&gt; 提供了3种方法来标准化耦合矩阵。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;method &amp;lt;- c(&amp;quot;association&amp;quot;, &amp;quot;jaccard&amp;quot;, &amp;quot;inclusion&amp;quot;,&amp;quot;salton&amp;quot;, &amp;quot;equivalence&amp;quot;)
m3_list &amp;lt;- lapply(method, function(x){
  bibliometrix::normalizeSimilarity(m3,type = x)
})
names(m3_list) &amp;lt;- method
m3_list
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## $association
## 3 x 3 sparse Matrix of class &amp;quot;dsCMatrix&amp;quot;
##           A         B         C
## A 0.5000000 0.1666667 0.1666667
## B 0.1666667 0.3333333 0.3333333
## C 0.1666667 0.3333333 0.3333333
## 
## $jaccard
## 3 x 3 sparse Matrix of class &amp;quot;dsCMatrix&amp;quot;
##      A    B    C
## A 1.00 0.25 0.25
## B 0.25 1.00 1.00
## C 0.25 1.00 1.00
## 
## $inclusion
## 3 x 3 sparse Matrix of class &amp;quot;dsCMatrix&amp;quot;
##     A   B   C
## A 1.0 0.5 0.5
## B 0.5 1.0 1.0
## C 0.5 1.0 1.0
## 
## $salton
## 3 x 3 sparse Matrix of class &amp;quot;dsCMatrix&amp;quot;
##           A         B         C
## A 1.0000000 0.4082483 0.4082483
## B 0.4082483 1.0000000 1.0000000
## C 0.4082483 1.0000000 1.0000000
## 
## $equivalence
## 3 x 3 sparse Matrix of class &amp;quot;dsCMatrix&amp;quot;
##           A         B         C
## A 1.0000000 0.1666667 0.1666667
## B 0.1666667 1.0000000 1.0000000
## C 0.1666667 1.0000000 1.0000000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;标准化的邻接矩阵最大值都不超过1，因此在创建网络的时候要使用“&lt;code&gt;weighted = TRUE&lt;/code&gt;”模式。
这样，矩阵的强度将会转变为边的属性。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;par(mfrow=c(2,3))
success &amp;lt;- lapply(seq_along(m3_list), function(x){
  par(mar=c(1,1,1,1))
  graph_from_adjacency_matrix(m3_list[[x]], mode = &amp;quot;undirected&amp;quot;, weighted = TRUE) %&amp;gt;% 
    plot(main=method[[x]])
})
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-matrices/index.zh_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;672&#34; /&gt;
&lt;p&gt;乍看上去，生成的网络是一样的，但事实上边的属性不一样。
如果我们把边的宽度映射到“weight”属性，则仍然可以发现文献B和C之间的耦合关系是最强的。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;par(mfrow=c(2,3))
success &amp;lt;- lapply(seq_along(m3_list), function(x){
  par(mar=c(1,1,1,1))
  g3_weighted &amp;lt;- graph_from_adjacency_matrix(m3_list[[x]], mode = &amp;quot;undirected&amp;quot;, weighted = TRUE)
  E(g3_weighted)$width  &amp;lt;- edge.attributes(g3_weighted)$weight*5
  plot(g3_weighted, main=method[[x]])
})
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-matrices/index.zh_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;672&#34; /&gt;
&lt;p&gt;对于耦合网络来说，图中的 loop 是没有意义的。可以使用 &lt;code&gt;igraph::simplify()&lt;/code&gt; 来去掉。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;g4 &amp;lt;- simplify(g3, remove.multiple = FALSE, remove.loops = TRUE)
plot(g4)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-matrices/index.zh_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;672&#34; /&gt;

        </description>
      </item>
    
      <item>
        <title>igraph: 生成网络</title>
        <link>bio-spring/post/2020/02/26/igraph-make-graph/</link>
        <pubDate>Wed, 26 Feb 2020 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2020/02/26/igraph-make-graph/</guid>
        <description>
          &lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(igraph)
notable_graph &amp;lt;- c(&amp;quot;Bull&amp;quot;, &amp;quot;Chvatal&amp;quot;, &amp;quot;Coxeter&amp;quot;, &amp;quot;Cubical&amp;quot;, &amp;quot;Diamond&amp;quot;, &amp;quot;Dodecahedral&amp;quot;, &amp;quot;Dodecahedron&amp;quot;, 
                   &amp;quot;Folkman&amp;quot;, &amp;quot;Franklin&amp;quot;, &amp;quot;Frucht&amp;quot;, &amp;quot;Grotzsch&amp;quot;, &amp;quot;Heawood&amp;quot;, &amp;quot;Herschel&amp;quot;, &amp;quot;House&amp;quot;, 
                   &amp;quot;HouseX&amp;quot;, &amp;quot;Icosahedral&amp;quot;, &amp;quot;Icosahedron&amp;quot;, &amp;quot;Krackhardt kite&amp;quot;, &amp;quot;Levi&amp;quot;, &amp;quot;McGee&amp;quot;, 
                   &amp;quot;Meredith&amp;quot;, &amp;quot;Noperfectmatching&amp;quot;, &amp;quot;Nonline&amp;quot;, &amp;quot;Octahedral&amp;quot;, &amp;quot;Octahedron&amp;quot;, 
                   &amp;quot;Petersen&amp;quot;, &amp;quot;Robertson&amp;quot;, &amp;quot;Smallestcyclicgroup&amp;quot;, &amp;quot;Tetrahedral&amp;quot;, &amp;quot;Tetrahedron&amp;quot;, 
                   &amp;quot;Thomassen&amp;quot;, &amp;quot;Tutte&amp;quot;, &amp;quot;Uniquely3colorable&amp;quot;, &amp;quot;Walther&amp;quot;, &amp;quot;Zachary&amp;quot;)

graph &amp;lt;- lapply(notable_graph,make_graph)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;make_graph()&lt;/code&gt; 一共支持 35 个内置图形。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;par(mfrow=c(5,7))

success &amp;lt;- lapply(notable_graph, function(x){
  graph &amp;lt;- make_graph(x)
  par(mar=c(1,1,1,1))
  plot(graph, main = x)
})
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-make-graph/index.zh_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;960&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;make_star(10) %&amp;gt;% plot
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-make-graph/index.zh_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;make_de_bruijn_graph(3,4) %&amp;gt;% plot
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-make-graph/index.zh_files/figure-html/unnamed-chunk-3-2.png&#34; width=&#34;672&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;make_full_graph(10) %&amp;gt;% plot
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-make-graph/index.zh_files/figure-html/unnamed-chunk-3-3.png&#34; width=&#34;672&#34; /&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;make_kautz_graph(3,4) %&amp;gt;% plot
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2020/02/26/igraph-make-graph/index.zh_files/figure-html/unnamed-chunk-3-4.png&#34; width=&#34;672&#34; /&gt;

        </description>
      </item>
    
  </channel>
</rss>
