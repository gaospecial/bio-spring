<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>MATLAB on BIO-SPRING</title>
    <link>bio-spring/tags/matlab/</link>
    <description>Recent content in MATLAB on BIO-SPRING</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Tue, 05 Jun 2012 00:00:00 +0000</lastBuildDate>
    <atom:link href="bio-spring/tags/matlab/" rel="self" type="application/rss+xml" />

    
      <item>
        <title>MatLab中国地图进阶：以不同的颜色表示各省数据的差异</title>
        <link>bio-spring/post/2012/06/05/2012-06-05-matlab-chinamap-coloring/</link>
        <pubDate>Tue, 05 Jun 2012 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2012/06/05/2012-06-05-matlab-chinamap-coloring/</guid>
        <description>
          &lt;p&gt;使用MatLab绘制中国地图十分方便，我在&lt;a href=&#34;http://bio-spring.top/?p=165&#34; title=&#34;使用Matlab画中国地图&#34;&gt;前文&lt;/a&gt;中已经有相应阐述。实际应用中，我们常常需要将不同的区域以不同的颜色展示出来，这就是本文要阐述的内容。&lt;/p&gt;
&lt;p&gt;本文使用MatLab将各省人口数据展示出来，人口越多颜色越黄，人口越少颜色越绿。最终结果如下图所示（点击看大图）。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2012/06/fig735025.6086.png&#34;&gt;&lt;img src=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2012/06/fig735025.6086-300x225.png&#34; title=&#34;fig735025.6086&#34; class=&#34;alignnone size-medium wp-image-356&#34; sizes=&#34;(max-width: 300px) 100vw, 300px&#34; srcset=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2012/06/fig735025.6086-300x225.png 300w, https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2012/06/fig735025.6086-1024x768.png 1024w, https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2012/06/fig735025.6086.png 1201w&#34; width=&#34;300&#34; height=&#34;225&#34; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;绘制过程如下：&lt;/p&gt;
&lt;div class=&#34;content&#34;&gt;
&lt;pre&gt;&lt;code class=&#34;language-codeinput&#34;&gt;%-- 分省中国地图在MATLAB中的画法 --%
% Author: gaospecial@gmail.com
% Date: 2012-6-5 14:04:01
% 地图数据来源：国家基础地理信息系统网站
% 人口数据来源：国家统计年鉴2011版
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;载入地图数据&#34;&gt;载入地图数据&lt;span id=&#34;2&#34;&gt;&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;载入各省的多边形数据&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-codeinput&#34;&gt;sheng=shaperead(&#39;maps/bou2_4p.shp&#39;, &#39;UseGeoCoords&#39;, true); % 省
% 检查数据发现中午名称为乱码，可能是由于字符编码引起的，需要纠正文件导入时出现的乱码
% 中文名称记录在相应的dbf文件中，可以使用Excel打开，并且不会出现乱码，截取其中的中文保存为文本文件
% 然后在导入工作区，并将其保存为*.mat格式文件，随用随取。
% 依次替换sheng数据中的乱码【算是变通之法，有谁知道更好的方法一定告诉我哦】
load chinese_name.mat% 省，省会，主要城市的正确中文
for i=1:length(sheng)
    sheng(i).NAME=sheng_chinese_name{i}; % 纠正中文显示错误
end
unique(sheng_chinese_name) % 含有34个省（直辖市）的数据
length(sheng) % 共分为925个区块
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-codeoutput&#34;&gt;ans = 

    &#39;上海市&#39;
    &#39;云南省&#39;
    &#39;内蒙古自治区&#39;
    &#39;北京市&#39;
    &#39;台湾省&#39;
    &#39;吉林省&#39;
    &#39;四川省&#39;
    &#39;天津市&#39;
    &#39;宁夏回族自治区&#39;
    &#39;安徽省&#39;
    &#39;山东省&#39;
    &#39;山西省&#39;
    &#39;广东省&#39;
    &#39;广西壮族自治区&#39;
    &#39;新疆维吾尔自治区&#39;
    &#39;江苏省&#39;
    &#39;江西省&#39;
    &#39;河北省&#39;
    &#39;河南省&#39;
    &#39;浙江省&#39;
    &#39;海南省&#39;
    &#39;湖北省&#39;
    &#39;湖南省&#39;
    &#39;甘肃省&#39;
    &#39;福建省&#39;
    &#39;空&#39;
    &#39;西藏自治区&#39;
    &#39;贵州省&#39;
    &#39;辽宁省&#39;
    &#39;重庆市&#39;
    &#39;陕西省&#39;
    &#39;青海省&#39;
    &#39;香港特别行政区&#39;
    &#39;黑龙江省&#39;

ans =

   925
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;导入2011年各省人口数据&#34;&gt;导入2011年各省人口数据&lt;span id=&#34;3&#34;&gt;&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;使用importdata向导导入2011年全国31个省的人口数据：data为人口数目
textdata为省名称&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-codeinput&#34;&gt;d=importdata(&#39;renkou.txt&#39;);
data=d.data; % 人口数目
textdata=d.textdata; % 相对应的省的名称
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;定义地图参数&#34;&gt;定义地图参数&lt;span id=&#34;4&#34;&gt;&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;针对不同省份，分别设置不同的颜色（FaceColor） 定义颜色&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-codeinput&#34;&gt;k=128;
mycolormap=summer(k);
% 生成不同区域按大小的颜色，按照人口数目多少分别指定不同的颜色
% 人口越多，颜色越突出
geoname={sheng.NAME}&#39;;
max_data = max(data);
n=length(data);
mysymbolspec=cell(1,n);% 预定义变量可以加快处理速度
for i=1:n
    count=data(i);
    mycoloridx=floor( k * count / max_data );
    mycoloridx(mycoloridx&amp;lt;1)=1;
    myprovince=textdata{i};
    geoidx=strmatch(myprovince, geoname);
    if numel(geoidx) &amp;gt; 0
        province_name=geoname( geoidx(1) );
        mysymbolspec{i} = {&#39;NAME&#39;, char(province_name), &#39;FaceColor&#39;, mycolormap( mycoloridx, :) };
    end
end
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;显示地图&#34;&gt;显示地图&lt;span id=&#34;5&#34;&gt;&lt;/span&gt;&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-codeinput&#34;&gt;figure
ax=worldmap(&#39;china&#39;); % 使用worldmap的坐标轴作图
setm(ax,&#39;grid&#39;,&#39;off&#39;) % 关闭grid
setm(ax,&#39;frame&#39;,&#39;off&#39;) % 关闭边框
setm(ax,&#39;parallellabel&#39;,&#39;off&#39;) % 关闭坐标轴标记
setm(ax,&#39;meridianlabel&#39;,&#39;off&#39;) % 关闭坐标轴标记

% 最关键的两个语句
symbols=makesymbolspec(&#39;Polygon&#39;,{&#39;default&#39;,&#39;FaceColor&#39;,[0.9 0.9 0.8],...
    &#39;LineStyle,&#39;--&#39;,&#39;LineWidth&#39;,0.2,...
    &#39;EdgeColor&#39;,[0.8 0.9 0.9]},...
    mysymbolspec{:}...
    );
geoshow(sheng,&#39;SymbolSpec&#39;,symbols); % 此处用mapshow投影会不正确
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;图的标注&#34;&gt;图的标注&lt;span id=&#34;6&#34;&gt;&lt;/span&gt;&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-codeinput&#34;&gt;% 在图像右侧显示bar
colormap(summer(k))
hcb=colorbar(&#39;EastOutside&#39;);
step=round(max_data/11);
set(hcb,&#39;YTick&#39;,(0:.1:1))
set(hcb,&#39;YTickLabel&#39;,num2cell(0:step:max_data))

% 给图像加标题
title(&#39;中国2011年各省人口数（万人）&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;下载本文附件，包括M文件和输出结果（附件已更新2012-6-14）。&lt;br&gt;
&lt;a href=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2012/06/china_map1.zip&#34;&gt;china_map&lt;/a&gt;&lt;/p&gt;

        </description>
      </item>
    
      <item>
        <title>使用Matlab画中国地图</title>
        <link>bio-spring/post/2011/06/28/2011-06-28-print_china_map/</link>
        <pubDate>Tue, 28 Jun 2011 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2011/06/28/2011-06-28-print_china_map/</guid>
        <description>
          &lt;p&gt;使用Matlab绘制中国地图十分方便，使用Mapping工具箱中的几条命令。&lt;/p&gt;
&lt;p&gt;介绍如下：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;设置坐标轴：setm命令。&lt;/strong&gt;&lt;br&gt;
因为地球是圆的，所以地图的绘制涉及到投影的问题，跟普通的2-D或者3-D作图差别明显。setm命令专门用来设置map
axis。例如：&lt;br&gt;
[cc lang=”matlab”]&lt;br&gt;
ax=worldmap(‘china’); %worldmap命令生成一个map
axis，其各项属性可以用getm(ax)来获得&lt;br&gt;
setm(ax,’grid’,’off’) % 关闭grid，其实就是经线和纬线&lt;br&gt;
setm(ax,’frame’,’off’) % 关闭边框&lt;br&gt;
setm(ax,’parallellabel’,’off’) % 关闭坐标轴标记，相当于X轴&lt;br&gt;
setm(ax,’meridianlabel’,’off’) % 关闭坐标轴标记，相当于Y轴&lt;br&gt;
[/cc]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;绘制地图：geoshow或者mapshow&lt;/strong&gt;&lt;br&gt;
这两个命令差别不大，系统在判断参数的时候会自动在二者之间切换。不过他们其实还是有差别的。geoshow会根据经度和纬度来作图，如果我们的坐标轴以经纬度来标记，那么用mapshow图像就会不正确。&lt;br&gt;
例如：&lt;br&gt;
[cc lang=”matlab”]&lt;br&gt;
geoshow(file) % 可以直接读取文件中数据作图&lt;br&gt;
[/cc]&lt;br&gt;
[cc lang=”matlab”]&lt;br&gt;
mapshow(file) % 可以直接读取文件中数据作图&lt;br&gt;
[/cc]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;地图数据下载&lt;/strong&gt;&lt;br&gt;
中国的地图数据可以从国家基础地理信息系统的网站上下载，网址是&lt;a href=&#34;http://nfgis.nsdi.gov.cn/&#34;&gt;http://nfgis.nsdi.gov.cn/&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;地图数据说明&lt;/strong&gt;&lt;br&gt;
从国家基础地理信息系统的网站上下载得到的数据，分为两种：一种以“l”结尾，经过笔者的考虑，应当是line（线，曲线）的缩写，这些数据是线性的数据，描述了边界。另外一些数据，以“p”结尾，应当是polygon（多边形）的意思，这些数据描述了不同的区块。&lt;br&gt;
另外，每组数据都有3个文件，分别以“shp”，“dbf”，“shx”为扩展名。需要注意的是，虽然我们在作图时只用到了“shp”数据，但是显然这样的一组数据才是完整的数据。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;图片如下：&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;国家基础地理信息系统&lt;img src=&#34;https://s.w.org/images/core/emoji/13.0.1/72x72/2122.png&#34; class=&#34;wp-smiley&#34; alt=&#34;™&#34; /&gt;版权所有&lt;/strong&gt;&lt;br&gt;
这是一个以bou1_4l为基础的作图，可以看到南海的断续线。图内没有填充。&lt;br&gt;
&lt;img src=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2011/06/fig11.png&#34; width=&#34;400&#34; /&gt;&lt;br&gt;
这是一个以bou1_4p为基础的作图，不可以看到南海的断续线。图内有填充。&lt;br&gt;
这显然是由于曲线没有面积造成的。&lt;br&gt;
&lt;img src=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2011/06/fig21.png&#34; width=&#34;400&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;参考资料：&lt;/strong&gt;&lt;br&gt;
MATLAB绘制中国地图
&lt;a href=&#34;http://blog.sciencenet.cn/home.php?mod=space&amp;amp;uid=428536&amp;amp;do=blog&amp;amp;id=307997&#34;&gt;http://blog.sciencenet.cn/home.php?mod=space&amp;amp;uid=428536&amp;amp;do=blog&amp;amp;id=307997&lt;/a&gt;&lt;/p&gt;

        </description>
      </item>
    
      <item>
        <title>在MATLAB中创建色彩绚丽的柱状图</title>
        <link>bio-spring/post/2011/06/25/2011-06-25-matlab-colourful-barplot/</link>
        <pubDate>Sat, 25 Jun 2011 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2011/06/25/2011-06-25-matlab-colourful-barplot/</guid>
        <description>
          &lt;p&gt;首先，看一下效果图。&lt;/p&gt;
&lt;p&gt;默认条件下的柱状图&lt;br&gt;
&lt;img src=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2011/06/fig1.png&#34; width=&#34;400&#34; /&gt;&lt;br&gt;
漂亮的柱状图&lt;br&gt;
&lt;img src=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2011/06/fig2.png&#34; width=&#34;400&#34; /&gt;&lt;br&gt;
渐变着色的柱状图&lt;br&gt;
&lt;img src=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2011/06/fig3.png&#34; width=&#34;400&#34; /&gt;&lt;br&gt;
代码如下：&lt;/p&gt;
&lt;p&gt;[cc lang=”matlab”]&lt;br&gt;
% 彩色柱状图&lt;br&gt;
%% 用到的数据&lt;br&gt;
n = 13;&lt;br&gt;
Z = rand(n,1);&lt;br&gt;
%% 默认图片&lt;br&gt;
bar(Z);&lt;br&gt;
%% 简单的作图&lt;br&gt;
% 这个图根据数据列中值的大小着色。每列中的&lt;br&gt;
% 值越大，颜色越突出&lt;br&gt;
figure&lt;br&gt;
h=bar(Z);&lt;br&gt;
colormap(summer(n));&lt;br&gt;
ch = get(h,’Children’);&lt;br&gt;
fvd = get(ch,’Faces’);&lt;br&gt;
fvcd = get(ch,’FaceVertexCData’);&lt;br&gt;
[~, izs] = sortrows(Z,1);&lt;br&gt;
for i = 1:n&lt;br&gt;
row = izs(i);&lt;br&gt;
fvcd(fvd(row,:)) = i;&lt;br&gt;
end&lt;br&gt;
set(ch,’FaceVertexCData’,fvcd)&lt;br&gt;
%% 更加漂亮的图片&lt;br&gt;
% 图片会以渐变的方式着色，效果非常不错&lt;br&gt;
figure&lt;br&gt;
h=bar(Z);&lt;br&gt;
ch = get(h,’Children’);&lt;br&gt;
fvd = get(ch,’Faces’);&lt;br&gt;
fvcd = get(ch,’FaceVertexCData’);&lt;br&gt;
[zs, izs] = sortrows(Z,1);&lt;br&gt;
k = 128; % 准备生成128 *3 行的colormap&lt;br&gt;
colormap(summer(k)); % 这样会产生一个128 * 3的矩阵，分别代表[R G
B]的值&lt;br&gt;
% 检视数据&lt;br&gt;
whos ch fvd fvcd zs izs&lt;br&gt;
%&lt;br&gt;
% Name Size Bytes Class Attributes&lt;br&gt;
%&lt;br&gt;
% ch 1×1 8 double&lt;br&gt;
% fvcd 66×1 528 double&lt;br&gt;
% fvd 13×4 416 double&lt;br&gt;
% izs 13×1 104 double&lt;br&gt;
% zs 13×1 104 double&lt;br&gt;
%&lt;br&gt;
shading interp % Needed to graduate colors&lt;br&gt;
for i = 1:n&lt;br&gt;
color = floor(k*i/n); % 这里用取整函数获得color在colormap中行&lt;br&gt;
row = izs(i); % Look up actual row # in data&lt;br&gt;
fvcd(fvd(row,1)) = 1; % Color base vertices 1st index&lt;br&gt;
fvcd(fvd(row,4)) = 1;&lt;br&gt;
fvcd(fvd(row,2)) = color; % Assign top vertices color&lt;br&gt;
fvcd(fvd(row,3)) = color;&lt;br&gt;
end&lt;br&gt;
set(ch,’FaceVertexCData’, fvcd); % Apply the vertex coloring&lt;br&gt;
set(ch,’EdgeColor’,’k’)&lt;br&gt;
[/cc]&lt;/p&gt;

        </description>
      </item>
    
      <item>
        <title>matlab 怎样去掉矩阵中的零元素</title>
        <link>bio-spring/post/2011/02/19/2011-02-19-matlab-cleanup/</link>
        <pubDate>Sat, 19 Feb 2011 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2011/02/19/2011-02-19-matlab-cleanup/</guid>
        <description>
          &lt;pre&gt;&lt;code&gt;这个问题问的有点问题。
如果是一维的，a(a==0) = [] 就能解决问题
如果是多维的，a(a==0) = [] 会把a变成一维的，然后结果类似于上面的结果。原因是每行每列中的0的个数不同，无法保持多维的样子，只能拉长了当成一维处理。

a =

    4    4    4    2    2
    4    0    3    2    2
    2    1    2    4    3
    3    0    5    4    4
    1    0    0    1    4

&amp;gt;&amp;gt; a(a==0)=[]

a =

  Columns 1 through 20

    4    4    2    3    1    4    1    4    3    2    5    2    2    4    4    1    2    2    3    4

  Column 21

    4
&lt;/code&gt;&lt;/pre&gt;

        </description>
      </item>
    
      <item>
        <title>matlab中如何删除矩阵的某一列元素</title>
        <link>bio-spring/post/2011/02/19/2011-02-19-matlab-del-col/</link>
        <pubDate>Sat, 19 Feb 2011 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2011/02/19/2011-02-19-matlab-del-col/</guid>
        <description>
          &lt;p&gt;A为M行N列矩阵，删除第i列(1&amp;lt;=i&amp;lt;=N)，则：&lt;br&gt;
B=[A(:,1:i-1),A(:,i+1:N)];&lt;br&gt;
或直接在A上修改，&lt;br&gt;
A(:,i)=[];&lt;br&gt;
&lt;a href=&#34;http://topic.csdn.net/u/20080725/17/b30c6b03-12c6-4022-9df9-de7fd5e0cb4c.html&#34;&gt;http://topic.csdn.net/u/20080725/17/b30c6b03-12c6-4022-9df9-de7fd5e0cb4c.html&lt;/a&gt;&lt;/p&gt;

        </description>
      </item>
    
      <item>
        <title>在MATLAB中创建带有误差线（误差标记）的柱状图</title>
        <link>bio-spring/post/2011/02/18/2011-02-18-bar-with-errorbar/</link>
        <pubDate>Fri, 18 Feb 2011 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2011/02/18/2011-02-18-bar-with-errorbar/</guid>
        <description>
          &lt;p&gt;在MATLAB中，使用一个函数errorbar来定义图形中的误差线。可以用于折线图，柱状图等各种图形。实例如下：&lt;/p&gt;
&lt;p&gt;[cc lang=”matlab”]&lt;br&gt;
% 生成示例数据&lt;br&gt;
x=1:10;&lt;br&gt;
y=cumsum(randn(1,10));&lt;br&gt;
lower = y – (rand(1,10));&lt;br&gt;
upper = y + (rand(1,10));&lt;/p&gt;
&lt;p&gt;% 由于errorbar函数使用相对差值在图形上绘图，所以&lt;br&gt;
% 需要将绝对差值转变为相对差值。&lt;br&gt;
L = y – lower;&lt;br&gt;
U = upper -y;&lt;/p&gt;
&lt;p&gt;% 绘图时需要设定 hold on&lt;br&gt;
% 柱状图&lt;br&gt;
clf;&lt;br&gt;
figure(1);&lt;br&gt;
hold on;&lt;br&gt;
bar(x,y);&lt;br&gt;
% 此处需要隐藏折线&lt;br&gt;
errorbar(x,y,L,U,’Marker’,’none’,’LineStyle’,’none’);&lt;/p&gt;
&lt;p&gt;% 折线图&lt;br&gt;
figure(2);&lt;br&gt;
hold(‘on’);&lt;br&gt;
plot( x, y);&lt;br&gt;
errorbar( x, y, L, U);&lt;br&gt;
[/cc]&lt;/p&gt;
&lt;p&gt;效果如下图所示：&lt;br&gt;
&lt;img src=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2011/02/errorbar.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://cloudfs-spring.oss-cn-qingdao.aliyuncs.com/bio_spring_uploads/2011/02/errorbar2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;refer：http://stackoverflow.com/questions/3748310/how-to-define-error-bar-in-matlab&lt;/p&gt;

        </description>
      </item>
    
  </channel>
</rss>
