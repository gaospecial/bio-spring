<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>PCA on BIO-SPRING</title>
    <link>bio-spring/tags/pca/</link>
    <description>Recent content in PCA on BIO-SPRING</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Fri, 02 Nov 2018 00:00:00 +0000</lastBuildDate>
    <atom:link href="bio-spring/tags/pca/" rel="self" type="application/rss+xml" />

    
      <item>
        <title>比较 stats::procmp() 和 vegan::rda() 两种方法</title>
        <link>bio-spring/post/2018/11/02/comparison-of-two-pca-methods/</link>
        <pubDate>Fri, 02 Nov 2018 00:00:00 +0000</pubDate>
        <author>Gao</author>
        <guid>bio-spring/post/2018/11/02/comparison-of-two-pca-methods/</guid>
        <description>
          &lt;p&gt;上次提及 PCA 分析的方法有很多种。那不同方法之间的得到的结果会有差异吗？&lt;/p&gt;
&lt;p&gt;最近采用 PCA 分析 RNA-seq 样本之间的差异，得到了下面的结果。&lt;/p&gt;
&lt;h1 id=&#34;生成示例数据&#34;&gt;生成示例数据&lt;/h1&gt;
&lt;p&gt;生成一个含有 1000 个基因, 27 个样品的数据集.
这 27 个样品来自于 3 个基因型(WT, Mutant1, Mutant2),
3 种处理(CK, Trt1, Trt2), 共分为 &lt;code&gt;\(3 * 3 = 9\)&lt;/code&gt; 组,
每组 3 个重复, 合计 27 个样品.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(DESeq2)
library(dplyr)
library(ggplot2)
theme_set(theme_bw())

dds &amp;lt;- makeExampleDESeqDataSet(n = 1000, m=27)
dds$condition &amp;lt;- factor(rep(rep(c(&amp;quot;Ctrl&amp;quot;,&amp;quot;Trt1&amp;quot;,&amp;quot;Trt2&amp;quot;),3), 3))
dds$genotype &amp;lt;- factor(rep(rep(c(&amp;quot;WT&amp;quot;,&amp;quot;MuA&amp;quot;,&amp;quot;MuB&amp;quot;), each=3),3))

# sample table
sample_table &amp;lt;- colData(dds) %&amp;gt;% as.data.frame() %&amp;gt;%
  tibble::rownames_to_column(var=&amp;quot;sample_id&amp;quot;)

# 做 log2 变换
rld &amp;lt;- rlog(dds, blind = F)
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;使用-statsprcomp-进行主成分分析&#34;&gt;使用 &lt;code&gt;stats::prcomp()&lt;/code&gt; 进行主成分分析&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 运行 PCA
pca &amp;lt;- stats::prcomp(t(assay(rld)))

# 计算解释度
percent_var &amp;lt;- pca$sdev^2/sum(pca$sdev^2)

# 绘图
df &amp;lt;- data.frame(PC1=pca$x[,1], 
PC2=pca$x[,2], sample_id=colnames(rld)) %&amp;gt;% 
  left_join(sample_table)

mapping &amp;lt;- aes(PC1, PC2, color=condition, shape=genotype,label=sample_id)

p1 &amp;lt;- ggplot(df,mapping) +
    geom_point(size=3) +
    ggrepel::geom_text_repel(show.legend = F) +
    xlab(paste0(&amp;quot;PC1: &amp;quot;, round(percent_var[1] * 100), &amp;quot;% variance&amp;quot;)) + 
    ylab(paste0(&amp;quot;PC2: &amp;quot;, round(percent_var[2] * 100), &amp;quot;% variance&amp;quot;)) +
    ggtitle(&amp;quot;method: stats::prcomp()&amp;quot;)
    
p1
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2018/11/02/comparison-of-two-pca-methods/index.zh_files/figure-html/pca1-1.png&#34; width=&#34;768&#34; /&gt;
&lt;h1 id=&#34;使用-veganrda-做主成分分析&#34;&gt;使用 &lt;code&gt;vegan::rda()&lt;/code&gt; 做主成分分析&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# rda() 分析
pca &amp;lt;- vegan::rda(t(assay(rld))) 

# 计算解释度
percent_var &amp;lt;- pca$CA$eig/pca$tot.chi  # rda() 的结果中信息比较完整
df &amp;lt;- vegan::scores(pca)$sites %&amp;gt;% 
  as.data.frame() %&amp;gt;%
  tibble::rownames_to_column(var=&amp;quot;sample_id&amp;quot;) %&amp;gt;%
  left_join(sample_table)

p2 &amp;lt;- ggplot(df,mapping) +
    geom_point(size=3) +
    ggrepel::geom_text_repel(show.legend = F) +
    xlab(paste0(&amp;quot;PC1: &amp;quot;, round(percent_var[1] * 100), &amp;quot;% variance&amp;quot;)) + 
    ylab(paste0(&amp;quot;PC2: &amp;quot;, round(percent_var[2] * 100), &amp;quot;% variance&amp;quot;)) + 
  ggtitle(&amp;quot;method: vegan::rda()&amp;quot;)

p2
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2018/11/02/comparison-of-two-pca-methods/index.zh_files/figure-html/pca2-1.png&#34; width=&#34;768&#34; /&gt;
&lt;h1 id=&#34;放在一起比较一下&#34;&gt;放在一起比较一下&lt;/h1&gt;
&lt;p&gt;可以看出，虽然两种方法计算的数值有差异，但是坐标位置是一致。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;cowplot::plot_grid(p1,p2,labels = &amp;quot;AUTO&amp;quot;,ncol=1,align = &amp;quot;hv&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2018/11/02/comparison-of-two-pca-methods/index.zh_files/figure-html/pca_plot-1.png&#34; width=&#34;768&#34; /&gt;

        </description>
      </item>
    
      <item>
        <title>常见排序分析方法及R语言实现</title>
        <link>bio-spring/post/2018/10/22/ordination-analysis-in-r/</link>
        <pubDate>Mon, 22 Oct 2018 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2018/10/22/ordination-analysis-in-r/</guid>
        <description>
          &lt;h1 id=&#34;常用排序分析方法&#34;&gt;常用排序分析方法&lt;/h1&gt;
&lt;p&gt;相信大家在做微生物多样性研究时经常听到PCA分析、PCoA分析，NMDS分析，CCA分析，RDA分析。它们对物种（或基因、功能）的分析具有重要作用，因而频频出现在16S测序及宏基因组测序中。以上分析本质上都属于排序分析（Ordination analysis）。&lt;/p&gt;
&lt;p&gt;排序分析（ordination analysis），最早是生态学（ecology）中研究群落（communities）的一大类多元分析手段，将某个地区调查的不同环境（site）以及所对应的物种组成（species），按照相似度（similarity）或距离（distance）对site在排序轴上（ordination axes）进行排序，将其表示为沿一个或多个排序轴排列的点，从而分析各个site或species与环境因子之间的关系。其目的是把多维空间压缩到低维空间（如二维），并且保证因维数降低而导致的信息量损失尽量少，实体（site或species）按其相似关系重新排列，提高其可理解性（interpretability）；同时，通过统计手段检验排序轴（ordination axes）是否能真正代表环境因子的梯度（gradient）&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;p&gt;因此，排序分析的作用可以总结为两个方面：①降维；②探索性分析；&lt;/p&gt;
&lt;p&gt;常用的排序方法如下&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;排序分析方法&lt;/th&gt;
          &lt;th&gt;Raw data based （线性模型）&lt;/th&gt;
          &lt;th&gt;Raw data based （单峰模型）&lt;/th&gt;
          &lt;th&gt;Distance based&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;间接排序法  （非限制性）&lt;/td&gt;
          &lt;td&gt;PCA&lt;/td&gt;
          &lt;td&gt;CA，DCA&lt;/td&gt;
          &lt;td&gt;PCoA，NMDS&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;直接排序法  （限制性）&lt;/td&gt;
          &lt;td&gt;RDA&lt;/td&gt;
          &lt;td&gt;CCA&lt;/td&gt;
          &lt;td&gt;dbRDA&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;其中间接排序法包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PCA（principal components analysis，主成分分析）&lt;/li&gt;
&lt;li&gt;CA（correspondence analysis，对应分析）&lt;/li&gt;
&lt;li&gt;DCA（Detrended correspondenceanalysis, 去趋势对应分析)&lt;/li&gt;
&lt;li&gt;PCoA（principal coordinate analysis，主坐标分析）&lt;/li&gt;
&lt;li&gt;NMDS（non-metric multi-dimensional scaling，非度量多维尺度分析）；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;直接排序法包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;RDA（Redundancy analysis，冗余分析）&lt;/li&gt;
&lt;li&gt;CCA（canonical correspondence analysis，典范对应分析）&lt;/li&gt;
&lt;li&gt;dbRDA（distance based redundancy analysis，基于距离的冗余分析）&lt;/li&gt;
&lt;li&gt;CAP（canonical analysis of principal coordinates，主要坐标的典型分析）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其中PCA和RDA是基于线性模型（linear model）的，而CA、DCA、CCA、DCCA是基于单峰（unimodal）模型。&lt;/p&gt;
&lt;h1 id=&#34;选择单峰模型还是线性模型&#34;&gt;选择单峰模型还是线性模型？&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;用DCA（&lt;code&gt;vegan::decorana()&lt;/code&gt;）先对数据（site-species）进行分析；&lt;/li&gt;
&lt;li&gt;查看结果中的“Axis lengths”的第一轴DCA1的值，根据该值判断该采用线性模型还是单峰模型：
&lt;ul&gt;
&lt;li&gt;如果大于4.0，就应该选单峰模型；&lt;/li&gt;
&lt;li&gt;如果3.0-4.0之间，选线性模型或者单峰模型均可；&lt;/li&gt;
&lt;li&gt;如果小于3.0, 线性模型的结果要好于单峰模型&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;如何选择一种合适的方法&#34;&gt;如何选择一种合适的方法？&lt;/h1&gt;
&lt;p&gt;排序方法的选择取决于1）您拥有的数据类型，2）您想要/可以使用的相似距离矩阵，以及3）您想说的内容。所有这些排序方法都基于数据构建的相似距离矩阵，使用不同的方法（例如Euclidean，Bray-Curtis，Jaccard等）来计算样本之间的距离。但是，不同方法计算相似度矩阵将不会给出相同的结果。不同的排序方法使用不同的相似度矩阵，并可能对结果产生显著影响。&lt;/p&gt;
&lt;p&gt;例如，PCA和PCoA将只使用欧几里得距离，而nMDS使用任何你想要的相似距离。&lt;/p&gt;
&lt;p&gt;在 ResearchGate 上有一个高赞答案&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;，回答了这个问题。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果您有一个包含空值的数据集（例如某些样本中存在细菌OTU，而其他样本中则没有），我建议您使用Bray-Curtis相似性矩阵和nMDS排序。选择Bray-Curtis距离是因为它不受像欧几里得距离之类的样本之间的零值数量的影响，并且选择nMDS是因为您可以选择任何相似度矩阵，而不像PCA。&lt;/li&gt;
&lt;li&gt;如果您的数据集不包含空值（例如环境变量），则可以使用欧几里得距离，并使用PCA或nMDS，在这种情况下，您会看到它会给出相同的结果。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;有时候一种方法会比其他方法更好，可以显示复杂群落或因素的特定影响。如果你对结果不满意，尝试不同的方法是很好的做法。但是记住，这些方法仅仅&lt;strong&gt;只是排序&lt;/strong&gt;，你需要针对不同组之间的显著差异进行检验（例如&lt;code&gt;ANOSIM&lt;/code&gt;，&lt;code&gt;ADONIS&lt;/code&gt;，&lt;code&gt;PERMANOVA&lt;/code&gt; ，&lt;code&gt;MRPP&lt;/code&gt; &amp;hellip;）。&lt;/p&gt;
&lt;h1 id=&#34;r语言实现&#34;&gt;R语言实现&lt;/h1&gt;
&lt;h2 id=&#34;示例数据集&#34;&gt;示例数据集&lt;/h2&gt;
&lt;p&gt;使用 &lt;code&gt;vegan&lt;/code&gt; 的数据集作为示例数据，该数据集描述了苔原土壤上生长的植物多样性信息和土壤的物理化学性质。其中，&lt;code&gt;varespec&lt;/code&gt; 描述了24块样地中44个物种的丰度信息，&lt;code&gt;varechem&lt;/code&gt; 描述了这24块样地土壤的14个性质参数。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(&amp;quot;vegan&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: permute
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: lattice
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## This is vegan 2.6-4
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;data(&amp;quot;varespec&amp;quot;)
data(&amp;quot;varechem&amp;quot;)

# 查看变量
knitr::kable(varespec[1:3,1:5])
&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;Callvulg&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;Empenigr&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;Rhodtome&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;Vaccmyrt&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;Vaccviti&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;18&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.55&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;11.13&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.00&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;17.80&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;15&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.67&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.17&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.35&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;12.13&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;24&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.10&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;1.55&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.00&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;13.47&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;knitr::kable(varechem[1:3,1:5])
&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;N&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;P&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;K&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;Ca&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;Mg&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;18&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;19.8&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;42.1&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;139.9&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;519.4&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;90.0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;15&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;13.4&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;39.1&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;167.3&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;356.7&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;70.7&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;24&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;20.2&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;67.7&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;207.1&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;973.3&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;209.1&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;选择模型&#34;&gt;选择模型&lt;/h2&gt;
&lt;p&gt;为了确定该选择线性模型还是单峰模型，首先对数据进行DCA分析。在 &lt;code&gt;vegan&lt;/code&gt; 中，对应的函数为 &lt;code&gt;decorana()&lt;/code&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;decorana(varespec)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## decorana(veg = varespec) 
## 
## Detrended correspondence analysis with 26 segments.
## Rescaling of axes with 4 iterations.
## Total inertia (scaled Chi-square): 2.0832 
## 
##                        DCA1   DCA2    DCA3    DCA4
## Eigenvalues          0.5235 0.3253 0.20010 0.19176
## Additive Eigenvalues 0.5235 0.3217 0.17919 0.11922
## Decorana values      0.5249 0.1572 0.09669 0.06075
## Axis lengths         2.8161 2.2054 1.54650 1.64864
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在本例中，Axis lengths 最大值为 2.8161，小于3，因此采用线性模型会比较好。&lt;/p&gt;
&lt;h2 id=&#34;pca分析&#34;&gt;PCA分析&lt;/h2&gt;
&lt;p&gt;在R语言中，PCA分析和RDA分析是一个函数：&lt;code&gt;rda()&lt;/code&gt;。如果只用了物种矩阵（&lt;code&gt;rda(X)&lt;/code&gt;）就表示PCA分析，如果同时有物种矩阵和环境因子矩阵（&lt;code&gt;rda(X,Y)&lt;/code&gt;）就表示RDA分析。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;rda(varespec)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Call: rda(X = varespec)
## 
##               Inertia Rank
## Total            1826     
## Unconstrained    1826   23
## Inertia is variance 
## 
## Eigenvalues for unconstrained axes:
##   PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8 
## 983.0 464.3 132.3  73.9  48.4  37.0  25.7  19.7 
## (Showing 8 of 23 unconstrained eigenvalues)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;输出结果告诉我们总的特征根（Inertia）为1826，这个值是物种矩阵中各个物种的方差和（&lt;code&gt;sum(apply(varespec,2,var))&lt;/code&gt; = 1825.6594047 ），可以理解为物种分布的总变化量。&lt;/p&gt;
&lt;p&gt;PCA排序结果中的 Eigenvalues for unconstrained axes 表示每个非约束排序轴所负荷的特征根的量，也可以表示每个轴所能解释的方差变化的量。例如，对于第一轴来说，其解释度为：&lt;code&gt;983.0/1826&lt;/code&gt; = 53.8335159%。&lt;/p&gt;
&lt;h2 id=&#34;ca分析&#34;&gt;CA分析&lt;/h2&gt;
&lt;p&gt;CA和CCA也是用同一个函数 &lt;code&gt;cca()&lt;/code&gt; 实现的。如果参数只有一个物种矩阵，就表示CA分析；如果同时有物种矩阵和环境因子矩阵，那么表示CCA分析。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;cca(varespec)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Call: cca(X = varespec)
## 
##               Inertia Rank
## Total           2.083     
## Unconstrained   2.083   23
## Inertia is scaled Chi-square 
## 
## Eigenvalues for unconstrained axes:
##    CA1    CA2    CA3    CA4    CA5    CA6    CA7    CA8 
## 0.5249 0.3568 0.2344 0.1955 0.1776 0.1216 0.1155 0.0889 
## (Showing 8 of 23 unconstrained eigenvalues)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;rda分析和cca分析&#34;&gt;RDA分析和CCA分析&lt;/h2&gt;
&lt;p&gt;在分析物种分布与环境因子关系的时候，需要用到约束分析（Constrained ordination），主要类型是RDA和CCA。&lt;/p&gt;
&lt;p&gt;约束排序和非约束排序的区别在于：在约束排序里，只展示能被环境因子所解释的物种分布变化量。因此，约束排序轴比非约束排序轴的解释量明显要小。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# RDA
rda(varespec,varechem)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Call: rda(X = varespec, Y = varechem)
## 
##                 Inertia Proportion Rank
## Total         1825.6594     1.0000     
## Constrained   1459.8891     0.7997   14
## Unconstrained  365.7704     0.2003    9
## Inertia is variance 
## 
## Eigenvalues for constrained axes:
##  RDA1  RDA2  RDA3  RDA4  RDA5  RDA6  RDA7  RDA8  RDA9 RDA10 RDA11 RDA12 RDA13 
## 820.1 399.3 102.6  47.6  26.8  24.0  19.1  10.2   4.4   2.3   1.5   0.9   0.7 
## RDA14 
##   0.3 
## 
## Eigenvalues for unconstrained axes:
##    PC1    PC2    PC3    PC4    PC5    PC6    PC7    PC8    PC9 
## 186.19  88.46  38.19  18.40  12.84  10.55   5.52   4.52   1.09
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# CCA
cca(varespec,varechem)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Call: cca(X = varespec, Y = varechem)
## 
##               Inertia Proportion Rank
## Total          2.0832     1.0000     
## Constrained    1.4415     0.6920   14
## Unconstrained  0.6417     0.3080    9
## Inertia is scaled Chi-square 
## 
## Eigenvalues for constrained axes:
##   CCA1   CCA2   CCA3   CCA4   CCA5   CCA6   CCA7   CCA8   CCA9  CCA10  CCA11 
## 0.4389 0.2918 0.1628 0.1421 0.1180 0.0890 0.0703 0.0584 0.0311 0.0133 0.0084 
##  CCA12  CCA13  CCA14 
## 0.0065 0.0062 0.0047 
## 
## Eigenvalues for unconstrained axes:
##     CA1     CA2     CA3     CA4     CA5     CA6     CA7     CA8     CA9 
## 0.19776 0.14193 0.10117 0.07079 0.05330 0.03330 0.01887 0.01510 0.00949
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;延伸阅读&#34;&gt;延伸阅读&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;赖江山等，基于Vegan 软件包的生态学数据排序分析。http://blog.sciencenet.cn/blog-267448-463699.html&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/ricket-sjtu/bi028/wiki/%E6%8E%92%E5%BA%8F%E5%88%86%E6%9E%90%EF%BC%88Ordination-Analysis%EF%BC%89&#34;&gt;https://github.com/ricket-sjtu/bi028/wiki/%E6%8E%92%E5%BA%8F%E5%88%86%E6%9E%90%EF%BC%88Ordination-Analysis%EF%BC%89&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;&lt;a href=&#34;http://ordination.okstate.edu/overview.htm&#34;&gt;http://ordination.okstate.edu/overview.htm&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;&lt;a href=&#34;https://www.researchgate.net/post/How_to_choose_ordination_method_such_as_PCA_CA_PCoA_and_NMDS&#34;&gt;https://www.researchgate.net/post/How_to_choose_ordination_method_such_as_PCA_CA_PCoA_and_NMDS&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;

        </description>
      </item>
    
      <item>
        <title>排序分析结果作图</title>
        <link>bio-spring/post/2018/10/22/plot-pca-using-ggplot2/</link>
        <pubDate>Mon, 22 Oct 2018 00:00:00 +0000</pubDate>
        <author>gaoch</author>
        <guid>bio-spring/post/2018/10/22/plot-pca-using-ggplot2/</guid>
        <description>
          &lt;h1 id=&#34;数据整理&#34;&gt;数据整理&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(vegan)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: permute
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: lattice
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## This is vegan 2.6-4
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;data(&amp;quot;varespec&amp;quot;)
pca &amp;lt;- rda(varespec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;首先看一下结果：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;summary(pca)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Call:
## rda(X = varespec) 
## 
## Partitioning of variance:
##               Inertia Proportion
## Total            1826          1
## Unconstrained    1826          1
## 
## Eigenvalues, and their contribution to the variance 
## 
## Importance of components:
##                            PC1      PC2       PC3     PC4      PC5      PC6
## Eigenvalue            982.9788 464.3040 132.25052 73.9337 48.41829 37.00937
## Proportion Explained    0.5384   0.2543   0.07244  0.0405  0.02652  0.02027
## Cumulative Proportion   0.5384   0.7927   0.86519  0.9057  0.93220  0.95247
##                            PC7      PC8       PC9      PC10     PC11     PC12
## Eigenvalue            25.72624 19.70557 12.274191 10.435361 9.350783 2.798400
## Proportion Explained   0.01409  0.01079  0.006723  0.005716 0.005122 0.001533
## Cumulative Proportion  0.96657  0.97736  0.984083  0.989799 0.994921 0.996454
##                           PC13      PC14      PC15      PC16      PC17
## Eigenvalue            2.327555 1.3917180 1.2057303 0.8147513 0.3312842
## Proportion Explained  0.001275 0.0007623 0.0006604 0.0004463 0.0001815
## Cumulative Proportion 0.997729 0.9984910 0.9991515 0.9995977 0.9997792
##                            PC18      PC19      PC20      PC21      PC22
## Eigenvalue            0.1866564 1.065e-01 6.362e-02 2.521e-02 1.652e-02
## Proportion Explained  0.0001022 5.835e-05 3.485e-05 1.381e-05 9.048e-06
## Cumulative Proportion 0.9998814 9.999e-01 1.000e+00 1.000e+00 1.000e+00
##                            PC23
## Eigenvalue            4.590e-03
## Proportion Explained  2.514e-06
## Cumulative Proportion 1.000e+00
## 
## Scaling 2 for species and site scores
## * Species are scaled proportional to eigenvalues
## * Sites are unscaled: weighted dispersion equal on all dimensions
## * General scaling constant of scores:  14.31485 
## 
## 
## Species scores
## 
##                 PC1        PC2        PC3        PC4        PC5        PC6
## Callvulg -1.470e-01  0.3483315 -2.506e-01  0.6029965  0.3961208 -4.608e-01
## Empenigr  1.645e-01 -0.3731965 -5.543e-01 -0.7565217 -0.7432702 -3.484e-01
## Rhodtome -6.787e-02 -0.0810708 -6.464e-02 -0.0963929 -0.1749038 -4.008e-02
## Vaccmyrt -5.429e-01 -0.7446016  1.973e-01 -0.2791788 -0.5688937 -3.689e-01
## Vaccviti  9.013e-02 -0.7247759 -6.555e-01 -1.3366155 -0.7107105 -2.615e-01
## Pinusylv  3.404e-02 -0.0132527  4.465e-04 -0.0079399 -0.0012504  3.800e-03
## Descflex -7.359e-02 -0.0961364  6.485e-02 -0.0158203 -0.0741307 -5.328e-02
## Betupube -8.789e-04 -0.0008548 -6.637e-03 -0.0077726 -0.0072147  4.759e-04
## Vacculig -6.959e-02  0.2123669  6.410e-02  0.0136389 -0.0712061 -1.179e-01
## Diphcomp  3.807e-03  0.0333497 -1.026e-02 -0.0291455 -0.0086379 -2.263e-02
## Dicrsp   -4.663e-01 -0.3675288 -1.143e-01 -0.2490898  0.7694280  1.225e+00
## Dicrfusc -1.176e+00 -0.4484656 -1.338e+00  2.1943059 -0.9187333  4.027e-02
## Dicrpoly -1.597e-02 -0.0326269 -6.610e-02 -0.1166483 -0.0369723  6.576e-02
## Hylosple -2.935e-01 -0.4217426  4.523e-01 -0.0656152 -0.0358715 -2.234e-01
## Pleuschr -3.890e+00 -4.3657447  2.343e+00  0.3747564  0.1476496 -3.060e-01
## Polypili -5.032e-04  0.0069583  7.660e-03 -0.0005528 -0.0034856  5.849e-03
## Polyjuni -9.888e-02 -0.0584117 -7.234e-02 -0.0518007  0.0438920  1.472e-01
## Polycomm -4.028e-03 -0.0057429 -5.248e-03 -0.0104641 -0.0058180  9.059e-05
## Pohlnuta  9.473e-03 -0.0116498 -1.010e-02 -0.0112498 -0.0009520  7.691e-03
## Ptilcili -2.749e-02 -0.0257213 -2.522e-01 -0.3745203 -0.2917694 -4.907e-03
## Barbhatc -6.264e-03 -0.0070227 -7.152e-02 -0.1029116 -0.0825601 -1.183e-03
## Cladarbu -7.281e-01  3.0180666  2.016e-01  0.1400429  0.8708266 -1.253e+00
## Cladrang  8.117e-01  4.2257879  2.338e+00  0.2831533 -0.7644829  4.473e-01
## Cladstel  9.580e+00 -2.0074825  6.078e-01  0.4155714  0.1401899 -2.112e-01
## Cladunci -3.796e-01  0.0706264 -6.867e-01  0.1413783  0.9384995  1.495e-01
## Cladcocc  5.652e-03  0.0096766 -3.946e-03  0.0117038  0.0033077 -4.020e-03
## Cladcorn -1.367e-02 -0.0047214 -1.714e-02 -0.0270900  0.0004555  1.197e-03
## Cladgrac -1.037e-02  0.0083562 -6.489e-03 -0.0132067  0.0018124  1.012e-02
## Cladfimb  3.163e-03  0.0028937 -1.436e-02  0.0004203 -0.0043761 -1.344e-02
## Cladcris -2.649e-02  0.0010675 -4.626e-02 -0.0128097  0.0150875 -3.677e-02
## Cladchlo  1.347e-02 -0.0054141 -7.871e-03 -0.0099859 -0.0028496 -4.324e-04
## Cladbotr -2.051e-03 -0.0009378 -5.815e-03 -0.0095913 -0.0057131 -1.141e-03
## Cladamau  3.733e-05  0.0020956  3.925e-04 -0.0009025 -0.0009981  2.615e-04
## Cladsp    6.254e-03 -0.0021214 -1.997e-03  0.0011793  0.0023250 -3.246e-03
## Cetreric -4.938e-03  0.0079861 -1.740e-02  0.0046582  0.0488265  1.964e-02
## Cetrisla  1.715e-02 -0.0103936 -1.530e-02 -0.0214109 -0.0140577  3.490e-03
## Flavniva  8.793e-02  0.0932642 -3.761e-03  0.0536027  0.1450323  1.915e-03
## Nepharct -5.549e-02 -0.0368786 -3.638e-02  0.0055964  0.0415127  1.027e-01
## Stersp   -5.531e-02  0.3478548  2.425e-01  0.0088566 -0.1772134  2.711e-01
## Peltapht -3.661e-03 -0.0014739  1.729e-03 -0.0067221 -0.0043042 -5.434e-05
## Icmaeric -1.435e-03  0.0040087  1.296e-03  0.0023703 -0.0024341  2.959e-03
## Cladcerv  8.746e-04  0.0001554  2.667e-05  0.0004662  0.0006877  7.336e-04
## Claddefo -5.274e-02  0.0023107 -8.009e-02 -0.0278485  0.0198955 -1.490e-02
## Cladphyl  1.581e-02 -0.0057716  5.064e-04  0.0010606  0.0027075 -1.441e-03
## 
## 
## Site scores (weighted sums of species scores)
## 
##         PC1      PC2      PC3      PC4       PC5      PC6
## 18 -1.02674  2.59169 -1.53869 -3.23113 -1.104731 -2.20341
## 15 -2.64700 -1.62646  1.01889  1.88048  1.152767 -1.41888
## 24 -2.44595 -2.01412  0.12182 -2.44215  5.875564  8.03640
## 27 -3.02575 -4.32492  4.44163 -1.54364 -2.466762 -2.57141
## 23 -1.86899 -0.35380 -1.98920 -4.11912 -2.428561 -0.85734
## 19 -0.02298 -1.59265 -0.43949 -1.43686  1.058122 -1.18048
## 22 -2.53975 -1.70578 -4.10001  7.63091 -5.062274 -0.64415
## 16 -2.08714  0.06163 -2.32296  5.84188 -3.568851  1.63566
## 28 -3.77083 -5.80241  6.57611  0.02751  0.908046 -3.10610
## 13 -0.38714  2.82852 -0.32352  2.12507  3.631355 -3.88730
## 14 -1.75570  0.75366 -5.69429  1.68697  6.098213 -1.28171
## 20 -1.65653  0.32765 -1.93100 -2.50536  0.065456  1.72887
## 25 -2.39601 -1.83554 -1.65364  0.24230  1.756334  4.36881
## 7  -1.08594  5.78134  1.89095 -0.90494 -0.006891 -2.44158
## 5  -0.80203  6.28624  4.85360  0.70195 -3.707269  5.90752
## 6  -0.19764  5.11581  1.24710 -0.70641  1.876853 -4.68229
## 3   3.79496  1.11636  1.93079  1.75008 -0.164043  1.75417
## 4   1.24779  1.77832 -0.17925  1.13363  2.999648  0.07212
## 2   5.49157 -0.67853  1.58337  1.13337 -1.472922  1.97780
## 9   6.02767 -3.10958 -1.09190 -0.28517  0.894284 -1.20958
## 12  4.19915 -1.40814 -0.06645 -0.79569 -0.790560 -0.37424
## 10  6.18267 -2.32211 -0.76545  0.43683  0.430813 -0.78609
## 11  1.09782  0.55023  3.41127  0.38027 -0.325506  1.07113
## 21 -0.32554 -0.41738 -4.97967 -7.00076 -5.649086  0.09209
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;绘图&#34;&gt;绘图&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;vegan&lt;/code&gt; 的结果处理成 &lt;code&gt;data.frame&lt;/code&gt; 才能用于 &lt;code&gt;ggplot2&lt;/code&gt;。这个过程比较复杂，不过还好有人已经造好了轮子：&lt;code&gt;ggvegan&lt;/code&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;p&gt;运行下面命令安装这个包。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;devtools::install_github(&amp;quot;gavinsimpson/ggvegan&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;使用 &lt;code&gt;autoplot()&lt;/code&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(ggvegan)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: ggplot2
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 使用空白主题
theme_set(theme_bw())

# 一键绘图
autoplot(pca)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2018/10/22/plot-pca-using-ggplot2/index.zh_files/figure-html/plot-pca-1.png&#34; width=&#34;576&#34; /&gt;
&lt;p&gt;还可以使用 &lt;code&gt;fortify()&lt;/code&gt; 将对象转变为 &lt;code&gt;data.frame&lt;/code&gt;，然后再作图。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 生成数据框
df.pca &amp;lt;- fortify(pca)

# 查看数据
knitr::kable(df.pca[1:5,1:5])
&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;score&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;label&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;PC1&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;PC2&lt;/th&gt;
          &lt;th style=&#34;text-align: right&#34;&gt;PC3&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;species&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;Callvulg&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.1469634&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.3483315&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.2505840&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;species&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;Empenigr&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.1645106&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.3731965&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.5543083&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;species&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;Rhodtome&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.0678718&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.0810708&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.0646412&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;species&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;Vaccmyrt&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.5428697&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.7446016&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.1973452&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;species&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;Vaccviti&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;0.0901303&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.7247759&lt;/td&gt;
          &lt;td style=&#34;text-align: right&#34;&gt;-0.6554941&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# 绘图
require(dplyr)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: dplyr
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &#39;dplyr&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;ggplot(mapping=aes(PC1,PC2,shape=score,color=score)) +
  geom_point(data=dplyr::filter(df.pca,score==&amp;quot;sites&amp;quot;)) +
  geom_segment(data=dplyr::filter(df.pca,score==&amp;quot;species&amp;quot;),
               mapping = aes(x=0,y=0,xend=PC1,yend=PC2),
               arrow = arrow(length = unit(0.1,&amp;quot;inches&amp;quot;)),show.legend = F) +
  geom_text(mapping = aes(PC1,PC2,label=label),data=filter(df.pca,score==&amp;quot;species&amp;quot;),show.legend = F)
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&#34;bio-spring/post/2018/10/22/plot-pca-using-ggplot2/index.zh_files/figure-html/fortify-plot-1.png&#34; width=&#34;576&#34; /&gt;
&lt;p&gt;除了PCA分析，&lt;code&gt;ggvegan&lt;/code&gt;还顺便支持了CCA，RDA，metaMDS等&lt;code&gt;vegan&lt;/code&gt;的分析结果。&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;ggvegan on GitHub: &lt;a href=&#34;https://github.com/gavinsimpson/ggvegan&#34;&gt;https://github.com/gavinsimpson/ggvegan&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;

        </description>
      </item>
    
  </channel>
</rss>
