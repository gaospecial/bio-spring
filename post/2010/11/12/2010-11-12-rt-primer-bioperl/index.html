<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> 使用BioPerl和primer3批量设计RT-PCR引物 | BIO-SPRING</title>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils@v1.13.54/css/article.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/heading-anchor.min.css">
    <link rel="stylesheet" href="/bio-spring/css/style.css" />
    <link rel="stylesheet" href="/bio-spring/css/fonts.css" />
    <link rel="stylesheet" href="/bio-spring/css/custom.css" />
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="使用BioPerl和primer3批量设计RT-PCR引物">
  <meta name="twitter:description" content="Update：
我已经设置了一个Massive RT-PCR Primer Designer服务，有需要的朋友可以直接去上传自己基因序列的Fasta文件，然后服务器会将引物返回。
关于Missing SEQUENCE tag错误的处理
以下为原文。
———————————————————————————————–
本文介绍批量设计RT-PCR引物的方法，基于Ubuntu 10.10系统和BioPerl 1.6.1。但是应当适用于大部分Linux系统。
本文假定你已经安装好BioPerl。
安装primer3和Bio::PrimerDesigner
[bash]
&gt;sudo apt-get install primer3 libbio-primerdesigner-perl
[/bash]
修正程序Bug
Primer3安装之后的可执行文件存在于/usr/bin/primer3_core，而Bio::PrimerDesigner软件包找不到该文件，所以需要建立一个符号链接。
[bash]
&gt;sudo ln -s /usr/bin/primer3_core /usr/local/bin/primer3
[/bash]
准备序列文件
将要设计的文件以Fasta格式保存（也可以用其它BioPerl识别的任意格式保存）在当前目录中，此处以seqs.fa命名。
代码
然后在当前目录中新建文件designPrimer.pl。
录入代码如下：
[perl]
#! perl -w
use Bio::SeqIO;
use Bio::PrimerDesigner;
my $seqs = Bio::SeqIO-&gt;new(-file =&gt; ‘seqs.fa’);
open OUT, ‘&gt;&gt; raw_output.txt’;
my $pd = Bio::PrimerDesigner-&gt;new;
while( my $seq = $seqs-&gt;next_seq() ) {
my $seqid = $seq-&gt;id;
my $dna = $seq-&gt;seq;
my %params = (
PRIMER_NUM_RETURN =&gt; 1,
PRIMER_SEQUENCE_ID =&gt; $seqid,
SEQUENCE =&gt; $dna,
PRIMER_PRODUCT_SIZE_RANGE =&gt; ‘150-250’, #注意此处参数在perl文档中是错误的，应更正为此
);
my $primers = $pd-&gt;design( %params ) or die $pd-&gt;error;
my ($left_primer,$right_primer);
if ( !$primers-&gt;left ) {
warn “No primers found for $seqid\n”;
}
else{
$left_primer = $primers-&gt;left;
$right_primer = $primers-&gt;right;
}
print join(‘,’, $seqid, $left_primer, $right_primer);
print “\n”;
print OUT $primers-&gt;raw_output; #此处的perl文档也是错误的，应更正为此
}
[/perl]">


  </head>

  <body>

    <nav class="menu sticky-top">
    <ul>
      <li class="left">
        <a href="/"><span>BIO-SPRING</span></a>
      </li>
      
      <li>
        <a href="/bio-spring">Home</a>
      </li>
      
      <li>
        <a href="/bio-spring/post/">Blog Post</a>
      </li>
      
      <li>
        <a href="/bio-spring/publication/full-publication-list/">Publication</a>
      </li>
      
      <li>
        <a href="/bio-spring/work/">Work</a>
      </li>
      
      <li id="menu-search">
        <a href="/bio-spring/#">Search</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">使用BioPerl和primer3批量设计RT-PCR引物</span></h1>

<h3 class="author">
gaoch
</h3>

<h3 class="date">2010-11-12</h3>
<p class="terms">
  
  
  Categories: <a href="/categories/%E5%85%B6%E5%AE%83">其它</a> <a href="/categories/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF">信息技术</a> <a href="/categories/%E7%94%9F%E7%89%A9%E5%AD%A6">生物学</a> 
  
  
  
  Tags: <a href="/tags/%E6%97%A7%E6%96%87">旧文</a> <a href="/tags/wordpress">WordPress</a> <a href="/tags/bioperl">BioPerl</a> <a href="/tags/primer-design">primer design</a> <a href="/tags/rt-pcr">RT-PCR</a> <a href="/tags/ubuntu">Ubuntu</a> 
  
  
</p>
</div>

<div class="article">
<p>Update：</p>
<p>我已经设置了一个<a href="http://tools.bio-spring.top/rtprimers.cgi">Massive RT-PCR Primer
Designer服务</a>，有需要的朋友可以直接去上传自己基因序列的Fasta文件，然后服务器会将引物返回。</p>
<p>关于<a href="http://bio-spring.top/primer_error-missing-sequence-tag/">Missing SEQUENCE
tag错误的处理</a></p>
<p>以下为原文。<br>
———————————————————————————————–<br>
本文介绍批量设计RT-PCR引物的方法，基于Ubuntu 10.10系统和BioPerl
1.6.1。但是应当适用于大部分Linux系统。</p>
<p>本文假定你已经安装好BioPerl。</p>
<p><strong>安装primer3和Bio::PrimerDesigner</strong></p>
<p>[bash]<br>
&gt;sudo apt-get install primer3 libbio-primerdesigner-perl<br>
[/bash]</p>
<p><strong>修正程序Bug</strong></p>
<p>Primer3安装之后的可执行文件存在于/usr/bin/primer3_core，而Bio::PrimerDesigner软件包找不到该文件，所以需要建立一个符号链接。<br>
[bash]<br>
&gt;sudo ln -s /usr/bin/primer3_core /usr/local/bin/primer3<br>
[/bash]</p>
<p><strong>准备序列文件</strong></p>
<p>将要设计的文件以Fasta格式保存（也可以用其它BioPerl识别的任意格式保存）在当前目录中，此处以seqs.fa命名。</p>
<p><strong>代码</strong></p>
<p>然后在当前目录中新建文件designPrimer.pl。<br>
录入代码如下：<br>
[perl]<br>
#! perl -w<br>
use Bio::SeqIO;<br>
use Bio::PrimerDesigner;</p>
<p>my $seqs = Bio::SeqIO-&gt;new(-file =&gt; ‘seqs.fa’);<br>
open OUT, ‘&gt;&gt; raw_output.txt’;<br>
my $pd = Bio::PrimerDesigner-&gt;new;<br>
while( my $seq = $seqs-&gt;next_seq() ) {<br>
my $seqid = $seq-&gt;id;<br>
my $dna = $seq-&gt;seq;<br>
my %params = (<br>
PRIMER_NUM_RETURN =&gt; 1,<br>
PRIMER_SEQUENCE_ID =&gt; $seqid,<br>
SEQUENCE =&gt; $dna,<br>
PRIMER_PRODUCT_SIZE_RANGE =&gt; ‘150-250’,
#注意此处参数在perl文档中是错误的，应更正为此<br>
);<br>
my $primers = $pd-&gt;design( %params ) or die $pd-&gt;error;<br>
my ($left_primer,$right_primer);<br>
if ( !$primers-&gt;left ) {<br>
warn “No primers found for $seqid\n”;<br>
}<br>
else{<br>
$left_primer = $primers-&gt;left;<br>
$right_primer = $primers-&gt;right;<br>
}<br>
print join(‘,’, $seqid, $left_primer, $right_primer);<br>
print “\n”;<br>
print OUT $primers-&gt;raw_output;
#此处的perl文档也是错误的，应更正为此<br>
}<br>
[/perl]</p>
<p><strong>保存引物</strong></p>
<p>打开终端，输入<br>
[bash]<br>
&gt; perl designprimer.pl<br>
[/bash]<br>
如果程序运行正常，引物设计的结果将在屏幕上显示，同时应当会有一些警告信息。</p>
<p>然后，可以将结果用管道命令保存：<br>
[bash]<br>
&gt; perl designprimer.pl &gt;primers.csv<br>
[/bash]</p>
<p><strong>注释</strong></p>
<p>raw_output.txt中含有primer3程序运行的完整结果。可以作为额外参考。</p>
<p>Refers：<br>
<a href="http://search.cpan.org/">http://search.cpan.org/</a>~smckay/Bio-PrimerDesigner-0.07/lib/Bio/PrimerDesigner.pm</p>
<p>Posted from <a href="http://sourceforge.net/projects/gscribble/">GScribble</a>.</p>

</div>
</main>

<section class="appendix">


<div>
  <div class="side side-left"><h3>作者简介</h3></div>
  <div>





<div>Chun-Hui Gao is a Research Associate at <a href="http://www.hzau.edu.cn">Huazhong Agricultural University</a>.</div>


</div>
</div>






<div>
  <div class="side side-left"><h3>重复使用</h3></div>
  Text and figures are licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution CC BY 4.0</a>. The source code is licensed under MIT. The full source is available at <a href="https://github.com/yihui/hugo-prose">https://github.com/yihui/hugo-prose</a>.
</div>



<div>
  <div class="side side-left"><h3>欢迎修订</h3></div>
  
  
  
    
    
  
  如果您发现本文里含有任何错误（包括错别字和标点符号），欢迎<a href="https://github.com/gaospecial/bio-spring/edit/master/content/post/2010-11-12-rt-primer-bioperl/index.zh.md" id="edit-link">在本站的 GitHub 项目里提交修订意见。</a>
</div>




<div>
  <div class="side side-left"><h3>引用本文</h3></div>
  <p>如果您使用了本文的内容，请按照以下方式引用：</p>
  <pre><code>gaoch (2010). 使用BioPerl和primer3批量设计RT-PCR引物. BIO-SPRING. bio-spring/post/2010/11/12/2010-11-12-rt-primer-bioperl/</code></pre>
  <p>BibTeX citation</p>
  <pre><code>@misc{
  title = "使用BioPerl和primer3批量设计RT-PCR引物",
  author = "gaoch",
  year = "2010",
  journal = "BIO-SPRING",
  note = "bio-spring/post/2010/11/12/2010-11-12-rt-primer-bioperl/"
}</code></pre>
</div>

</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="bio-spring/post/2010/10/28/2010-10-28-ubuntu-gscribble/" title=下一篇&#32;(旧)>Ubuntu 10.10环境下安装GScribble</a></span>
  &hercon;
  <span class="nav-prev"><a href="bio-spring/post/2010/11/17/2010-11-17-shanghai-11-15/" title=上一篇&#32;(新)>志哀：2010-11-15 上海大火</a> &rarr;</span>
</nav>




<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//bio-spring.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var t = d.getElementById('disqus_thread');
    var b = false, l = function(scroll) {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
      if (scroll) t.scrollIntoView();
    }
    s.onerror = function(e) {
      if (sessionStorage.getItem('failure-note')) return;
      t.innerText = 'Sorry, but you cannot make comments because Disqus failed to load for some reason. It is known to be blocked in China. If you are sure it is not blocked in your region, please refresh the page. 中国大陆地区读者需要翻墙才能发表评论。';
      t.style.border = '1px dashed';
      t.style.padding = '.5em';
      t.style.background = 'lightyellow';
      sessionStorage.setItem('failure-note', true);
    };
    
    if (location.hash.match(/^#comment-[0-9]+$/)) return l(true);
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


</div>


  <footer>
  
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>



<script src="//yihui.org/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>



      <script async src="https://www.googletagmanager.com/gtag/js?id=G-77M8KZTCMR"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-77M8KZTCMR');
        }
      </script>


<script src="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/js/number-sections.min.js,npm/@xiee/utils/js/toc.min.js,npm/@xiee/utils/js/toc-highlight.min.js,npm/@xiee/utils/js/sidenotes.min.js,npm/@xiee/utils/js/right-quote.min.js,npm/@xiee/utils/js/center-img.min.js,npm/@xiee/utils/js/fix-pandoc.min.js,npm/@xiee/utils/js/heading-anchor.min.js" defer></script>




  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="https://bio-spring.top">Bio-Spring</a> 2006 &ndash; 2025 <a href="https://beian.miit.gov.cn">豫ICP备2021003240号</a></li>
  </ul>
  
  <ul>
    
    <li>
      <a href="/bio-spring/404.html">Contact</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/categories/">Categories</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/tags/">Tags</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script src="/bio-spring/js/features.js" defer></script>
  </body>
</html>

