<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> ggVennDiagram 的新生 | BIO-SPRING</title>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils@v1.13.54/css/article.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/heading-anchor.min.css">
    <link rel="stylesheet" href="/bio-spring/css/style.css" />
    <link rel="stylesheet" href="/bio-spring/css/fonts.css" />
    <link rel="stylesheet" href="/bio-spring/css/custom.css" />
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ggVennDiagram 的新生">
  <meta name="twitter:description" content="ggVennDiagram 是一个用于绘制 Venn 图的 R 语言软件包。最初，我只是在需要画 Venn 图的时候，发现没有一件趁手的工具，而最终不得不写了一个给自己用的工具。随后， 抱着试一试的态度发布到了 GitHub 和 CRAN 上面。结果引起了用户持续的关注和好评， 截止今日已经获得了超过 100 个小星星。
在 CRAN 上面也已经被累计下载了 2 万多次了。
考虑到原来的设计和代码是十分粗糙的，所以我在 1.0 版本的时候，完全重构了 ggVennDiagram1。
为此，系统调研了 R 环境中可用的 Venn 图绘制工具，博取众家之长，并增强了自己原有的特色和优势。 重生后的 ggVennDiagram 用起来更加方便，功能也更加强大，同时以后的扩展性也会非常好。
下面是一些使用的示例：
先生成一个示例数据：
pak::pak(&#34;gaospecial/ggVennDiagram@V1.1&#34;) ## ℹ Loading metadata database ## ✔ Loading metadata database ... done ## ## ## ℹ No downloads are needed ## ✔ 1 pkg &#43; 90 deps: kept 62 [4s] genes &lt;- paste0(&#34;gene&#34;,1:1000) set.seed(20210502) gene_list &lt;- list(A = sample(genes,100), B = sample(genes,200), C = sample(genes,300), D = sample(genes,200)) library(ggVennDiagram) 设置集合标签的内容，颜色和大小 标签图层在最上面，不会被填充遮盖。但是如果是非常长的标签，可能会显示不完整。 此时只需要应用一个 ggplot2 函数即可。">


  </head>

  <body>

    <nav class="menu sticky-top">
    <ul>
      <li class="left">
        <a href="/"><span>BIO-SPRING</span></a>
      </li>
      
      <li>
        <a href="/bio-spring">Home</a>
      </li>
      
      <li>
        <a href="/bio-spring/post/">Blog Post</a>
      </li>
      
      <li>
        <a href="/bio-spring/publication/full-publication-list/">Publication</a>
      </li>
      
      <li>
        <a href="/bio-spring/work/">Work</a>
      </li>
      
      <li id="menu-search">
        <a href="/bio-spring/#">Search</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">ggVennDiagram 的新生</span></h1>

<h3 class="author">
Chun-Hui Gao
</h3>

<h3 class="date">2021-05-08</h3>
<p class="terms">
  
  
  Categories: <a href="/categories/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF">信息技术</a> 
  
  
  
  Tags: <a href="/tags/ggplot2">ggplot2</a> <a href="/tags/ggvenndiagram">ggVennDiagram</a> 
  
  
</p>
</div>

<div class="article">
<p><code>ggVennDiagram</code> 是一个用于绘制 Venn 图的 R 语言软件包。最初，我只是在需要画 Venn
图的时候，发现没有一件趁手的工具，而最终不得不写了一个给自己用的工具。随后，
抱着试一试的态度发布到了 GitHub 和 CRAN 上面。结果引起了用户持续的关注和好评，
截止今日已经获得了超过 100 个小星星。</p>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-1-1.png" width="672" />
<p>在 CRAN 上面也已经被累计下载了 2 万多次了。</p>
<p><a href="https://cran.r-project.org/package=ggVennDiagram"><img src="http://cranlogs.r-pkg.org/badges/grand-total/ggVennDiagram" alt=""></a>
<a href="https://cran.r-project.org/package=ggVennDiagram"><img src="https://www.r-pkg.org/badges/version/ggVennDiagram?color=green" alt=""></a></p>
<p>考虑到原来的设计和代码是十分粗糙的，所以我在 1.0 版本的时候，完全重构了 <code>ggVennDiagram</code><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>。</p>
<p>为此，系统调研了 R 环境中可用的 Venn 图绘制工具，博取众家之长，并增强了自己原有的特色和优势。
重生后的 <code>ggVennDiagram</code> 用起来更加方便，功能也更加强大，同时以后的扩展性也会非常好。</p>
<p>下面是一些使用的示例：</p>
<p>先生成一个示例数据：</p>
<pre><code class="language-r">pak::pak(&quot;gaospecial/ggVennDiagram@V1.1&quot;)
</code></pre>
<pre><code>## ℹ Loading metadata database
</code></pre>
<pre><code>## ✔ Loading metadata database ... done
</code></pre>
<pre><code>## 
</code></pre>
<pre><code>## 
</code></pre>
<pre><code>## ℹ No downloads are needed
</code></pre>
<pre><code>## ✔ 1 pkg + 90 deps: kept 62 [4s]
</code></pre>
<pre><code class="language-r">genes &lt;- paste0(&quot;gene&quot;,1:1000)
set.seed(20210502)
gene_list &lt;- list(A = sample(genes,100),
                  B = sample(genes,200),
                  C = sample(genes,300),
                  D = sample(genes,200))

library(ggVennDiagram)
</code></pre>
<h2 id="设置集合标签的内容颜色和大小">设置集合标签的内容，颜色和大小</h2>
<p>标签图层在最上面，不会被填充遮盖。但是如果是非常长的标签，可能会显示不完整。
此时只需要应用一个 <code>ggplot2</code> 函数即可。</p>
<pre><code class="language-r">ggVennDiagram(gene_list, 
              category.names = c(&quot;a very long name&quot;,&quot;short name&quot;,&quot;name&quot;,&quot;another name&quot;),
              set_color = c(&quot;red1&quot;,&quot;red2&quot;,&quot;red3&quot;,&quot;red4&quot;),
              set_size = 6) +
  scale_x_continuous(expand = expansion(mult = .2))
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-4-1.png" width="672" />
<h2 id="显示区域中的成员">显示区域中的成员</h2>
<p>我们使用 <code>plotly</code> 对区域成员进行了可视化，现在鼠标悬停即可以查看区域成员。
同时，也支持将成员打印出来。</p>
<pre><code class="language-r">ggVennDiagram(gene_list, show_intersect = TRUE)
</code></pre>
<h2 id="设定区域标签的内容颜色和大小">设定区域标签的内容、颜色和大小</h2>
<pre><code class="language-r">ggVennDiagram(gene_list, label = &quot;count&quot;, label_color = &quot;blue&quot;, label_size = 4)
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-6-1.png" width="672" />
<pre><code class="language-r">ggVennDiagram(gene_list, label = &quot;both&quot;, label_percent_digit = 1, label_size = 3)
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-7-1.png" width="672" />
<h2 id="设定椭圆的边">设定椭圆的边</h2>
<pre><code class="language-r">ggVennDiagram(gene_list, edge_lty = &quot;dashed&quot;, edge_size = 1)
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-8-1.png" width="672" />
<h2 id="换一个配色">换一个配色</h2>
<p>填充色映射到不同的区域中。</p>
<pre><code class="language-r">ggVennDiagram(gene_list) + scale_fill_distiller(palette = &quot;RdBu&quot;)
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-9-1.png" width="672" />
<p>线条颜色映射到不同的集合上。</p>
<pre><code class="language-r">ggVennDiagram(gene_list) + scale_color_brewer(palette = &quot;Set1&quot;)
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-10-1.png" width="672" />
<h2 id="更多维度的-venn-图">更多维度的 Venn 图</h2>
<p>通过导入另一个 R 包 <code>venn</code> 中的数据集，将 5-7 维度的 Venn 图画法移植了过来。</p>
<pre><code class="language-r">genes &lt;- paste0(&quot;gene&quot;,1:1000)
set.seed(20210507)
x &lt;- list(A = sample(genes,100),
          B = sample(genes,150),
          C = sample(genes,200),
          D = sample(genes,250),
          E = sample(genes,300),
          F = sample(genes,350),
          G = sample(genes,400))
</code></pre>
<p>由于是用的不规则多边形，所以这些 Venn 图可能辨别起来会比较费劲，但是乍看上去还是蛮漂亮的。</p>
<pre><code class="language-r">ggVennDiagram(x, label = &quot;none&quot;, edge_size = 2) + scale_fill_distiller(palette = &quot;RdBu&quot;)
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-12-1.png" width="672" />
<pre><code class="language-r">ggVennDiagram(x[1:6], label = &quot;none&quot;, edge_size = 2) + scale_fill_distiller(palette = &quot;RdBu&quot;)
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-12-2.png" width="672" />
<pre><code class="language-r">ggVennDiagram(x[1:5], label = &quot;none&quot;, edge_size = 2) + scale_fill_distiller(palette = &quot;RdBu&quot;)
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-12-3.png" width="672" />
<h2 id="自由定制">自由定制</h2>
<p><code>ggVennDiagram</code> 将 Venn 图分为了 3 个部分，集合的标签，集合的边缘，集合的交叉，
分别称为 <code>setLabel</code>，<code>setEdge</code> 和 <code>region</code>。我们所做的主要工作是将繁琐的集合间计算
过程包装了起来（包括多边形区域的坐标及其对应成员的统计），并将计算的结果返回，
然后使用 <code>ggplot</code> 画图。</p>
<pre><code class="language-r">venn &lt;- Venn(gene_list)
data &lt;- process_data(venn)
ggplot() +
  # 1. region count layer
  geom_sf(aes(fill = count), data = venn_region(data)) +
  # 2. set edge layer
  geom_sf(aes(color = id), data = venn_setedge(data), show.legend = FALSE) +
  # 3. set label layer
  geom_sf_text(aes(label = name), data = venn_setlabel(data)) +
  # 4. region label layer
  geom_sf_label(aes(label = count), data = venn_region(data)) +
  theme_void()
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-13-1.png" width="672" />
<p>对于熟悉 <code>ggplot</code> 作图的用户来说，他完全可以任意定制作图的格式。</p>
<pre><code class="language-r">ggplot() +
  # change mapping of color filling
  geom_sf(aes(fill = id), data = venn_region(data), show.legend = FALSE) +  
  # adjust edge size and color
  geom_sf(color=&quot;grey&quot;, size = 3, data = venn_setedge(data), show.legend = FALSE) +  
  # show set label in bold
  geom_sf_text(aes(label = name), fontface = &quot;bold&quot;, data = venn_setlabel(data)) +  
  # add a alternative region name
  geom_sf_label(aes(label = name), data = venn_region(data), alpha = 0.5) +  
  theme_void()
</code></pre>
<img src="bio-spring/post/2021/05/08/ggvenndiagram-reborn/index.zh_files/figure-html/unnamed-chunk-14-1.png" width="672" />
<p>新的 <code>ggVennDiagram</code> 更好用，更优雅。每一个绘制 Venn 图的朋友可能都会用得上。</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>同时也是为了能够作为一篇文章发表。&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

</div>
</main>

<section class="appendix">


<div>
  <div class="side side-left"><h3>作者简介</h3></div>
  <div>





<div>Chun-Hui Gao is a Research Associate at <a href="http://www.hzau.edu.cn">Huazhong Agricultural University</a>.</div>


</div>
</div>






<div>
  <div class="side side-left"><h3>重复使用</h3></div>
  Text and figures are licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution CC BY 4.0</a>. The source code is licensed under MIT. The full source is available at <a href="https://github.com/yihui/hugo-prose">https://github.com/yihui/hugo-prose</a>.
</div>



<div>
  <div class="side side-left"><h3>欢迎修订</h3></div>
  
  
  
    
  
  如果您发现本文里含有任何错误（包括错别字和标点符号），欢迎<a href="https://github.com/gaospecial/bio-spring/edit/master/content/post/2021-05-08-ggVennDiagram-reborn/index.zh.Rmd" id="edit-link">在本站的 GitHub 项目里提交修订意见。</a>
</div>




<div>
  <div class="side side-left"><h3>引用本文</h3></div>
  <p>如果您使用了本文的内容，请按照以下方式引用：</p>
  <pre><code>Chun-Hui Gao (2021). ggVennDiagram 的新生. BIO-SPRING. bio-spring/post/2021/05/08/ggvenndiagram-reborn/</code></pre>
  <p>BibTeX citation</p>
  <pre><code>@misc{
  title = "ggVennDiagram 的新生",
  author = "Chun-Hui Gao",
  year = "2021",
  journal = "BIO-SPRING",
  note = "bio-spring/post/2021/05/08/ggvenndiagram-reborn/"
}</code></pre>
</div>

</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="bio-spring/post/2021/04/28/using-renv/" title=下一篇&#32;(旧)>使用 renv</a></span>
  &hercon;
  <span class="nav-prev"><a href="bio-spring/post/2023/08/08/tidy-old-blog-post/" title=上一篇&#32;(新)>整理老文章</a> &rarr;</span>
</nav>




<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//bio-spring.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var t = d.getElementById('disqus_thread');
    var b = false, l = function(scroll) {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
      if (scroll) t.scrollIntoView();
    }
    s.onerror = function(e) {
      if (sessionStorage.getItem('failure-note')) return;
      t.innerText = 'Sorry, but you cannot make comments because Disqus failed to load for some reason. It is known to be blocked in China. If you are sure it is not blocked in your region, please refresh the page. 中国大陆地区读者需要翻墙才能发表评论。';
      t.style.border = '1px dashed';
      t.style.padding = '.5em';
      t.style.background = 'lightyellow';
      sessionStorage.setItem('failure-note', true);
    };
    
    if (location.hash.match(/^#comment-[0-9]+$/)) return l(true);
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


</div>


  <footer>
  
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>





      <script async src="https://www.googletagmanager.com/gtag/js?id=G-77M8KZTCMR"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-77M8KZTCMR');
        }
      </script>


<script src="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/js/number-sections.min.js,npm/@xiee/utils/js/toc.min.js,npm/@xiee/utils/js/toc-highlight.min.js,npm/@xiee/utils/js/sidenotes.min.js,npm/@xiee/utils/js/right-quote.min.js,npm/@xiee/utils/js/center-img.min.js,npm/@xiee/utils/js/fix-pandoc.min.js,npm/@xiee/utils/js/heading-anchor.min.js" defer></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/prism-xcode.min.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>


  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="https://bio-spring.top">Bio-Spring</a> 2006 &ndash; 2025 <a href="https://beian.miit.gov.cn">豫ICP备2021003240号</a></li>
  </ul>
  
  <ul>
    
    <li>
      <a href="/bio-spring/404.html">Contact</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/categories/">Categories</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/tags/">Tags</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script src="/bio-spring/js/features.js" defer></script>
  </body>
</html>

