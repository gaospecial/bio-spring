<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> RSEM: rsem-prepare-reference with NCBI GenBank/GFF3 File | BIO-SPRING</title>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils@v1.13.54/css/article.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/heading-anchor.min.css">
    <link rel="stylesheet" href="/bio-spring/css/style.css" />
    <link rel="stylesheet" href="/bio-spring/css/fonts.css" />
    <link rel="stylesheet" href="/bio-spring/css/custom.css" />
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="RSEM: rsem-prepare-reference with NCBI GenBank/GFF3 File">
  <meta name="twitter:description" content="解决方案如下：
Download Genbank from NCBI; Convert Genbank to GFF3 with BioPerl; Modify the GFF3 file; Download Fasta from NCBI or use Genbank conversion; Use the modified GFF3 file in rsem-prepare-reference; 主要代码如下：
bp_genbank2gff3 --GFF_VERSION 3 file.gb awk &#39;$3!~/pseudo/&#39; file.gb.gff &gt; file.rsem.gff # or more restrictly with only protein coding genes awk &#39;$3~/^(gene|mRNA|exon|polypeptide)$/&#39; file.gb.gff &gt; file.cds.gff # remove the version number in fasta accession if no transcript is extract rsem-prepare-reference file.fasta --gff3 file.rsem.gff reference_name">


  </head>

  <body>

    <nav class="menu sticky-top">
    <ul>
      <li class="left">
        <a href="/"><span>BIO-SPRING</span></a>
      </li>
      
      <li>
        <a href="/bio-spring">Home</a>
      </li>
      
      <li>
        <a href="/bio-spring/post/">Blog Post</a>
      </li>
      
      <li>
        <a href="/bio-spring/publication/full-publication-list/">Publication</a>
      </li>
      
      <li>
        <a href="/bio-spring/work/">Work</a>
      </li>
      
      <li id="menu-search">
        <a href="/bio-spring/#">Search</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">RSEM: rsem-prepare-reference with NCBI GenBank/GFF3 File</span></h1>

<h3 class="author">
gaoch
</h3>

<h3 class="date">2017-06-01</h3>
<p class="terms">
  
  
  Categories: <a href="/categories/%E5%85%B6%E5%AE%83">其它</a> <a href="/categories/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF">信息技术</a> <a href="/categories/%E7%94%9F%E7%89%A9%E5%AD%A6">生物学</a> 
  
  
  
  Tags: <a href="/tags/%E6%97%A7%E6%96%87">旧文</a> <a href="/tags/wordpress">WordPress</a> <a href="/tags/bioperl">BioPerl</a> <a href="/tags/genbank">GenBank</a> <a href="/tags/gff3">GFF3</a> <a href="/tags/rna-seq">RNA-seq</a> <a href="/tags/rsem">rsem</a> 
  
  
</p>
</div>

<div class="article">
<p>解决方案如下：</p>
<ol>
<li>Download Genbank from NCBI;</li>
<li>Convert Genbank to GFF3 with
<a href="http://bio-spring.top/reinstall-bioperl/">BioPerl</a>;</li>
<li>Modify the GFF3 file;</li>
<li>Download Fasta from NCBI or use Genbank conversion;</li>
<li>Use the modified GFF3 file in rsem-prepare-reference;</li>
</ol>
<p>主要代码如下：<br>
<code> bp_genbank2gff3  --GFF_VERSION 3 file.gb awk '$3!~/pseudo/' file.gb.gff &gt; file.rsem.gff # or more restrictly with only protein coding genes awk '$3~/^(gene|mRNA|exon|polypeptide)$/' file.gb.gff &gt; file.cds.gff # remove the version number in fasta accession if no transcript is extract rsem-prepare-reference file.fasta --gff3 file.rsem.gff reference_name</code></p>
<p>这里主要解决了以下错误：<br>
<strong>Line x does not have attribute Parent</strong></p>
<p>由于rsem遵循gene-&gt;transcript-&gt;exon的结构，并利用exon来作为RNA的最后形式（经过剪切和后处理的RNA），要求exon都有(且仅有）一个Parent。而GFF3文件中pseudogene和pseudogenic_exon是没有Parent的。</p>
<p>以下为rsem-gff3-to-gtf line
27-32。细菌基因组的GFF3文件在gene-&gt;transcript-&gt;exon中的映射关系如下：gene
= type_gene, mRNA(tRNA, etc) = type_transcript, CDS = exon.</p>
<p><code> type_gene = [&quot;gene&quot;, &quot;snRNA_gene&quot;, &quot;transposable_element_gene&quot;, &quot;ncRNA_gene&quot;, &quot;telomerase_RNA_gene&quot;,     &quot;rRNA_gene&quot;, &quot;tRNA_gene&quot;, &quot;snoRNA_gene&quot;, &quot;mt_gene&quot;, &quot;miRNA_gene&quot;, &quot;lincRNA_gene&quot;, &quot;RNA&quot;, &quot;VD_gene_segment&quot;] type_transcript = [&quot;transcript&quot;, &quot;primary_transcript&quot;, &quot;mRNA&quot;, &quot;ncRNA&quot;, &quot;tRNA&quot;, &quot;rRNA&quot;, &quot;snRNA&quot;, &quot;snoRNA&quot;, &quot;miRNA&quot;,     &quot;pseudogenic_transcript&quot;, &quot;lincRNA&quot;, &quot;NMD_transcript_variant&quot;, &quot;aberrant_processed_transcript&quot;,     &quot;nc_primary_transcript&quot;, &quot;processed_pseudogene&quot;, &quot;mRNA_TE_gene&quot;] type_exon = [&quot;exon&quot;, &quot;CDS&quot;, &quot;five_prime_UTR&quot;, &quot;three_prime_UTR&quot;, &quot;UTR&quot;, &quot;noncoding_exon&quot;, &quot;pseudogenic_exon&quot;]</code></p>

</div>
</main>

<section class="appendix">


<div>
  <div class="side side-left"><h3>作者简介</h3></div>
  <div>





<div>Chun-Hui Gao is a Research Associate at <a href="http://www.hzau.edu.cn">Huazhong Agricultural University</a>.</div>


</div>
</div>






<div>
  <div class="side side-left"><h3>重复使用</h3></div>
  Text and figures are licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution CC BY 4.0</a>. The source code is licensed under MIT. The full source is available at <a href="https://github.com/yihui/hugo-prose">https://github.com/yihui/hugo-prose</a>.
</div>



<div>
  <div class="side side-left"><h3>欢迎修订</h3></div>
  
  
  
    
    
  
  如果您发现本文里含有任何错误（包括错别字和标点符号），欢迎<a href="https://github.com/gaospecial/bio-spring/edit/master/content/post/2017-06-01-rsem-rsem-prepare-reference-with-ncbi-genbankgff3-file/index.zh.md" id="edit-link">在本站的 GitHub 项目里提交修订意见。</a>
</div>




<div>
  <div class="side side-left"><h3>引用本文</h3></div>
  <p>如果您使用了本文的内容，请按照以下方式引用：</p>
  <pre><code>gaoch (2017). RSEM: rsem-prepare-reference with NCBI GenBank/GFF3 File. BIO-SPRING. bio-spring/post/2017/06/01/2017-06-01-rsem-rsem-prepare-reference-with-ncbi-genbankgff3-file/</code></pre>
  <p>BibTeX citation</p>
  <pre><code>@misc{
  title = "RSEM: rsem-prepare-reference with NCBI GenBank/GFF3 File",
  author = "gaoch",
  year = "2017",
  journal = "BIO-SPRING",
  note = "bio-spring/post/2017/06/01/2017-06-01-rsem-rsem-prepare-reference-with-ncbi-genbankgff3-file/"
}</code></pre>
</div>

</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="bio-spring/post/2016/12/22/2016-12-22-zoter-tag-tricks/" title=下一篇&#32;(旧)>Zotero: 标签的使用技巧</a></span>
  &hercon;
  <span class="nav-prev"><a href="bio-spring/post/2017/06/21/2017-06-21-using-text-formatting-commands-in-origin/" title=上一篇&#32;(新)>Origin：使用上标、下标、数学公式和希腊字母等特殊格式的文本</a> &rarr;</span>
</nav>




<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//bio-spring.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var t = d.getElementById('disqus_thread');
    var b = false, l = function(scroll) {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
      if (scroll) t.scrollIntoView();
    }
    s.onerror = function(e) {
      if (sessionStorage.getItem('failure-note')) return;
      t.innerText = 'Sorry, but you cannot make comments because Disqus failed to load for some reason. It is known to be blocked in China. If you are sure it is not blocked in your region, please refresh the page. 中国大陆地区读者需要翻墙才能发表评论。';
      t.style.border = '1px dashed';
      t.style.padding = '.5em';
      t.style.background = 'lightyellow';
      sessionStorage.setItem('failure-note', true);
    };
    
    if (location.hash.match(/^#comment-[0-9]+$/)) return l(true);
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


</div>


  <footer>
  
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>



<script src="//yihui.org/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>



      <script async src="https://www.googletagmanager.com/gtag/js?id=G-77M8KZTCMR"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-77M8KZTCMR');
        }
      </script>


<script src="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/js/number-sections.min.js,npm/@xiee/utils/js/toc.min.js,npm/@xiee/utils/js/toc-highlight.min.js,npm/@xiee/utils/js/sidenotes.min.js,npm/@xiee/utils/js/right-quote.min.js,npm/@xiee/utils/js/center-img.min.js,npm/@xiee/utils/js/fix-pandoc.min.js,npm/@xiee/utils/js/heading-anchor.min.js" defer></script>




  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="https://bio-spring.top">Bio-Spring</a> 2006 &ndash; 2025 <a href="https://beian.miit.gov.cn">豫ICP备2021003240号</a></li>
  </ul>
  
  <ul>
    
    <li>
      <a href="/bio-spring/404.html">Contact</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/categories/">Categories</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/tags/">Tags</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script src="/bio-spring/js/features.js" defer></script>
  </body>
</html>

