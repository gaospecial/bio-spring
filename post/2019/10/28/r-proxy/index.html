<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> 为 R 代理 | BIO-SPRING</title>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils@v1.13.54/css/article.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/heading-anchor.min.css">
    <link rel="stylesheet" href="/bio-spring/css/style.css" />
    <link rel="stylesheet" href="/bio-spring/css/fonts.css" />
    <link rel="stylesheet" href="/bio-spring/css/custom.css" />
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="为 R 代理">
  <meta name="twitter:description" content="今天想用 scholar 包抓一下自己的 Google Scholar profile，发现不翻墙打不开。
要设代理，参考了 @GuangchuangYu 发表的一次解决所有代理问题， 却仍然没有解决自己的问题。
因为我用的是 Windows，proxychains 却只能用于类 Unix 系统。
经过 3 个小时的探索，终于发现了一个途径，居然比 proxychains 还要简单很多。
那就是，设置 Renviron 环境变量的方法。
新建一个 Renviron 文件，内容如下：
CURL_SSL_BACKEND=openssl http_proxy=http://127.0.0.1:8080 https_proxy=http://127.0.0.1:8080 这个文件：
如果放在 “~/.Renviorn” 下面，那么每次 R 运行的时候都会设置使用相应的代理。 如果放在 R project 文件夹下面（如“/path/to/project/.Renviron”），那么只对相应的项目生效。 如果放在一个普通文件中（如“proxy.Renviron”），则只在调用的时候生效。 采用最后一种方法，在需要设置代理的脚本中，加入一行，就可以确保后续访问网络时使用代理设置。
readRenviron(&#34;proxy.Renviron&#34;) 说明 网上有很多关于设置 http(s)_proxy 变量来代理上网的方法，但是只设置这项是没有用的。
这是因为，当 R 从网上下载时，curl 包默认是采用的 Windows Cert Store 的后端，而该后端是不支持 https 协议代理上网的。
rcurl SSL Backends Secure Channel OpenSSL trust certificates Windows Cert Store curl-ca-bundle.crt file works on corporate networks Usually Yes Maybe not support http proxy server Yes Yes support https proxy server No Yes support client certificate authentication No Yes 因此，需要先设置 CURL_SSL_BACKEND=openssl，然后在设置代理服务器。">


  </head>

  <body>

    <nav class="menu sticky-top">
    <ul>
      <li class="left">
        <a href="/"><span>BIO-SPRING</span></a>
      </li>
      
      <li>
        <a href="/bio-spring">Home</a>
      </li>
      
      <li>
        <a href="/bio-spring/post/">Blog Post</a>
      </li>
      
      <li>
        <a href="/bio-spring/publication/full-publication-list/">Publication</a>
      </li>
      
      <li>
        <a href="/bio-spring/work/">Work</a>
      </li>
      
      <li id="menu-search">
        <a href="/bio-spring/#">Search</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">为 R 代理</span></h1>

<h3 class="author">
gaoch
</h3>

<h3 class="date">2019-10-28</h3>
<p class="terms">
  
  
  Categories: <a href="/categories/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF">信息技术</a> 
  
  
  
  Tags: <a href="/tags/r">R</a> <a href="/tags/proxy">proxy</a> 
  
  
</p>
</div>

<div class="article">
<p>今天想用 scholar 包抓一下自己的 Google Scholar profile，发现不翻墙打不开。</p>
<p>要设代理，参考了 @GuangchuangYu 发表的<a href="https://guangchuangyu.github.io/cn/2018/09/proxychains/">一次解决所有代理问题</a>，
却仍然没有解决自己的问题。</p>
<p>因为我用的是 Windows，proxychains 却只能用于类 Unix 系统。</p>
<p>经过 3 个小时的探索，终于发现了一个途径，居然比 proxychains 还要简单很多。</p>
<p>那就是，设置 Renviron 环境变量的方法。</p>
<p>新建一个 Renviron 文件，内容如下：</p>
<pre><code>CURL_SSL_BACKEND=openssl

http_proxy=http://127.0.0.1:8080
https_proxy=http://127.0.0.1:8080
</code></pre>
<p>这个文件：</p>
<ul>
<li>如果放在 &ldquo;<code>~/.Renviorn</code>&rdquo; 下面，那么每次 R 运行的时候都会设置使用相应的代理。</li>
<li>如果放在 R project 文件夹下面（如“<code>/path/to/project/.Renviron</code>”），那么只对相应的项目生效。</li>
<li>如果放在一个普通文件中（如“<code>proxy.Renviron</code>”），则只在调用的时候生效。</li>
</ul>
<p>采用最后一种方法，在需要设置代理的脚本中，加入一行，就可以确保后续访问网络时使用代理设置。</p>
<pre><code>readRenviron(&quot;proxy.Renviron&quot;)
</code></pre>
<h1 id="说明">说明</h1>
<p>网上有很多关于设置 <code>http(s)_proxy</code> 变量来代理上网的方法，但是只设置这项是没有用的。</p>
<p>这是因为，当 R 从网上下载时，curl 包默认是采用的 <strong>Windows Cert Store</strong> 的后端，而该后端是不支持 https 协议代理上网的。</p>
<table>
  <thead>
      <tr>
          <th>rcurl SSL Backends</th>
          <th>Secure Channel</th>
          <th>OpenSSL</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>trust certificates</td>
          <td>Windows Cert Store</td>
          <td>curl-ca-bundle.crt file</td>
      </tr>
      <tr>
          <td>works on corporate networks</td>
          <td>Usually Yes</td>
          <td>Maybe not</td>
      </tr>
      <tr>
          <td>support http proxy server</td>
          <td>Yes</td>
          <td>Yes</td>
      </tr>
      <tr>
          <td>support https proxy server</td>
          <td><strong>No</strong></td>
          <td>Yes</td>
      </tr>
      <tr>
          <td>support client certificate authentication</td>
          <td>No</td>
          <td>Yes</td>
      </tr>
  </tbody>
</table>
<p>因此，需要先设置 <code>CURL_SSL_BACKEND=openssl</code>，然后在设置代理服务器。</p>
<p><em>备注：这份资料在 curl 的文档中(<code>vignette(&quot;windows&quot;,&quot;curl&quot;)</code>)找到的。</em></p>

</div>
</main>

<section class="appendix">


<div>
  <div class="side side-left"><h3>作者简介</h3></div>
  <div>





<div>Chun-Hui Gao is a Research Associate at <a href="http://www.hzau.edu.cn">Huazhong Agricultural University</a>.</div>


</div>
</div>






<div>
  <div class="side side-left"><h3>重复使用</h3></div>
  Text and figures are licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution CC BY 4.0</a>. The source code is licensed under MIT. The full source is available at <a href="https://github.com/yihui/hugo-prose">https://github.com/yihui/hugo-prose</a>.
</div>



<div>
  <div class="side side-left"><h3>欢迎修订</h3></div>
  
  
  
    
    
  
  如果您发现本文里含有任何错误（包括错别字和标点符号），欢迎<a href="https://github.com/gaospecial/bio-spring/edit/master/content/post/2019-10-28-r-proxy/index.zh.md" id="edit-link">在本站的 GitHub 项目里提交修订意见。</a>
</div>




<div>
  <div class="side side-left"><h3>引用本文</h3></div>
  <p>如果您使用了本文的内容，请按照以下方式引用：</p>
  <pre><code>gaoch (2019). 为 R 代理. BIO-SPRING. bio-spring/post/2019/10/28/r-proxy/</code></pre>
  <p>BibTeX citation</p>
  <pre><code>@misc{
  title = "为 R 代理",
  author = "gaoch",
  year = "2019",
  journal = "BIO-SPRING",
  note = "bio-spring/post/2019/10/28/r-proxy/"
}</code></pre>
</div>

</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="bio-spring/post/2019/09/29/git-github-tutorial/" title=下一篇&#32;(旧)>Git 和 GitHub 使用指北</a></span>
  &hercon;
  <span class="nav-prev"><a href="bio-spring/post/2019/11/10/install-zotero-plugin-in-office-365/" title=上一篇&#32;(新)>在 Office 365 中设置 Zotero 插件</a> &rarr;</span>
</nav>




<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//bio-spring.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var t = d.getElementById('disqus_thread');
    var b = false, l = function(scroll) {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
      if (scroll) t.scrollIntoView();
    }
    s.onerror = function(e) {
      if (sessionStorage.getItem('failure-note')) return;
      t.innerText = 'Sorry, but you cannot make comments because Disqus failed to load for some reason. It is known to be blocked in China. If you are sure it is not blocked in your region, please refresh the page. 中国大陆地区读者需要翻墙才能发表评论。';
      t.style.border = '1px dashed';
      t.style.padding = '.5em';
      t.style.background = 'lightyellow';
      sessionStorage.setItem('failure-note', true);
    };
    
    if (location.hash.match(/^#comment-[0-9]+$/)) return l(true);
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


</div>


  <footer>
  
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>





      <script async src="https://www.googletagmanager.com/gtag/js?id=G-77M8KZTCMR"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-77M8KZTCMR');
        }
      </script>


<script src="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/js/number-sections.min.js,npm/@xiee/utils/js/toc.min.js,npm/@xiee/utils/js/toc-highlight.min.js,npm/@xiee/utils/js/sidenotes.min.js,npm/@xiee/utils/js/right-quote.min.js,npm/@xiee/utils/js/center-img.min.js,npm/@xiee/utils/js/fix-pandoc.min.js,npm/@xiee/utils/js/heading-anchor.min.js" defer></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/prism-xcode.min.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>


  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="https://bio-spring.top">Bio-Spring</a> 2006 &ndash; 2025 <a href="https://beian.miit.gov.cn">豫ICP备2021003240号</a></li>
  </ul>
  
  <ul>
    
    <li>
      <a href="/bio-spring/404.html">Contact</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/categories/">Categories</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/tags/">Tags</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script src="/bio-spring/js/features.js" defer></script>
  </body>
</html>

