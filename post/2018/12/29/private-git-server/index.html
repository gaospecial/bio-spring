<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> 设置私有 Git 服务器 | BIO-SPRING</title>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils@v1.13.54/css/article.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/heading-anchor.min.css">
    <link rel="stylesheet" href="/bio-spring/css/style.css" />
    <link rel="stylesheet" href="/bio-spring/css/fonts.css" />
    <link rel="stylesheet" href="/bio-spring/css/custom.css" />
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="设置私有 Git 服务器">
  <meta name="twitter:description" content="既然说到 Git，GitHub 你一定是了解的。GitHub 对于私有仓库是收费的。如果你项目还在进行中，需要一个仓库却又不想付高昂的服务费。使用自己的服务器当然也是可以的，而且很方便。
自己的服务器可以是阿里云这样的主机服务商，也可以是你能访问的任意一台Linux主机。只要能够 SSH 登录即可。
从服务器中开始 如果你的文件目前存储在服务器端，想在本地开展工作并使用服务器同步更新，可以参考下面的操作。
服务器端配置 添加一个新用户(也可以使用原有用户). adduser git 在添加用户git时, 会创建 /home/git 目录, 同时还会创建 git 用户组.
在服务器上创建一个git仓库(“sample”). cd /home/git mkdir sample.git git init --bare sample.git # 由于使用的是 root 用户新建的文件夹, 需要修订文件夹权限 chown -R git:git sample.git 添加git的ssh认证. mkdir /home/git/.ssh cat ~/.ssh/authorized_keys &lt;&lt; EOF 将你的 ssh.pub 公钥粘贴到这里, 每行一个人. 将合作用户的 公钥粘贴到这里, 每行一个人. EOF 你的 ssh.pub 公钥可以在本地电脑上使用cat ~/.ssh/id_rsa.pub查看.
客户端操作 从服务器clone repository. git clone git@remote.com:/home/git/sample.git 添加内容, 修改, 更新…. cd sample cat &gt; README &lt;&lt; EOF This is readme. For test. EOF git add . git commit --message &#34;Initial Commit&#34; git push 从本地开始 如果你本地有一个 Git 仓库，想把它上传到服务器中以便于随时随地访问和多人协同作业，则可以参考下面的操作。">


  </head>

  <body>

    <nav class="menu sticky-top">
    <ul>
      <li class="left">
        <a href="/"><span>BIO-SPRING</span></a>
      </li>
      
      <li>
        <a href="/bio-spring">Home</a>
      </li>
      
      <li>
        <a href="/bio-spring/post/">Blog Post</a>
      </li>
      
      <li>
        <a href="/bio-spring/publication/full-publication-list/">Publication</a>
      </li>
      
      <li>
        <a href="/bio-spring/work/">Work</a>
      </li>
      
      <li id="menu-search">
        <a href="/bio-spring/#">Search</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">设置私有 Git 服务器</span></h1>

<h3 class="author">
gaoch
</h3>

<h3 class="date">2018-12-29</h3>
<p class="terms">
  
  
  Categories: <a href="/categories/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF">信息技术</a> 
  
  
  
  Tags: <a href="/tags/git">git</a> 
  
  
</p>
</div>

<div class="article">
<p>既然说到 Git，GitHub 你一定是了解的。GitHub 对于私有仓库是收费的。如果你项目还在进行中，需要一个仓库却又不想付高昂的服务费。使用自己的服务器当然也是可以的，而且很方便。</p>
<p>自己的服务器可以是阿里云这样的主机服务商，也可以是你能访问的任意一台Linux主机。只要能够 SSH 登录即可。</p>
<h1 id="从服务器中开始">从服务器中开始</h1>
<p>如果你的文件目前存储在服务器端，想在本地开展工作并使用服务器同步更新，可以参考下面的操作。</p>
<h2 id="服务器端配置">服务器端配置</h2>
<ul>
<li>添加一个新用户(也可以使用原有用户).</li>
</ul>
<pre><code class="language-{bash}">adduser git
</code></pre>
<p>在添加用户git时, 会创建 <code>/home/git</code> 目录, 同时还会创建 <code>git</code> 用户组.</p>
<ul>
<li>在服务器上创建一个git仓库(&ldquo;sample&rdquo;).</li>
</ul>
<pre><code class="language-{bash}">cd /home/git
mkdir sample.git
git init --bare sample.git
# 由于使用的是 root 用户新建的文件夹, 需要修订文件夹权限
chown -R git:git sample.git
</code></pre>
<ul>
<li>添加git的ssh认证.</li>
</ul>
<pre><code class="language-{bash}">mkdir /home/git/.ssh
cat ~/.ssh/authorized_keys &lt;&lt; EOF
将你的 ssh.pub 公钥粘贴到这里, 每行一个人.
将合作用户的 公钥粘贴到这里, 每行一个人.
EOF
</code></pre>
<p>你的 ssh.pub 公钥可以在本地电脑上使用<code>cat ~/.ssh/id_rsa.pub</code>查看.</p>
<h2 id="客户端操作">客户端操作</h2>
<ul>
<li>从服务器clone repository.</li>
</ul>
<pre><code class="language-{bash}">git clone git@remote.com:/home/git/sample.git
</code></pre>
<ul>
<li>添加内容, 修改, 更新&hellip;.</li>
</ul>
<pre><code class="language-{bash}">cd sample
cat &gt; README &lt;&lt; EOF
This is readme. For test.
EOF
git add .
git commit --message &quot;Initial Commit&quot;

git push
</code></pre>
<h1 id="从本地开始">从本地开始</h1>
<p>如果你本地有一个 Git 仓库，想把它上传到服务器中以便于随时随地访问和多人协同作业，则可以参考下面的操作。</p>
<h2 id="客户端使用">客户端使用</h2>
<p>对于一个本地已有的仓库, 将其上传到自建git服务器上需要以下几个步骤:</p>
<ol>
<li>git 服务器中创建一个对应目录;</li>
<li>在本地软件仓库中添加远程映射;</li>
<li>将本地仓库上传到远程服务器.</li>
</ol>
<pre><code class="language-{bash}"># Server
cd
mkdir new.git
# 如果是用root用户创建的文件夹, 则需要将文件夹完整权限转交给git用户
chown -R git:git new.git
git init --bare new.git

# Local
cd /path/to/my/existed/git/project
git remote add origin git@remote.com:/home/git/new.git
# 对库做一些更新
# 如添加文件，git add
git push --set-upstream origin master
git push origin master
</code></pre>
<p><em>注意：本地文件有更新才能操作成功。</em></p>
<p>如果要变更远程仓库的地址，可以使用<code>git remote remove origin</code>来删除指定的远程链接。<code>git remote</code>命令可用于查看当前的远程链接。</p>
<h1 id="git-bare-repository的特点">git bare repository的特点</h1>
<p><code>git init --bare project.git</code> 会创建一个 <strong>bare</strong> repository。它与<code>git init</code>创建的 repository 的不同之处在于：</p>
<ul>
<li>bare 不保存工作目录和文件，只有 git 需要的文件；</li>
<li>标准 repository 可见的是工作目录和文件，git 需要的文件被隐藏到 <code>.git</code> 文件夹中；</li>
<li>bare 其实就是 <code>.git</code> 文件夹中的内容；</li>
<li>因此，bare 命名通常会在目录名末尾加上 <code>.git</code> 以示区别(当然不加也可以)；</li>
<li>如果只用作仓库时，选择 bare 可以节省空间；</li>
<li>两种 repository 都可以进行 <code>clone</code>，<code>log</code> 等操作。</li>
</ul>
<h1 id="客户端配置">客户端配置</h1>
<p>其他用户使用时, 需要:</p>
<ul>
<li>下载安装Git(<a href="https://git-scm.com/downloads);">https://git-scm.com/downloads);</a></li>
<li>对Git进行设置, 包括用户名, 邮箱等信息;</li>
</ul>
<p>参考下面的代码.</p>
<pre><code class="language-{bash}"># 首先打开 Git Bash 软件
# Windows 下在任意目录点击右键, 选择 Git Bash here 即可
# 输入下面的代码
# 设置用户名和邮箱
git config --global user.name=your_user_name
git config --global user.email=your@email.com
</code></pre>
<p>用户名和邮箱是为了区分不同协作者之用.</p>
<ul>
<li>生成一对密钥. 私钥自己保存,  &ldquo;公钥&rdquo; 提交给管理员, 由管理员添加到服务器中;</li>
</ul>
<p>继续输入以下代码即可.</p>
<pre><code class="language-{bash}"># 在 .ssh 目录创建密钥
ssh-keygen

# 查看公钥
cat ~/.ssh/id_rsa.pub

# 查看私钥
cat ~/.ssh/id_rsa
</code></pre>
<p>然后, 就可以从服务器中新建项目(clone), 提取项目更新(pull), 更新(push).</p>
<pre><code class="language-{bash}">git clone git@remote.com:/home/git/new.git
</code></pre>
<p>然后就可以在本地的 new 文件夹下面看到项目的内容. 可以编辑. 编辑完之后, 按下面操作.</p>
<pre><code class="language-{bash}"># 如果有新文件, 需要加入仓库
git add R/newfile.R

# 如果仅对现有文件有改动(编辑/删除)
git commit -a -m &quot;对文件改动的说明&quot;

# 将这些修改提交到服务器上
git push

# 如果服务器上的文件有更新(其他人已经push过)
# 则先要将本地仓库与服务器仓库对齐
# 然后再执行前面的几条命令
git pull
</code></pre>
<h1 id="将本地与服务器用-git-关联起来">将本地与服务器用 Git 关联起来</h1>
<p>在服务器端：</p>
<pre><code>vi ~/.ssh/authorized_keys
# 把 Git 程序使用的 SSH id_rsa.pub 添加进去

mkdir ~/demo.git
git init --bare ~/demo.git
</code></pre>
<p>在本地端：</p>
<pre><code>git init
# add and commit
# empty repository is not allowed while push
git remote add origin user@host:/home/demo.git origin
git push --set-upstream origin master
</code></pre>

</div>
</main>

<section class="appendix">


<div>
  <div class="side side-left"><h3>作者简介</h3></div>
  <div>





<div>Chun-Hui Gao is a Research Associate at <a href="http://www.hzau.edu.cn">Huazhong Agricultural University</a>.</div>


</div>
</div>






<div>
  <div class="side side-left"><h3>重复使用</h3></div>
  Text and figures are licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution CC BY 4.0</a>. The source code is licensed under MIT. The full source is available at <a href="https://github.com/yihui/hugo-prose">https://github.com/yihui/hugo-prose</a>.
</div>



<div>
  <div class="side side-left"><h3>欢迎修订</h3></div>
  
  
  
    
    
  
  如果您发现本文里含有任何错误（包括错别字和标点符号），欢迎<a href="https://github.com/gaospecial/bio-spring/edit/master/content/post/2018-12-29-private-git-server/index.zh.md" id="edit-link">在本站的 GitHub 项目里提交修订意见。</a>
</div>




<div>
  <div class="side side-left"><h3>引用本文</h3></div>
  <p>如果您使用了本文的内容，请按照以下方式引用：</p>
  <pre><code>gaoch (2018). 设置私有 Git 服务器. BIO-SPRING. bio-spring/post/2018/12/29/private-git-server/</code></pre>
  <p>BibTeX citation</p>
  <pre><code>@misc{
  title = "设置私有 Git 服务器",
  author = "gaoch",
  year = "2018",
  journal = "BIO-SPRING",
  note = "bio-spring/post/2018/12/29/private-git-server/"
}</code></pre>
</div>

</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="bio-spring/post/2018/11/26/enrichplot-fancy-label/" title=下一篇&#32;(旧)>在enrichplot中使用更好的Label</a></span>
  &hercon;
  <span class="nav-prev"><a href="bio-spring/post/2019/02/15/2019-02-15-switch-to-disqus/" title=上一篇&#32;(新)>无缝切换到DISQUS评论系统</a> &rarr;</span>
</nav>




<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//bio-spring.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var t = d.getElementById('disqus_thread');
    var b = false, l = function(scroll) {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
      if (scroll) t.scrollIntoView();
    }
    s.onerror = function(e) {
      if (sessionStorage.getItem('failure-note')) return;
      t.innerText = 'Sorry, but you cannot make comments because Disqus failed to load for some reason. It is known to be blocked in China. If you are sure it is not blocked in your region, please refresh the page. 中国大陆地区读者需要翻墙才能发表评论。';
      t.style.border = '1px dashed';
      t.style.padding = '.5em';
      t.style.background = 'lightyellow';
      sessionStorage.setItem('failure-note', true);
    };
    
    if (location.hash.match(/^#comment-[0-9]+$/)) return l(true);
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


</div>


  <footer>
  
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>





      <script async src="https://www.googletagmanager.com/gtag/js?id=G-77M8KZTCMR"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-77M8KZTCMR');
        }
      </script>


<script src="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/js/number-sections.min.js,npm/@xiee/utils/js/toc.min.js,npm/@xiee/utils/js/toc-highlight.min.js,npm/@xiee/utils/js/sidenotes.min.js,npm/@xiee/utils/js/right-quote.min.js,npm/@xiee/utils/js/center-img.min.js,npm/@xiee/utils/js/fix-pandoc.min.js,npm/@xiee/utils/js/heading-anchor.min.js" defer></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/prism-xcode.min.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>


  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="https://bio-spring.top">Bio-Spring</a> 2006 &ndash; 2025 <a href="https://beian.miit.gov.cn">豫ICP备2021003240号</a></li>
  </ul>
  
  <ul>
    
    <li>
      <a href="/bio-spring/404.html">Contact</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/categories/">Categories</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/tags/">Tags</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script src="/bio-spring/js/features.js" defer></script>
  </body>
</html>

