<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> Bray Curtis Dissimilarity | BIO-SPRING</title>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils@v1.13.54/css/article.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/heading-anchor.min.css">
    <link rel="stylesheet" href="/bio-spring/css/style.css" />
    <link rel="stylesheet" href="/bio-spring/css/fonts.css" />
    <link rel="stylesheet" href="/bio-spring/css/custom.css" />
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Bray Curtis Dissimilarity">
  <meta name="twitter:description" content="本文介绍 Bray Curtis Dissimilarity 的概念和计算方法。
Bray Curtis Dissimilarity（Bray-Curtis 相异度）是生态学中用来衡量不同样地物种组成差异的参数。
其定义和计算公式为：
$$BC_{ij}=1-2C_{ij}/(S_{i}&#43;S_{j})$$
其中：
\(i\) 和 \(j\) 是两个样地； \(S_i\) 是样地 \(i\) 中物种的总数； \(S_j\) 是样地 \(j\) 中物种的总数； \(C_{ij}\) 在两块样地中每个物种的较少计数的总和。 简单的例子 有两个水族箱：
一号：6条金鱼，7条孔雀鱼和4只螃蟹； 二号：10条金鱼和6只螃蟹。 为了计算 Bray-Curtis，首先计算$C_{ij}$。金鱼两个地方都有，较少的是6；孔雀鱼只在一号中有，所以不能添加；螃蟹两个地方都有，较少的是4。因此，$C_{ij}=6&#43;4=10$。
\(S_i=6&#43;7&#43;4=17\)，而$S_j=10&#43;6=16$。
因此,
$$BC_{ij}=1-(2*10)/(17&#43;16)=0.39$$
Bray-Curtis Dissimilarity 的性质 其取值介于0-1之间。如果是0，则两个样地共享所有相同的物种；如果是1，则它们不共享任何物种。
还有另外一个 Bray-Curtis index，其取值是 1 - Bray-Curtis dissimilarity。表示两个样地之间的相似程度。
适用情况 要计算 Bray-Curtis Dissimilarity，必须假设两个样地的面积或体积大小相同（与物种计数相关），否则需要在计算前调整计数。
R语言实现 vegan提供了vegdist来计算这个数值。
## 用 vegdist 重复上面的例子 df &lt;- data.frame(goldfish=c(6,10),guppies=c(7,0),crab=c(4,6)) require(&#34;vegan&#34;) ## Loading required package: vegan ## Loading required package: permute ## Loading required package: lattice ## This is vegan 2.6-4 vegdist(df,method = &#34;bray&#34;) # 这个值跟前面人脑计算的一致 ## 1 ## 2 0.3939394 ## 计算群落数据 data(&#34;varespec&#34;) ## 计算不同样地两两之间的差异度 bc &lt;- vegdist(varespec) ## 使用pheatmap做一个热图 pheatmap::pheatmap(bc,breaks = seq(0,1,0.01)) 延伸阅读 vegdist的可用的方法（method = &#34;bray&#34;）还包括 “manhattan”, “euclidean”, “canberra”, “clark”, “bray”, “kulczynski”, “jaccard”, “gower”, “altGower”, “morisita”, “horn”, “mountford”, “raup”, “binomial”, “chao”, “cao” or “mahalanobis”。">


  </head>

  <body>

    <nav class="menu sticky-top">
    <ul>
      <li class="left">
        <a href="/"><span>BIO-SPRING</span></a>
      </li>
      
      <li>
        <a href="/bio-spring">Home</a>
      </li>
      
      <li>
        <a href="/bio-spring/post/">Blog Post</a>
      </li>
      
      <li>
        <a href="/bio-spring/publication/full-publication-list/">Publication</a>
      </li>
      
      <li>
        <a href="/bio-spring/work/">Work</a>
      </li>
      
      <li id="menu-search">
        <a href="/bio-spring/#">Search</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">Bray Curtis Dissimilarity</span></h1>

<h3 class="author">
gaoch
</h3>

<h3 class="date">2018-10-17</h3>
<p class="terms">
  
  
  Categories: <a href="/categories/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF">信息技术</a> 
  
  
  
  Tags: <a href="/tags/r">R</a> <a href="/tags/statistics">statistics</a> 
  
  
</p>
</div>

<div class="article">
<p>本文介绍 Bray Curtis Dissimilarity 的概念和计算方法。</p>
<p>Bray Curtis Dissimilarity（Bray-Curtis 相异度）是生态学中用来衡量不同样地<strong>物种组成差异</strong>的参数。</p>
<p>其定义和计算公式为：</p>
<p><code>$$BC_{ij}=1-2C_{ij}/(S_{i}+S_{j})$$</code></p>
<p>其中：</p>
<ul>
<li><code>\(i\)</code> 和 <code>\(j\)</code> 是两个样地；</li>
<li><code>\(S_i\)</code> 是样地 <code>\(i\)</code> 中物种的总数；</li>
<li><code>\(S_j\)</code> 是样地 <code>\(j\)</code> 中物种的总数；</li>
<li><code>\(C_{ij}\)</code> 在两块样地中每个物种的较少计数的总和。</li>
</ul>
<h2 id="简单的例子">简单的例子</h2>
<p>有两个水族箱：</p>
<ul>
<li>一号：6条金鱼，7条孔雀鱼和4只螃蟹；</li>
<li>二号：10条金鱼和6只螃蟹。</li>
</ul>
<p>为了计算 Bray-Curtis，首先计算$C_{ij}$。金鱼两个地方都有，较少的是6；孔雀鱼只在一号中有，所以不能添加；螃蟹两个地方都有，较少的是4。因此，$C_{ij}=6+4=10$。</p>
<p><code>\(S_i=6+7+4=17\)</code>，而$S_j=10+6=16$。</p>
<p>因此,</p>
<p><code>$$BC_{ij}=1-(2*10)/(17+16)=0.39$$</code></p>
<h2 id="bray-curtis-dissimilarity-的性质">Bray-Curtis Dissimilarity 的性质</h2>
<p>其取值介于0-1之间。如果是0，则两个样地共享所有相同的物种；如果是1，则它们不共享任何物种。</p>
<p>还有另外一个 Bray-Curtis index，其取值是 1 - Bray-Curtis dissimilarity。表示两个样地之间的相似程度。</p>
<h2 id="适用情况">适用情况</h2>
<p>要计算 Bray-Curtis Dissimilarity，必须假设两个样地的面积或体积大小相同（与物种计数相关），否则需要在计算前调整计数。</p>
<h2 id="r语言实现">R语言实现</h2>
<p><code>vegan</code>提供了<code>vegdist</code>来计算这个数值。</p>
<pre><code class="language-r">## 用 vegdist 重复上面的例子
df &lt;- data.frame(goldfish=c(6,10),guppies=c(7,0),crab=c(4,6))
require(&quot;vegan&quot;)
</code></pre>
<pre><code>## Loading required package: vegan
</code></pre>
<pre><code>## Loading required package: permute
</code></pre>
<pre><code>## Loading required package: lattice
</code></pre>
<pre><code>## This is vegan 2.6-4
</code></pre>
<pre><code class="language-r">vegdist(df,method = &quot;bray&quot;) # 这个值跟前面人脑计算的一致
</code></pre>
<pre><code>##           1
## 2 0.3939394
</code></pre>
<pre><code class="language-r">## 计算群落数据
data(&quot;varespec&quot;)
## 计算不同样地两两之间的差异度
bc &lt;- vegdist(varespec)

## 使用pheatmap做一个热图
pheatmap::pheatmap(bc,breaks = seq(0,1,0.01))
</code></pre>
<img src="bio-spring/post/2018/10/17/bray-curtis-dissimilarity/index.zh_files/figure-html/vegdist-1.png" width="576" />
<h2 id="延伸阅读">延伸阅读</h2>
<p><code>vegdist</code>的可用的方法（<code>method = &quot;bray&quot;</code>）还包括 &ldquo;manhattan&rdquo;, &ldquo;euclidean&rdquo;, &ldquo;canberra&rdquo;, &ldquo;clark&rdquo;, &ldquo;bray&rdquo;, &ldquo;kulczynski&rdquo;, &ldquo;jaccard&rdquo;, &ldquo;gower&rdquo;, &ldquo;altGower&rdquo;, &ldquo;morisita&rdquo;, &ldquo;horn&rdquo;, &ldquo;mountford&rdquo;, &ldquo;raup&rdquo;, &ldquo;binomial&rdquo;, &ldquo;chao&rdquo;, &ldquo;cao&rdquo; or &ldquo;mahalanobis&rdquo;。</p>
<p><code>designdist</code>可用来设计自己的差异度算法。</p>
<h2 id="参考资料">参考资料</h2>
<ol>
<li><a href="https://www.statisticshowto.datasciencecentral.com/bray-curtis-dissimilarity/">https://www.statisticshowto.datasciencecentral.com/bray-curtis-dissimilarity/</a></li>
<li><code>?vegdist</code></li>
</ol>

</div>
</main>

<section class="appendix">


<div>
  <div class="side side-left"><h3>作者简介</h3></div>
  <div>





<div>Chun-Hui Gao is a Research Associate at <a href="http://www.hzau.edu.cn">Huazhong Agricultural University</a>.</div>


</div>
</div>






<div>
  <div class="side side-left"><h3>重复使用</h3></div>
  Text and figures are licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution CC BY 4.0</a>. The source code is licensed under MIT. The full source is available at <a href="https://github.com/yihui/hugo-prose">https://github.com/yihui/hugo-prose</a>.
</div>



<div>
  <div class="side side-left"><h3>欢迎修订</h3></div>
  
  
  
    
  
  如果您发现本文里含有任何错误（包括错别字和标点符号），欢迎<a href="https://github.com/gaospecial/bio-spring/edit/master/content/post/2018-10-17-bray-curtis-dissimilarity/index.zh.Rmd" id="edit-link">在本站的 GitHub 项目里提交修订意见。</a>
</div>




<div>
  <div class="side side-left"><h3>引用本文</h3></div>
  <p>如果您使用了本文的内容，请按照以下方式引用：</p>
  <pre><code>gaoch (2018). Bray Curtis Dissimilarity. BIO-SPRING. bio-spring/post/2018/10/17/bray-curtis-dissimilarity/</code></pre>
  <p>BibTeX citation</p>
  <pre><code>@misc{
  title = "Bray Curtis Dissimilarity",
  author = "gaoch",
  year = "2018",
  journal = "BIO-SPRING",
  note = "bio-spring/post/2018/10/17/bray-curtis-dissimilarity/"
}</code></pre>
</div>

</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="bio-spring/post/2018/10/17/ordination-analysis-to-assess-shifts-of-niche-structure/" title=下一篇&#32;(旧)>Ordination analysis to assess shifts of niche structure</a></span>
  &hercon;
  <span class="nav-prev"><a href="bio-spring/post/2018/10/22/plot-pca-using-ggplot2/" title=上一篇&#32;(新)>排序分析结果作图</a> &rarr;</span>
</nav>




<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//bio-spring.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var t = d.getElementById('disqus_thread');
    var b = false, l = function(scroll) {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
      if (scroll) t.scrollIntoView();
    }
    s.onerror = function(e) {
      if (sessionStorage.getItem('failure-note')) return;
      t.innerText = 'Sorry, but you cannot make comments because Disqus failed to load for some reason. It is known to be blocked in China. If you are sure it is not blocked in your region, please refresh the page. 中国大陆地区读者需要翻墙才能发表评论。';
      t.style.border = '1px dashed';
      t.style.padding = '.5em';
      t.style.background = 'lightyellow';
      sessionStorage.setItem('failure-note', true);
    };
    
    if (location.hash.match(/^#comment-[0-9]+$/)) return l(true);
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


</div>


  <footer>
  
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>



<script src="//yihui.org/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>



      <script async src="https://www.googletagmanager.com/gtag/js?id=G-77M8KZTCMR"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-77M8KZTCMR');
        }
      </script>


<script src="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/js/number-sections.min.js,npm/@xiee/utils/js/toc.min.js,npm/@xiee/utils/js/toc-highlight.min.js,npm/@xiee/utils/js/sidenotes.min.js,npm/@xiee/utils/js/right-quote.min.js,npm/@xiee/utils/js/center-img.min.js,npm/@xiee/utils/js/fix-pandoc.min.js,npm/@xiee/utils/js/heading-anchor.min.js" defer></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/prism-xcode.min.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>


  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="https://bio-spring.top">Bio-Spring</a> 2006 &ndash; 2025 <a href="https://beian.miit.gov.cn">豫ICP备2021003240号</a></li>
  </ul>
  
  <ul>
    
    <li>
      <a href="/bio-spring/404.html">Contact</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/categories/">Categories</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/tags/">Tags</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script src="/bio-spring/js/features.js" defer></script>
  </body>
</html>

