<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> ClusterProfiler做代谢物富集分析 | BIO-SPRING</title>
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils@v1.13.54/css/article.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/heading-anchor.min.css">
    <link rel="stylesheet" href="/bio-spring/css/style.css" />
    <link rel="stylesheet" href="/bio-spring/css/fonts.css" />
    <link rel="stylesheet" href="/bio-spring/css/custom.css" />
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ClusterProfiler做代谢物富集分析">
  <meta name="twitter:description" content="使用 clusterProfiler 的内置富集函数做代谢物富集分析。
# 加载必要的包 library(clusterProfiler) ## ## Registered S3 methods overwritten by &#39;treeio&#39;: ## method from ## MRCA.phylo tidytree ## MRCA.treedata tidytree ## Nnode.treedata tidytree ## Ntip.treedata tidytree ## ancestor.phylo tidytree ## ancestor.treedata tidytree ## child.phylo tidytree ## child.treedata tidytree ## full_join.phylo tidytree ## full_join.treedata tidytree ## groupClade.phylo tidytree ## groupClade.treedata tidytree ## groupOTU.phylo tidytree ## groupOTU.treedata tidytree ## inner_join.phylo tidytree ## inner_join.treedata tidytree ## is.rooted.treedata tidytree ## nodeid.phylo tidytree ## nodeid.treedata tidytree ## nodelab.phylo tidytree ## nodelab.treedata tidytree ## offspring.phylo tidytree ## offspring.treedata tidytree ## parent.phylo tidytree ## parent.treedata tidytree ## root.treedata tidytree ## rootnode.phylo tidytree ## sibling.phylo tidytree ## clusterProfiler v4.10.0 For help: https://yulab-smu.top/biomedical-knowledge-mining-book/ ## ## If you use clusterProfiler in published research, please cite: ## T Wu, E Hu, S Xu, M Chen, P Guo, Z Dai, T Feng, L Zhou, W Tang, L Zhan, X Fu, S Liu, X Bo, and G Yu. clusterProfiler 4.0: A universal enrichment tool for interpreting omics data. The Innovation. 2021, 2(3):100141 ## ## Attaching package: &#39;clusterProfiler&#39; ## The following object is masked from &#39;package:stats&#39;: ## ## filter # 构造感兴趣的代谢物列表 metabolite_list = c(&#34;Metabolite1&#34;, &#34;Metabolite2&#34;, &#34;Metabolite3&#34;, &#34;Metabolite6&#34;, &#34;Metabolite7&#34;) # 构造代谢途径与代谢物的映射关系 (TERM2GENE) term2gene = data.frame( Pathway = c(&#34;Pathway1&#34;, &#34;Pathway1&#34;, &#34;Pathway1&#34;, &#34;Pathway2&#34;, &#34;Pathway2&#34;, &#34;Pathway3&#34;, &#34;Pathway3&#34;, &#34;Pathway4&#34;, &#34;Pathway4&#34;, &#34;Pathway5&#34;), Metabolite = c(&#34;Metabolite1&#34;, &#34;Metabolite2&#34;, &#34;Metabolite3&#34;, &#34;Metabolite4&#34;, &#34;Metabolite5&#34;, &#34;Metabolite6&#34;, &#34;Metabolite7&#34;, &#34;Metabolite8&#34;, &#34;Metabolite9&#34;, &#34;Metabolite10&#34;) ) # 构造代谢途径描述信息 (TERM2NAME) term2name = data.frame( Pathway = c(&#34;Pathway1&#34;, &#34;Pathway2&#34;, &#34;Pathway3&#34;, &#34;Pathway4&#34;, &#34;Pathway5&#34;), Description = c(&#34;Metabolic Pathway 1&#34;, &#34;Metabolic Pathway 2&#34;, &#34;Metabolic Pathway 3&#34;, &#34;Metabolic Pathway 4&#34;, &#34;Metabolic Pathway 5&#34;) ) # 使用 enricher 函数进行代谢物富集分析 result = enricher( gene = metabolite_list, pvalueCutoff = 0.5, # 调高 cutoff 以得到结果 pAdjustMethod = &#34;BH&#34;, TERM2GENE = term2gene, TERM2NAME = term2name, minGSSize = 1 # 将默认的 10 改成 1，否则也得不到结果 ) # 查看结果 if (!is.null(result)) { print(head(as.data.frame(result))) # 可视化结果 dotplot(result, showCategory = 5) } else { message(&#34;没有显著富集的代谢途径&#34;) } ## ID Description GeneRatio BgRatio pvalue p.adjust ## Pathway1 Pathway1 Metabolic Pathway 1 3/5 3/10 0.08333333 0.1666667 ## qvalue geneID Count ## Pathway1 0.1666667 Metabolite1/Metabolite2/Metabolite3 3">


  </head>

  <body>

    <nav class="menu sticky-top">
    <ul>
      <li class="left">
        <a href="/"><span>BIO-SPRING</span></a>
      </li>
      
      <li>
        <a href="/bio-spring">Home</a>
      </li>
      
      <li>
        <a href="/bio-spring/post/">Blog Post</a>
      </li>
      
      <li>
        <a href="/bio-spring/publication/full-publication-list/">Publication</a>
      </li>
      
      <li>
        <a href="/bio-spring/work/">Work</a>
      </li>
      
      <li id="menu-search">
        <a href="/bio-spring/#">Search</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">ClusterProfiler做代谢物富集分析</span></h1>

<h3 class="author">
gaoch
</h3>

<h3 class="date">2024-12-29</h3>
<p class="terms">
  
  
  Categories: <a href="/categories/%E7%94%9F%E7%89%A9%E5%AD%A6">生物学</a> <a href="/categories/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF">信息技术</a> 
  
  
  
  Tags: <a href="/tags/r">R</a> <a href="/tags/clusterprofiler">ClusterProfiler</a> <a href="/tags/%E4%BB%A3%E8%B0%A2%E7%BB%84">代谢组</a> 
  
  
</p>
</div>

<div class="article">
<p>使用 <code>clusterProfiler</code> 的内置富集函数做代谢物富集分析。</p>
<pre><code class="language-r"># 加载必要的包
library(clusterProfiler)
</code></pre>
<pre><code>## 
</code></pre>
<pre><code>## Registered S3 methods overwritten by 'treeio':
##   method              from    
##   MRCA.phylo          tidytree
##   MRCA.treedata       tidytree
##   Nnode.treedata      tidytree
##   Ntip.treedata       tidytree
##   ancestor.phylo      tidytree
##   ancestor.treedata   tidytree
##   child.phylo         tidytree
##   child.treedata      tidytree
##   full_join.phylo     tidytree
##   full_join.treedata  tidytree
##   groupClade.phylo    tidytree
##   groupClade.treedata tidytree
##   groupOTU.phylo      tidytree
##   groupOTU.treedata   tidytree
##   inner_join.phylo    tidytree
##   inner_join.treedata tidytree
##   is.rooted.treedata  tidytree
##   nodeid.phylo        tidytree
##   nodeid.treedata     tidytree
##   nodelab.phylo       tidytree
##   nodelab.treedata    tidytree
##   offspring.phylo     tidytree
##   offspring.treedata  tidytree
##   parent.phylo        tidytree
##   parent.treedata     tidytree
##   root.treedata       tidytree
##   rootnode.phylo      tidytree
##   sibling.phylo       tidytree
</code></pre>
<pre><code>## clusterProfiler v4.10.0  For help: https://yulab-smu.top/biomedical-knowledge-mining-book/
## 
## If you use clusterProfiler in published research, please cite:
## T Wu, E Hu, S Xu, M Chen, P Guo, Z Dai, T Feng, L Zhou, W Tang, L Zhan, X Fu, S Liu, X Bo, and G Yu. clusterProfiler 4.0: A universal enrichment tool for interpreting omics data. The Innovation. 2021, 2(3):100141
</code></pre>
<pre><code>## 
## Attaching package: 'clusterProfiler'
</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     filter
</code></pre>
<pre><code class="language-r"># 构造感兴趣的代谢物列表
metabolite_list = c(&quot;Metabolite1&quot;, &quot;Metabolite2&quot;, &quot;Metabolite3&quot;, &quot;Metabolite6&quot;, &quot;Metabolite7&quot;)

# 构造代谢途径与代谢物的映射关系 (TERM2GENE)
term2gene = data.frame(
    Pathway = c(&quot;Pathway1&quot;, &quot;Pathway1&quot;, &quot;Pathway1&quot;, &quot;Pathway2&quot;, &quot;Pathway2&quot;, 
                &quot;Pathway3&quot;, &quot;Pathway3&quot;, &quot;Pathway4&quot;, &quot;Pathway4&quot;, &quot;Pathway5&quot;),
    Metabolite = c(&quot;Metabolite1&quot;, &quot;Metabolite2&quot;, &quot;Metabolite3&quot;, &quot;Metabolite4&quot;, &quot;Metabolite5&quot;, 
                   &quot;Metabolite6&quot;, &quot;Metabolite7&quot;, &quot;Metabolite8&quot;, &quot;Metabolite9&quot;, &quot;Metabolite10&quot;)
)

# 构造代谢途径描述信息 (TERM2NAME)
term2name = data.frame(
    Pathway = c(&quot;Pathway1&quot;, &quot;Pathway2&quot;, &quot;Pathway3&quot;, &quot;Pathway4&quot;, &quot;Pathway5&quot;),
    Description = c(&quot;Metabolic Pathway 1&quot;, &quot;Metabolic Pathway 2&quot;, &quot;Metabolic Pathway 3&quot;, 
                    &quot;Metabolic Pathway 4&quot;, &quot;Metabolic Pathway 5&quot;)
)

# 使用 enricher 函数进行代谢物富集分析
result = enricher(
    gene = metabolite_list,
    pvalueCutoff = 0.5, # 调高 cutoff 以得到结果
    pAdjustMethod = &quot;BH&quot;,
    TERM2GENE = term2gene,
    TERM2NAME = term2name,
    minGSSize = 1  # 将默认的 10 改成 1，否则也得不到结果
)

# 查看结果
if (!is.null(result)) {
    print(head(as.data.frame(result)))
    # 可视化结果
    dotplot(result, showCategory = 5)
} else {
    message(&quot;没有显著富集的代谢途径&quot;)
}
</code></pre>
<pre><code>##                ID         Description GeneRatio BgRatio     pvalue  p.adjust
## Pathway1 Pathway1 Metabolic Pathway 1       3/5    3/10 0.08333333 0.1666667
##             qvalue                              geneID Count
## Pathway1 0.1666667 Metabolite1/Metabolite2/Metabolite3     3
</code></pre>
<img src="bio-spring/post/2024/12/29/clusterprofiler-metabolite-enrichment-analysis/index.zh_files/figure-html/unnamed-chunk-1-1.png" width="672" />

</div>
</main>

<section class="appendix">


<div>
  <div class="side side-left"><h3>作者简介</h3></div>
  <div>





<div>Chun-Hui Gao is a Research Associate at <a href="http://www.hzau.edu.cn">Huazhong Agricultural University</a>.</div>


</div>
</div>






<div>
  <div class="side side-left"><h3>重复使用</h3></div>
  Text and figures are licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution CC BY 4.0</a>. The source code is licensed under MIT. The full source is available at <a href="https://github.com/yihui/hugo-prose">https://github.com/yihui/hugo-prose</a>.
</div>



<div>
  <div class="side side-left"><h3>欢迎修订</h3></div>
  
  
  
    
  
  如果您发现本文里含有任何错误（包括错别字和标点符号），欢迎<a href="https://github.com/gaospecial/bio-spring/edit/master/content/post/2024-12-29-clusterprofiler-metabolite-enrichment-analysis/index.zh.Rmd" id="edit-link">在本站的 GitHub 项目里提交修订意见。</a>
</div>




<div>
  <div class="side side-left"><h3>引用本文</h3></div>
  <p>如果您使用了本文的内容，请按照以下方式引用：</p>
  <pre><code>gaoch (2024). ClusterProfiler做代谢物富集分析. BIO-SPRING. bio-spring/post/2024/12/29/clusterprofiler-metabolite-enrichment-analysis/</code></pre>
  <p>BibTeX citation</p>
  <pre><code>@misc{
  title = "ClusterProfiler做代谢物富集分析",
  author = "gaoch",
  year = "2024",
  journal = "BIO-SPRING",
  note = "bio-spring/post/2024/12/29/clusterprofiler-metabolite-enrichment-analysis/"
}</code></pre>
</div>

</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="bio-spring/post/2024/11/26/pca-loading/" title=下一篇&#32;(旧)>PCA loading</a></span>
  &hercon;
  <span class="nav-prev"><a href="bio-spring/post/2025/01/04/perlin-noise/" title=上一篇&#32;(新)>柏林噪声</a> &rarr;</span>
</nav>




<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//bio-spring.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var t = d.getElementById('disqus_thread');
    var b = false, l = function(scroll) {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
      if (scroll) t.scrollIntoView();
    }
    s.onerror = function(e) {
      if (sessionStorage.getItem('failure-note')) return;
      t.innerText = 'Sorry, but you cannot make comments because Disqus failed to load for some reason. It is known to be blocked in China. If you are sure it is not blocked in your region, please refresh the page. 中国大陆地区读者需要翻墙才能发表评论。';
      t.style.border = '1px dashed';
      t.style.padding = '.5em';
      t.style.background = 'lightyellow';
      sessionStorage.setItem('failure-note', true);
    };
    
    if (location.hash.match(/^#comment-[0-9]+$/)) return l(true);
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


</div>


  <footer>
  
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>





      <script async src="https://www.googletagmanager.com/gtag/js?id=G-77M8KZTCMR"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-77M8KZTCMR');
        }
      </script>


<script src="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/js/number-sections.min.js,npm/@xiee/utils/js/toc.min.js,npm/@xiee/utils/js/toc-highlight.min.js,npm/@xiee/utils/js/sidenotes.min.js,npm/@xiee/utils/js/right-quote.min.js,npm/@xiee/utils/js/center-img.min.js,npm/@xiee/utils/js/fix-pandoc.min.js,npm/@xiee/utils/js/heading-anchor.min.js" defer></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/prism-xcode.min.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>


  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="https://bio-spring.top">Bio-Spring</a> 2006 &ndash; 2025 <a href="https://beian.miit.gov.cn">豫ICP备2021003240号</a></li>
  </ul>
  
  <ul>
    
    <li>
      <a href="/bio-spring/404.html">Contact</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/categories/">Categories</a>
    </li>
    
    <li class="optional">
      <a href="/bio-spring/tags/">Tags</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script src="/bio-spring/js/features.js" defer></script>
  </body>
</html>

